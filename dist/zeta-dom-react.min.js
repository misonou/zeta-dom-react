!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,i),a.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{i.d(a,{default:()=>ve});var e={};i.r(e),i.d(e,{DataView:()=>M,FormContext:()=>ae,FormContextProvider:()=>re,ViewStateProvider:()=>A,classNames:()=>fe,combineRef:()=>de,combineValidators:()=>se,partial:()=>ce,toRefCallback:()=>le,useAsync:()=>X,useDataView:()=>T,useDispose:()=>$,useErrorHandlerRef:()=>ee,useFormContext:()=>oe,useFormField:()=>ue,useMemoizedFunction:()=>K,useObservableProperty:()=>Q,useRefInitCallback:()=>Y,useViewState:()=>D});var t=i(359),n=i(654),r=n.util,o=r.noop,u=r.pipe,s=(r.either,r.is,r.isUndefinedOrNull,r.isArray),f=r.isFunction,c=(r.isThenable,r.isPlainObject,r.isArrayLike,r.makeArray),d=r.extend,l=r.each,v=r.map,p=r.grep,m=(r.splice,r.any),h=(r.single,r.kv),g=r.pick,y=(r.exclude,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),S=(r.equal,r.combineFn),C=(r.executeOnce,r.createPrivateStore),b=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.keys),w=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define),O=r.definePrototype,P=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),x=r.watch,E=(r.watchOnce,r.watchable,r.inherit),V=(r.deepFreeze,r.iequal,r.randomId),z=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),k=(r.reject,r.always),I=r.resolveAll,F=r.catchAsync,j=(r.setPromiseTimeout,(0,t.createContext)(null)),R=Object.freeze({get:o,set:o}),A=j.Provider;function D(e){var n=(0,t.useState)(V)[0],r=(0,t.useContext)(j);return r&&e&&r.getState(n,e)||R}var q=C(),N=M.prototype;function M(e,t,n,r){var i={filters:d({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?M.pageSize:r};for(var a in e=d({},e))P(e,a);q(this,{filters:Object.freeze(e),defaults:i,items:[]}),d(this,i)}function T(e,n,r,i,a){if("string"!=typeof e)return T("__dataView",e,n,r,i);var o=D(e),u=(0,t.useState)()[1],s=(0,t.useState)((function(){return d(new M(n,r,i,a),o.get())}))[0];return(0,t.useEffect)((function(){var e=q(s),t=function(){e.filteredItems=e.items.length?void 0:[],u({})};return S(x(s,t),x(s.filters,t),(function(){o.set(s.toJSON())}))}),[s]),s}w(M,{pageSize:0}),O(M,{itemCount:0,getView:function(e,t){var n=this,r=q(n),i=n.pageIndex||0,a=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filteredItems=r.items.length?void 0:[]);var o=r.filteredItems||(r.filteredItems=((t||u)(r.items,n.filters,n.sortBy)||[])["desc"===n.sortOrder?"reverse":"slice"]());return e&&(n.itemCount=o.length),[o.slice(i*a,a?(i+1)*a:void 0),o.length]},toJSON:function(){var e=this;return d(g(e,b(q(e).defaults)),{filters:d({},e.filters),itemCount:e.itemCount})},reset:function(){d(this,q(this).defaults)}}),P(N,"sortBy"),P(N,"sortOrder"),P(N,"pageIndex"),P(N,"pageSize"),P(N,"filters",{},(function(e){return d(q(this).filters,e)}));var W=n.EventContainer;const _=n.dom;var B=n.dom,L=(B.textInputAllowed,B.beginDrag,B.beginPinchZoom,B.getShortcut,B.setShortcut,B.focusable,B.focused,B.setModal,B.releaseModal,B.retainFocus,B.releaseFocus,B.iterateFocusPath,B.focus);const G=_;var H=n.dom,J=(H.lock,H.locked,H.cancelLock,H.notifyAsync),U=(H.preventLeave,new WeakMap),Z=new W;function K(e){var n=(0,t.useState)((function(){return function e(){var t=U.get(e);return t&&t.apply(this,arguments)}}))[0];return U.set(n,e),n}function Q(e,n){var r=(0,t.useState)()[1],i=e[n],a=(0,t.useRef)();return a.current=i,(0,t.useEffect)((function(){var t=function(e){e!==a.current&&r({})};return t(e[n]),x(e,n,t)}),[e,n]),i}function X(e,n){var r=(0,t.useState)((function(){var t;return{loading:!0,elementRef:function(e){t=e},onError:function(e){return Z.add(r,"error",(function(t){return e.call(r,t.error)}))},refresh:function(){var n;n=k(z().then(e),(function(e,t){if(!r.disposed&&r.promise===n)if(e)d(r,{loading:!1,value:t});else if(d(r,{loading:!1,value:void 0,error:t}),i=t,!Z.emit("error",r,{error:i},!0))throw t;var i})),d(r,{promise:n,loading:!0,error:void 0}),J(t||G.root,F(n))}}}))[0],i=s(n);return e=K(e),n=!1!==n,Q(r,"loading"),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n&&r.refresh()}),[r,n].concat(i)),[r.value,r]}function Y(e){var n=c(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&y(r,t)&&(n[0]=t,e.apply(null,n))}}function $(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return d(S(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function ee(){var e=(0,t.useRef)(null),n=c(arguments);return(0,t.useEffect)((function(){return S(v(n,(function(t){return t.onError((function(t){if(e.current)return G.emit("error",e.current,{error:t},!0)}))})))}),[e].concat(n)),e}var te=C(),ne=(0,t.createContext)(null),re=ne.Provider;function ie(e,t,n){return{toString:function(){return n(d({},e.fields[t]))}}}function ae(e,t,n){var r=this,i={},a={},o=new W,u={},s=te(r,{fields:i,errors:a,eventContainer:o,viewState:n,vlocks:{},refs:{},pending:{},defaults:u,initialData:E(u,e),setValid:P(this,"isValid",!0,(function(){return!m(i,(function(e,t){return!e.disabled&&(a[t]||e.required&&(e.isEmpty?e.isEmpty(r.data[t]):!r.data[t]))}))}))});r.isValid=!0,r.autoPersist=!0,r.validateOnChange=!1!==t,r.data=function(e,t,n){return new Proxy(d({},n),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(n,r,i){return"string"==typeof r&&n[r]!==i&&(r in n&&(te(e).pending[r]=!0,t.emitAsync("dataChange",e,[r],{},(function(e,t){return e.concat(t)}))),n[r]=i),!0}})}(r,o,n.get()||s.initialData),r.on("dataChange",(function(e){if(s.pending={},r.validateOnChange){var t=p(e.data,(function(e){return i[e]&&!1!==i[e].validateOnChange}));t[0]&&r.validate.apply(r,t)}}))}function oe(e,n,r){if("string"!=typeof e)return oe("",e,n);var i=D(e),a=(0,t.useState)((function(){return new ae(n,r,i)}))[0],o=(0,t.useState)()[1];return Q(a,"isValid"),(0,t.useEffect)((function(){return S(a.on("dataChange",(function(){o({})})),(function(){a.autoPersist&&a.persist()}))}),[a]),a}function ue(e,n,r){var i=(0,t.useContext)(ne),a=(0,t.useRef)(),o=e.name||"",u=(0,t.useState)((function(){return i&&i.data[o]||n}))[0],s=(0,t.useState)(u),f=(0,t.useState)(""),c=K(e.onValidate),l=s[0],v=s[1],p=f[0],m=f[1],h=K((function(t){e.onChange?e.onChange("function"==typeof t?t(e[r]):t):console.warn("onChange not supplied")}));return(r=r||"value")in e||(h=v,(e=d({},e))[r]=l),i&&o&&(te(i).fields[o]=e),(0,t.useEffect)((function(){if(i&&o){var e=te(i);return e.refs[o]=a,e.defaults[o]=n,o in i.data&&v(i.data[o]),S((function(){delete e.defaults[o],delete e.fields[o],delete e.refs[o],e.setValid()}),i.on("dataChange",(function(e){e.data.includes(o)&&v(i.data[o])})),i.on("validationChange",(function(t){t.name===o&&m(e.errors[o])})),i.on("validate",(function(e){if(e.name===o)return c(e.value,e.name,i)})),i.on("reset",(function(){v(u),m("")})))}}),[i,o,u,c]),(0,t.useEffect)((function(){var e=i&&o&&te(i).pending;e&&!e[o]&&(i.data[o]=l,e[o]=!1)}),[i,o,l]),(0,t.useEffect)((function(){i&&o&&te(i).setValid()}),[i,o,e.validateOnChange,e.disabled,e.required]),{value:e[r],error:String(e.error||p||""),setValue:h,setError:m,elementRef:function(e){a.current=e}}}function se(){var e=p(c(arguments),f);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),z())}}function fe(){var e=[];return function t(n){l(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(c(r.getClassNames()));else for(var i in r){var a=r[i];a&&e.push(!0===a?i:i+"-"+a)}}))}(c(arguments)),e.join(" ")}function ce(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=h(t,f(n)?n(e[t],e):n)),d({},e,t)}))};return t?n.bind(0,t):n}function de(){return S(c(arguments).map(le))}function le(e){return e&&!f(e)?function(t){return e.current=t}:e||o}O(ae,{element:function(e){var t=te(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&L(t)},on:function(e,t){return te(this).eventContainer.add(this,e,t)},persist:function(){var e=this;te(e).viewState.set(d({},e.data)),e.autoPersist=!1},restore:function(){var e=te(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,n=te(t);for(var r in t.data)delete t.data[r];d(t.data,e||n.initialData),t.isValid=!0,n.eventContainer.emit("reset",t)},validate:function(){var e=this,t=te(e),n=t.vlocks,r=t.errors,i=t.eventContainer,a=c(arguments);a.length||(a=b(t.fields));var o=d({},r),u=function(t){return i.emit("validate",e,{name:t,value:e.data[t]})},s=a.map((function(e){var t=n[e]=n[e]||[],r=t[0];return r?t[1]||(t[1]=k(t[0],(function(){var n=u(e);return k(n,(function(){t[0]===r&&t.shift()})),n}))):(t[0]=z(u(e)),t[0])}));return I(s).then((function(u){return a.forEach((function(a,c){n[a][0]===s[c]&&(n[a].shift(),f(u[c])&&(u[c]=ie(t,a,u[c])),r[a]=u[c],(u[c]||"")!==(o[a]||"")&&i.emit("validationChange",e,{name:a,isValid:!u[c],message:String(u[c]||"")}))})),t.setValid(),!m(u,(function(e){return e}))}))}});const ve=e})(),a=a.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map