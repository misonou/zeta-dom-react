!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{i.d(o,{default:()=>Pe});var e={};i.r(e),i.d(e,{DataView:()=>se,FormContext:()=>pe,FormContextProvider:()=>ve,ViewStateProvider:()=>ne,classNames:()=>ye,combineRef:()=>Ce,combineValidators:()=>ge,createBreakpointContext:()=>$,innerTextOrHTML:()=>Se,partial:()=>be,toRefCallback:()=>Oe,useAsync:()=>Q,useDataView:()=>ce,useDispose:()=>K,useErrorHandlerRef:()=>X,useFormContext:()=>me,useFormField:()=>he,useMediaQuery:()=>Y,useMemoizedFunction:()=>G,useObservableProperty:()=>U,useRefInitCallback:()=>Z,useViewState:()=>re,withSuspense:()=>we});var t=i(359),n=i(654),r=n.util,a=r.noop,u=(r.pipe,r.either,r.is,r.isUndefinedOrNull),s=r.isArray,c=r.isFunction,f=(r.isThenable,r.isPlainObject),l=(r.isArrayLike,r.makeArray),d=r.extend,v=r.each,p=r.map,m=r.grep,h=(r.splice,r.any),g=r.single,y=r.kv,S=(r.fill,r.pick),b=(r.exclude,r.mapObject,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),C=(r.equal,r.combineFn),O=(r.executeOnce,r.createPrivateStore),w=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.isErrorWithCode,r.keys),P=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define),E=r.definePrototype,x=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),k=r.watch,V=(r.watchOnce,r.watchable,r.inherit),R=(r.freeze,r.deepFreeze,r.iequal,r.randomId),z=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),F=(r.reject,r.always),A=r.resolveAll,I=r.catchAsync,M=(r.setPromiseTimeout,r.delay,r.makeAsync),N=n.util,j=(N.domReady,N.tagName,N.isVisible,N.matchSelector,N.comparePosition,N.connected,N.containsOrEquals,N.acceptNode,N.combineNodeFilters,N.iterateNode,N.iterateNodeToArray,N.getCommonAncestor,N.parentsAndSelf,N.selectIncludeSelf,N.selectClosestRelative,N.createNodeIterator,N.createTreeWalker,N.bind);N.bindUntil,N.dispatchDOMMouseEvent,N.removeNode,N.getClass,N.setClass,N.getScrollOffset,N.getScrollParent,N.getContentRect,N.scrollBy,N.scrollIntoView,N.makeSelection,N.getRect,N.getRects,N.toPlainRect,N.rectEquals,N.rectCovers,N.rectIntersects,N.pointInRect,N.mergeRect,N.elementFromPoint;const T=n.dom;var q=n.dom,D=(q.textInputAllowed,q.beginDrag,q.beginPinchZoom,q.getShortcut,q.setShortcut,q.focusable,q.focused,q.setModal,q.releaseModal,q.retainFocus,q.releaseFocus,q.iterateFocusPath,q.focus);const B=T;var W=n.dom,L=(W.lock,W.locked,W.cancelLock,W.notifyAsync),H=(W.preventLeave,n.EventContainer),_=new WeakMap,J=new H;function G(e){var n=(0,t.useState)((function(){return function e(){var t=_.get(e);return t&&t.apply(this,arguments)}}))[0];return _.set(n,e),n}function U(e,n){var r=(0,t.useState)()[1],i=e[n],o=(0,t.useRef)();return o.current=i,(0,t.useEffect)((function(){var t=function(e){e!==o.current&&r({})};return t(e[n]),k(e,n,t)}),[e,n]),i}function Q(e,n){var r=(0,t.useState)((function(){var t;return{loading:!0,elementRef:function(e){t=e},onError:function(e){return J.add(r,"error",(function(t){return e.call(r,t.error)}))},refresh:function(){var n,i=M(e)();return n=F(i,(function(e,t){if(!r.disposed&&r.promise===n)if(e)d(r,{loading:!1,value:t});else if(d(r,{loading:!1,value:void 0,error:t}),i=t,!J.emit("error",r,{error:i},!0))throw t;var i})),d(r,{promise:n,loading:!0,error:void 0}),L(t||B.root,I(n)),i}}}))[0];return n=[!1!==n].concat(s(n)||[]),e=G(e),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n[0]&&r.refresh()}),n),(0,t.useMemo)((function(){n[0]&&(r.loading=!0)}),n),U(r,"loading"),[r.value,r]}function Z(e){var n=l(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&b(r,t)&&(n[0]=t,e.apply(null,n))}}function K(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return d(C(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function X(){var e=(0,t.useRef)(null),n=l(arguments);return(0,t.useEffect)((function(){return C(p(n,(function(t){return t.onError((function(t){if(e.current)return B.emit("error",e.current,{error:t},!0)}))})))}),[e].concat(n)),e}function Y(e){var n=K(),r=(0,t.useState)((function(){var t=matchMedia(e);return n.push(j(t,"change",(function(){r[1](t.matches)}))),t.matches}));return r[0]}function $(e){var n={};return k(n,!0),v(e,(function(e,t){var r=matchMedia(t),i=x(n,e,r.matches,!0);j(r,"change",(function(){i(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=(0,t.useState)()[1];return(0,t.useEffect)((function(){return k(n,(function(){e({})}))})),n}}}var ee=(0,t.createContext)(null),te=Object.freeze({get:a,set:a}),ne=ee.Provider;function re(e){var n=(0,t.useState)(R)[0],r=(0,t.useContext)(ee),i=r&&e&&r.getState(n,e)||te;return(0,t.useEffect)((function(){return i.dispose&&i.dispose.bind(i)}),[i]),i}var ie=O(),oe=se.prototype,ae=new H;function ue(e,t){var n=u(e)&&-1,r=u(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function se(e,t,n,r){var i=this,o={filters:d({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?se.pageSize:r};for(var a in e=d({},e))x(e,a);var u=ie(i,{filters:Object.freeze(e),defaults:o,items:[]}),s=function(){u.sorted=u.items.length?void 0:[],this!==i&&(u.filtered=u.sorted),ae.emitAsync("viewChange",i)};d(this,o),k(i,s),k(i.filters,s)}function ce(e,n,r,i,o){if("string"!=typeof e)return ce("__dataView",e,n,r,i);var u=re(e),s=(0,t.useState)()[1],c=(0,t.useState)((function(){return d(new se(n,r,i,o),u.get())}))[0];return(0,t.useEffect)((function(){var e=ie(c);return C(c.on("viewChange",(function(){s({})})),u.onPopState?u.onPopState((function(t){u.set(c.toJSON()),d(c,t||e.defaults)})):a,(function(){u.set(c.toJSON())}))}),[c]),c}P(se,{pageSize:0}),E(se,{itemCount:0,on:function(e,t){return ae.add(this,e,t)},getView:function(e,t){var n=this,r=ie(n),i=n.pageIndex||0,o=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var a=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=a,e&&(n.itemCount=a.length),[a.slice(i*o,o?(i+1)*o:void 0),a.length]},sort:function(e,t){if(e=l(e),!c(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,i=new Map;return v(e,(function(e,n){i.set(n,t(n))})),e.sort((function(e,t){var n=i.get(e),o=i.get(t);return r*(s(n)?g(n,(function(e,t){return ue(e,o[t])})):ue(n,o))}))},toJSON:function(){var e=this;return d(S(e,w(ie(e).defaults)),{filters:d({},e.filters),itemCount:e.itemCount})},reset:function(){d(this,ie(this).defaults)}}),x(oe,"sortBy"),x(oe,"sortOrder"),x(oe,"pageIndex"),x(oe,"pageSize"),x(oe,"filters",{},(function(e){return d(ie(this).filters,e)}));var fe=O(),le=new H,de=(0,t.createContext)(null),ve=de.Provider;function pe(e,t,n){var r=this,i={},o={},a={},u=fe(r,{fields:i,errors:o,viewState:n,vlocks:{},refs:{},pending:{},defaults:a,initialData:V(a,e),setValid:x(this,"isValid",!0,(function(){return!h(i,(function(e,t){return!e.disabled&&(o[t]||e.required&&(e.isEmpty?e.isEmpty(r.data[t]):!r.data[t]))}))}))});r.isValid=!0,r.autoPersist=!0,r.validateOnChange=!1!==t,r.data=function(e,t){return new Proxy(d({},t),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(t,n,r){return"string"==typeof n&&t[n]!==r&&(n in t&&(fe(e).pending[n]=!0,le.emitAsync("dataChange",e,[n],{},(function(e,t){return e.concat(t)}))),t[n]=r),!0}})}(r,n.get()||u.initialData),r.on("dataChange",(function(e){if(u.pending={},r.validateOnChange){var t=m(e.data,(function(e){return i[e]&&!1!==i[e].validateOnChange}));t[0]&&r.validate.apply(r,t)}}))}function me(e,n,r){if("string"!=typeof e)return me("",e,n);var i=re(e),o=(0,t.useState)((function(){return new pe(n,r,i)}))[0],a=(0,t.useState)()[1];return U(o,"isValid"),(0,t.useEffect)((function(){return C(o.on("dataChange",(function(){a({})})),(function(){o.autoPersist&&o.persist()}))}),[o]),o}function he(e,n,r){r=r||"value";var i=(0,t.useContext)(de),o=(0,t.useRef)(),u=e.name||"",s=(0,t.useState)((function(){return i&&i.data[u]||n}))[0],c=(0,t.useState)(s),f=(0,t.useState)(""),l=G(e.onValidate),v=r in e,p=c[0],m=c[1],h=f[0],g=f[1],y=G((function(t){var n="function"==typeof t?t(e[r]):t;v?e.onChange||console.warn("onChange not supplied"):m(n),(e.onChange||a)(n)}));return v||((e=d({},e))[r]=p),i&&u&&(fe(i).fields[u]=e),(0,t.useEffect)((function(){if(i&&u){var e=fe(i);return e.refs[u]=o,e.defaults[u]=n,u in i.data&&m(i.data[u]),C((function(){delete e.defaults[u],delete e.fields[u],delete e.refs[u],e.setValid()}),i.on("dataChange",(function(e){e.data.includes(u)&&m(i.data[u])})),i.on("validationChange",(function(t){t.name===u&&g(e.errors[u])})),i.on("validate",(function(e){if(e.name===u)return l(e.value,e.name,i)})),i.on("reset",(function(){m(s),g("")})))}}),[i,u,s,l]),(0,t.useEffect)((function(){var e=i&&u&&fe(i).pending;e&&!e[u]&&(i.data[u]=p,e[u]=!1)}),[i,u,p]),(0,t.useEffect)((function(){i&&u&&fe(i).setValid()}),[i,u,e.validateOnChange,e.disabled,e.required]),{value:e[r],error:String(e.error||h||""),setValue:y,setError:g,elementRef:function(e){o.current=e}}}function ge(){var e=m(l(arguments),c);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),z())}}function ye(){var e=[];return function t(n){v(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(l(r.getClassNames()));else for(var i in r){var o=r[i];o&&e.push(!0===o?i:i+"-"+o)}}))}(l(arguments)),e.join(" ")}function Se(e){return f(e)?{dangerouslySetInnerHTML:e}:{children:e}}function be(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=y(t,c(n)?n(e[t],e):n)),d({},e,t)}))};return t?n.bind(0,t):n}function Ce(){return C(l(arguments).map(Oe))}function Oe(e){return e&&!c(e)?function(t){return e.current=t}:e||a}function we(e,n){n=n||t.Fragment,c(n)&&(n=(0,t.createElement)(n));var r=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:n},(0,t.createElement)(r,e))}}E(pe,{element:function(e){var t=fe(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&D(t)},on:function(e,t){return le.add(this,e,t)},persist:function(){var e=this;fe(e).viewState.set(d({},e.data)),e.autoPersist=!1},restore:function(){var e=fe(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,n=fe(t);for(var r in t.data)delete t.data[r];d(t.data,e||n.initialData),t.isValid=!0,le.emit("reset",t)},setError:function(e,t){var n=fe(this),r=n.errors,i=r[e]||"";c(t)&&(t=function(e,t,n){return{toString:function(){return n(d({},e.fields[t]))}}}(n,e,t)),r[e]=t,(t||"")!==i&&(le.emit("validationChange",this,{name:e,isValid:!t,message:String(t||"")}),n.setValid())},validate:function(){var e=this,t=fe(e),n=t.vlocks,r=l(arguments);r.length||(r=w(t.fields));var i=function(t){return le.emit("validate",e,{name:t,value:e.data[t]})},o=r.map((function(e){var t=n[e]=n[e]||[],r=t[0];return r?t[1]||(t[1]=F(t[0],(function(){var n=i(e);return F(n,(function(){t[0]===r&&t.shift()})),n}))):(t[0]=z(i(e)),t[0])}));return A(o).then((function(i){return r.forEach((function(t,r){n[t][0]===o[r]&&(n[t].shift(),e.setError(t,i[r]))})),t.setValid(),!h(i,(function(e){return e}))}))}});const Pe=e})(),o=o.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map