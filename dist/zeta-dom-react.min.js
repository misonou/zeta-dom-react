!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var r={359:t=>{t.exports=e},654:e=>{e.exports=t}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.d(i,{default:()=>Ae});var e={};o.r(e),o.d(e,{DataView:()=>de,Form:()=>Ie,FormContext:()=>ke,FormContextProvider:()=>xe,ViewStateProvider:()=>ae,classNames:()=>ve,combineRef:()=>he,combineValidators:()=>ze,createBreakpointContext:()=>ne,innerTextOrHTML:()=>me,partial:()=>ye,registerFieldType:()=>Fe,toRefCallback:()=>ge,useAsync:()=>X,useDataView:()=>pe,useDispose:()=>$,useErrorHandler:()=>te,useErrorHandlerRef:()=>ee,useFormContext:()=>Re,useFormField:()=>Ve,useMediaQuery:()=>re,useMemoizedFunction:()=>Q,useObservableProperty:()=>Z,useRefInitCallback:()=>Y,useUpdateTrigger:()=>G,useViewState:()=>ue,withSuspense:()=>be});var t=o(359),r=o(654),n=r.util,a=n.noop,u=n.pipe,s=(n.either,n.is),c=n.isUndefinedOrNull,f=n.isArray,l=n.isFunction,d=(n.isThenable,n.isPlainObject),p=(n.isArrayLike,n.makeArray),v=n.extend,m=n.each,y=n.map,h=n.grep,g=(n.splice,n.any),b=n.single,S=n.kv,C=(n.fill,n.pick),w=n.exclude,O=(n.mapObject,n.mapGet,n.mapRemove,n.arrRemove,n.setAdd),P=(n.equal,n.combineFn),x=(n.executeOnce,n.createPrivateStore),E=(n.setTimeout,n.setTimeoutOnce,n.setInterval,n.setIntervalSafe,n.setImmediate,n.setImmediateOnce,n.throwNotFunction,n.errorWithCode,n.isErrorWithCode),k=n.keys,R=(n.values,n.hasOwnProperty,n.getOwnPropertyDescriptors,n.define),V=n.definePrototype,z=(n.defineOwnProperty,n.defineGetterProperty,n.defineHiddenProperty,n.defineAliasProperty,n.defineObservableProperty),F=n.watch,I=(n.watchOnce,n.watchable,n.inherit,n.freeze,n.deepFreeze,n.iequal,n.randomId),A=(n.repeat,n.camel,n.hyphenate,n.ucfirst,n.lcfirst,n.trim,n.matchWord,n.htmlDecode,n.resolve),M=(n.reject,n.always),N=n.resolveAll,j=(n.retryable,n.deferrable,n.catchAsync,n.setPromiseTimeout,n.delay,n.makeAsync),H=r.util,T=(H.domReady,H.tagName,H.isVisible,H.matchSelector,H.comparePosition,H.connected,H.containsOrEquals,H.acceptNode,H.combineNodeFilters,H.iterateNode,H.iterateNodeToArray,H.getCommonAncestor,H.parentsAndSelf,H.selectIncludeSelf,H.selectClosestRelative,H.createNodeIterator,H.createTreeWalker,H.bind);H.bindUntil,H.dispatchDOMMouseEvent,H.removeNode,H.getClass,H.setClass,H.getScrollOffset,H.getScrollParent,H.getContentRect,H.scrollBy,H.scrollIntoView,H.makeSelection,H.getRect,H.getRects,H.toPlainRect,H.rectEquals,H.rectCovers,H.rectIntersects,H.pointInRect,H.mergeRect,H.elementFromPoint;const D=r.dom;var q=r.dom,B=(q.textInputAllowed,q.beginDrag,q.beginPinchZoom,q.getShortcut,q.setShortcut,q.focusable,q.focused,q.setModal,q.releaseModal,q.retainFocus,q.releaseFocus,q.iterateFocusPath,q.focus);const K=D;var L=r.dom,W=(L.lock,L.locked,L.cancelLock,L.subscribeAsync,L.notifyAsync),J=(L.preventLeave,r.EventContainer),U=new WeakMap,_=new J;function G(){var e=(0,t.useState)()[1];return(0,t.useCallback)((function(){e({})}),[])}function Q(e){var r=(0,t.useCallback)((function e(){var t=U.get(e);return t&&t.apply(this,arguments)}),[]);return U.set(r,e),r}function Z(e,r){var n=G(),o=e[r],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&n()};return t(e[r]),F(e,r,t)}),[e,r]),o}function X(e,r){var n=(0,t.useState)((function(){var t,r;return{loading:!0,elementRef:function(e){t=e},on:function(e,t){return _.add(n,e,t)},onError:function(e){return n.on("error",(function(t){return e.call(n,t.error)}))},refresh:function(){v(n,{loading:!0,error:void 0});var o=j(e)(),i=M(o,(function(e,t){if(!n.disposed&&r===i)if(e)v(n,{loading:!1,value:t}),_.emit("load",n,{data:t});else if(v(n,{loading:!1,value:void 0,error:t}),!_.emit("error",n,{error:t}))throw t}));return r=i,W(t||K.root,i),o}}}))[0];return r=[!1!==r].concat(f(r)||[]),e=Q(e),(0,t.useEffect)((function(){return function(){n.disposed=!0}}),[n]),(0,t.useEffect)((function(){r[0]&&n.refresh()}),r),(0,t.useMemo)((function(){r[0]&&(n.loading=!0)}),r),Z(n,"loading"),[n.value,n]}function Y(e){var r=p(arguments),n=(0,t.useState)(new WeakSet)[0];return function(t){t&&O(n,t)&&(r[0]=t,e.apply(null,r))}}function $(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return v(P(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function ee(){return te.apply(this,arguments).ref}function te(){var e=(0,t.useRef)(!1),r=(0,t.useRef)(null),n=p(arguments),o=(0,t.useState)((function(){return{ref:function(e){r.current=e,c(e)},catch:function(e,t){var r;return t?r=l(e)?s:E:t=e,_.add(o,r?"error":"default",(function(n){if((r||u)(n.error,e))return t(n.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,K.emit("error",r.current||K.root,{error:t},!0)}finally{e.current=!1}}),[]),a=(0,t.useCallback)((function(e){return _.emit("error",o,{error:e})||_.emit("default",o,{error:e})}),[]),c=Y((function(t){K.on(t,"error",(function(t){if(!e.current)return a(t.error)}))}));return(0,t.useEffect)((function(){return P(y(n,(function(e){return e.onError((function(e){return a(e)||i(e)||A()}))})))}),n),o}function re(e){var r=$(),n=(0,t.useState)((function(){var t=matchMedia(e);return r.push(T(t,"change",(function(){n[1](t.matches)}))),t.matches}));return n[0]}function ne(e){var r={};return F(r,!0),m(e,(function(e,t){var n=matchMedia(t),o=z(r,e,n.matches,!0);T(n,"change",(function(){o(n.matches)}))})),{breakpoints:Object.freeze(r),useBreakpoint:function(){var e=G();return(0,t.useEffect)((function(){return F(r,e)}),[]),r}}}var oe=(0,t.createContext)(null),ie=Object.freeze({get:a,set:a}),ae=oe.Provider;function ue(e){var r=(0,t.useState)(I)[0],n=(0,t.useContext)(oe),o=n&&e&&n.getState(r,e)||ie;return(0,t.useEffect)((function(){return o.dispose&&o.dispose.bind(o)}),[o]),o}var se=x(),ce=de.prototype,fe=new J;function le(e,t){var r=c(e)&&-1,n=c(t)&&1;return r||n?r+n:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function de(e,t,r,n){var o=this,i={filters:v({},e),sortBy:t,sortOrder:r||t&&"asc",pageIndex:0,pageSize:void 0===n?de.pageSize:n};for(var a in e=v({},e))z(e,a);var u=se(o,{filters:Object.freeze(e),defaults:i,items:[]}),s=function(){u.sorted=u.items.length?void 0:[],this!==o&&(u.filtered=u.sorted),fe.emitAsync("viewChange",o)};v(this,i),F(o,s),F(o.filters,s)}function pe(e,r,n,o,i){if("string"!=typeof e)return pe("__dataView",e,r,n,o);var u=ue(e),s=G(),c=(0,t.useState)((function(){return v(new de(r,n,o,i),u.get())}))[0];return(0,t.useEffect)((function(){var e=se(c);return P(c.on("viewChange",s),u.onPopState?u.onPopState((function(t){u.set(c.toJSON()),v(c,t||e.defaults)})):a,(function(){u.set(c.toJSON())}))}),[c]),c}function ve(){var e=[];return function t(r){m(r,(function(r,n){if(n)if("string"==typeof n)e.push(n);else if("function"==typeof n.getClassNames)t(p(n.getClassNames()));else for(var o in n){var i=n[o];i&&e.push(!0===i?o:o+"-"+i)}}))}(p(arguments)),e.join(" ")}function me(e){return d(e)?{dangerouslySetInnerHTML:e}:{children:e}}function ye(e,t){var r=function(t,r){e((function(e){return"string"==typeof t&&(t=S(t,l(r)?r(e[t],e):r)),v({},e,t)}))};return t?r.bind(0,t):r}function he(){return P(p(arguments).map(ge))}function ge(e){return e&&!l(e)?function(t){return e.current=t}:e||a}function be(e,r){r=r||t.Fragment,l(r)&&(r=(0,t.createElement)(r));var n=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:r},(0,t.createElement)(n,e))}}function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}R(de,{pageSize:0}),V(de,{itemCount:0,on:function(e,t){return fe.add(this,e,t)},getView:function(e,t){var r=this,n=se(r),o=r.pageIndex||0,i=r.pageSize||0;e!==n.items&&(n.items=e||[],n.filtered=n.items.length?void 0:[],n.sorted=n.filtered),t=t||function(e){return r.sort(e)};var a=n.sorted||(n.sorted=t.call(r,n.filtered||n.items,r.filters,r.sortBy,r.sortOrder)||[]);return n.filtered=a,e&&(r.itemCount=a.length),[a.slice(o*i,i?(o+1)*i:void 0),a.length]},sort:function(e,t){if(e=p(e),!l(t)){var r=t||this.sortBy;if(!r)return e;t=function(e){return e[r]}}var n="desc"===this.sortOrder?-1:1,o=new Map;return m(e,(function(e,r){o.set(r,t(r))})),e.sort((function(e,t){var r=o.get(e),i=o.get(t);return n*(f(r)?b(r,(function(e,t){return le(e,i[t])})):le(r,i))}))},toJSON:function(){var e=this;return v(C(e,k(se(e).defaults)),{filters:v({},e.filters),itemCount:e.itemCount})},reset:function(){v(this,se(this).defaults)}}),z(ce,"sortBy"),z(ce,"sortOrder"),z(ce,"pageIndex"),z(ce,"pageSize"),z(ce,"filters",{},(function(e){return v(se(this).filters,e)}));var Ce=x(),we=new J,Oe={},Pe=(0,t.createContext)(null),xe=Pe.Provider;function Ee(e){return c(e)||""===e||f(e)&&!e.length}function ke(e,t,r){var n=this,o={},i=Ce(n,{fields:o,viewState:r,vlocks:{},initialData:e,setValid:z(this,"isValid",!0,(function(){return!g(o,(function(e,t){var r=e.props;return!r.disabled&&(e.error||r.required&&(r.isEmpty||e.preset.isEmpty||Ee)(n.data[t]))}))}))});v(n,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),v({autoPersist:!0,validateOnChange:!0},e)}(t)),n.ref=function(e){i.ref=e},n.isValid=!0,n.data=function(e,t){var r=Ce(e);return new Proxy(v({},t),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(t,n,o){return"string"==typeof n&&t[n]!==o&&(n in t&&((r.fields[n]||{}).dirty=!0,we.emitAsync("dataChange",e,[n],{},(function(e,t){return e.concat(t)}))),t[n]=o),!0}})}(n,r.get()||i.initialData),n.on("dataChange",(function(e){if(n.validateOnChange){var t=h(e.data,(function(e){return o[e]&&!1!==o[e].props.validateOnChange}));t[0]&&n.validate.apply(n,t)}}))}function Re(e,r,n){if("string"!=typeof e)return Re("",e,r);var o=ue(e),i=(0,t.useState)((function(){return new ke(r,n,o)}))[0],a=G();return Z(i,"isValid"),(0,t.useEffect)((function(){return P(i.on("dataChange",a),i.on("reset",a),(function(){i.autoPersist&&i.persist()}))}),[i]),i}function Ve(e,r,n,o){"string"!=typeof e&&(o=n,n=r,r=e,e="");var i=Oe[e]||{};o=o||i.valueProperty||"value";var s=v((0,t.useState)({})[0],{preset:i,props:r}),c=(0,t.useContext)(Pe),f=c&&c.data,l=c&&Ce(c),d=r.name||"",p=(0,t.useState)((function(){return c&&d in f?f[d]:n}))[0],m=(0,t.useState)(p),y=(0,t.useState)(""),h=o in r,g=h?r[o]:m[0],b=h?a:m[1],S=y[0],C=y[1],w=Q((function(e){e="function"==typeof e?e(g):e,b(e),c&&!s.dirty&&(f[d]=e,s.dirty=!1),h&&!r.onChange&&console.warn("onChange not supplied"),(r.onChange||a)(e)}));return c&&d&&(l.fields[d]=s,!h&&d in f||(f[d]=g)),(0,t.useEffect)((function(){if(c&&d)return P((function(){l.fields[d]===s&&(delete l.fields[d],l.setValid())}),c.on("dataChange",(function(e){e.data.includes(d)&&(s.dirty=!1,b(f[d]))})),c.on("validationChange",(function(e){e.name===d&&C(s.error)})),c.on("reset",(function(){f[d]=p,b(p),C("")})))}),[c,d,f,p]),(0,t.useEffect)((function(){l&&(s.error=r.error||S,l.setValid())}),[l,S,r.error,r.disabled,r.required]),(i.postHook||u)({form:c,value:g,error:String(r.error||S||""),setValue:w,setError:C,elementRef:function(e){s.element=e}},r)}function ze(){var e=h(p(arguments),l);return function(t,r){return e.reduce((function(e,n){return e.then((function(e){return e||n(t,r)}))}),A())}}function Fe(e,t){l(t)&&(t={postHook:t}),Oe[e]=t}V(ke,{element:function(e){var t=Ce(this).fields[e];return t&&t.element},focus:function(e){var t=this.element(e);t&&B(t)},on:function(e,t){return we.add(this,e,t)},persist:function(){var e=this;Ce(e).viewState.set(v({},e.data)),e.autoPersist=!1},restore:function(){var e=Ce(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,r=Ce(t);for(var n in t.data)delete t.data[n];m(r.fields,(function(e,t){t.error=null})),v(t.data,e||r.initialData),r.setValid(),we.emit("reset",t)},setError:function(e,t){var r=Ce(this),n=r.fields[e]||{},o=n.error||"";l(t)&&(t=function(e,t,r){return{toString:function(){return r((e.fields[t]||"").props||{})}}}(r,e,t)),n.error=t,(t||"")!==o&&(we.emit("validationChange",this,{name:e,isValid:!t,message:String(t||"")}),r.setValid())},validate:function(){var e=this,t=Ce(e),r=t.vlocks,n=p(arguments);n.length||(n=k(t.fields));var o=function(r){var n=t.fields[r],o=e.data[r],i=we.emit("validate",e,{name:r,value:o});return!i&&n&&(i=(n.props.onValidate||a)(o,r,e)),i},i=n.map((function(e){var t=r[e]=r[e]||[],n=t[0];return n?t[1]||(t[1]=M(t[0],(function(){var r=o(e);return M(r,(function(){t[0]===n&&t.shift()})),r}))):(t[0]=A(o(e)),t[0])}));return N(i).then((function(o){return n.forEach((function(t,n){r[t][0]===i[n]&&(r[t].shift(),e.setError(t,o[n]))})),t.setValid(),!g(o,(function(e){return e}))}))},toJSON:function(){return v(!0,{},this.data)}});var Ie=(0,t.forwardRef)((function(e,r){var n=e.context;return v(n,C(e,["enterKeyHint"])),(0,t.createElement)(xe,{value:n},(0,t.createElement)("form",v(w(e,["context","enterKeyHint"]),{ref:he(r,n.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||a).call(this,t)},onReset:function(t){t.preventDefault(),n.reset(),(e.onReset||a).call(this,t)}})))}));Fe("text",(function(e,t){var r=e.form,n=C(t,["type","autoComplete","maxLength","inputMode","placeholder","enterKeyHint"]);return"password"!==t.type||n.autoComplete||(n.autoComplete="current-password"),n.type=n.type||"text",n.enterKeyHint=n.enterKeyHint||r&&r.enterKeyHint,v(e,{inputProps:n})})),Fe("choice",(function(e,r){var n=(0,t.useMemo)((function(){return r.items.map((function(e){return"object"===Se(e)?e:{label:String(e),value:e}}))}),[r.items]),o=n.findIndex((function(t){return t.value===e.value}));return(0,t.useEffect)((function(){if(o<0){var t=r.allowUnselect||!n[0]?"":n[0].value;t!==e.value&&e.setValue(t)}})),v(e,{items:n,selectedIndex:o,selectedItem:n[o]})})),Fe("toggle",{valueProperty:"checked",isEmpty:function(e){return!e}});const Ae=e;r.react=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map