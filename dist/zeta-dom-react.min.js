!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.d(i,{default:()=>Ae});var e={};o.r(e),o.d(e,{DataView:()=>de,Form:()=>Ie,FormContext:()=>ke,FormContextProvider:()=>xe,ViewStateProvider:()=>ae,classNames:()=>ve,combineRef:()=>ye,combineValidators:()=>ze,createBreakpointContext:()=>re,innerTextOrHTML:()=>me,partial:()=>he,registerFieldType:()=>Fe,toRefCallback:()=>ge,useAsync:()=>X,useDataView:()=>pe,useDispose:()=>$,useErrorHandler:()=>te,useErrorHandlerRef:()=>ee,useFormContext:()=>Re,useFormField:()=>Ve,useMediaQuery:()=>ne,useMemoizedFunction:()=>Q,useObservableProperty:()=>Z,useRefInitCallback:()=>Y,useViewState:()=>ue,withSuspense:()=>Se});var t=o(359),n=o(654),r=n.util,a=r.noop,u=r.pipe,s=(r.either,r.is),c=r.isUndefinedOrNull,f=r.isArray,l=r.isFunction,d=(r.isThenable,r.isPlainObject),p=(r.isArrayLike,r.makeArray),v=r.extend,m=r.each,h=r.map,y=r.grep,g=(r.splice,r.any),S=r.single,b=r.kv,C=(r.fill,r.pick),w=r.exclude,O=(r.mapObject,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),P=(r.equal,r.combineFn),x=(r.executeOnce,r.createPrivateStore),E=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.isErrorWithCode),k=r.keys,R=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define),V=r.definePrototype,z=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),F=r.watch,I=(r.watchOnce,r.watchable,r.inherit),A=(r.freeze,r.deepFreeze,r.iequal,r.randomId),M=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),j=(r.reject,r.always),N=r.resolveAll,H=(r.retryable,r.deferrable,r.catchAsync,r.setPromiseTimeout,r.delay,r.makeAsync),T=n.util,D=(T.domReady,T.tagName,T.isVisible,T.matchSelector,T.comparePosition,T.connected,T.containsOrEquals,T.acceptNode,T.combineNodeFilters,T.iterateNode,T.iterateNodeToArray,T.getCommonAncestor,T.parentsAndSelf,T.selectIncludeSelf,T.selectClosestRelative,T.createNodeIterator,T.createTreeWalker,T.bind);T.bindUntil,T.dispatchDOMMouseEvent,T.removeNode,T.getClass,T.setClass,T.getScrollOffset,T.getScrollParent,T.getContentRect,T.scrollBy,T.scrollIntoView,T.makeSelection,T.getRect,T.getRects,T.toPlainRect,T.rectEquals,T.rectCovers,T.rectIntersects,T.pointInRect,T.mergeRect,T.elementFromPoint;const q=n.dom;var B=n.dom,K=(B.textInputAllowed,B.beginDrag,B.beginPinchZoom,B.getShortcut,B.setShortcut,B.focusable,B.focused,B.setModal,B.releaseModal,B.retainFocus,B.releaseFocus,B.iterateFocusPath,B.focus);const L=q;var W=n.dom,_=(W.lock,W.locked,W.cancelLock,W.subscribeAsync,W.notifyAsync),J=(W.preventLeave,n.EventContainer),U=new WeakMap,G=new J;function Q(e){var n=(0,t.useState)((function(){return function e(){var t=U.get(e);return t&&t.apply(this,arguments)}}))[0];return U.set(n,e),n}function Z(e,n){var r=(0,t.useState)()[1],o=e[n],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&r({})};return t(e[n]),F(e,n,t)}),[e,n]),o}function X(e,n){var r=(0,t.useState)((function(){var t,n;return{loading:!0,elementRef:function(e){t=e},on:function(e,t){return G.add(r,e,t)},onError:function(e){return r.on("error",(function(t){return e.call(r,t.error)}))},refresh:function(){v(r,{loading:!0,error:void 0});var o=H(e)(),i=j(o,(function(e,t){if(!r.disposed&&n===i)if(e)v(r,{loading:!1,value:t}),G.emit("load",r,{data:t});else if(v(r,{loading:!1,value:void 0,error:t}),!G.emit("error",r,{error:t}))throw t}));return n=i,_(t||L.root,i),o}}}))[0];return n=[!1!==n].concat(f(n)||[]),e=Q(e),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n[0]&&r.refresh()}),n),(0,t.useMemo)((function(){n[0]&&(r.loading=!0)}),n),Z(r,"loading"),[r.value,r]}function Y(e){var n=p(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&O(r,t)&&(n[0]=t,e.apply(null,n))}}function $(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return v(P(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function ee(){return te.apply(this,arguments).ref}function te(){var e=(0,t.useRef)(!1),n=(0,t.useRef)(null),r=p(arguments),o=(0,t.useState)((function(){return{ref:function(e){n.current=e,c(e)},catch:function(e,t){var n;return t?n=l(e)?s:E:t=e,G.add(o,n?"error":"default",(function(r){if((n||u)(r.error,e))return t(r.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,L.emit("error",n.current||L.root,{error:t},!0)}finally{e.current=!1}}),[]),a=(0,t.useCallback)((function(e){return G.emit("error",o,{error:e})||G.emit("default",o,{error:e})}),[]),c=Y((function(t){L.on(t,"error",(function(t){if(!e.current)return a(t.error)}))}));return(0,t.useEffect)((function(){return P(h(r,(function(e){return e.onError((function(e){return a(e)||i(e)||M()}))})))}),r),o}function ne(e){var n=$(),r=(0,t.useState)((function(){var t=matchMedia(e);return n.push(D(t,"change",(function(){r[1](t.matches)}))),t.matches}));return r[0]}function re(e){var n={};return F(n,!0),m(e,(function(e,t){var r=matchMedia(t),o=z(n,e,r.matches,!0);D(r,"change",(function(){o(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=(0,t.useState)()[1];return(0,t.useEffect)((function(){return F(n,(function(){e({})}))})),n}}}var oe=(0,t.createContext)(null),ie=Object.freeze({get:a,set:a}),ae=oe.Provider;function ue(e){var n=(0,t.useState)(A)[0],r=(0,t.useContext)(oe),o=r&&e&&r.getState(n,e)||ie;return(0,t.useEffect)((function(){return o.dispose&&o.dispose.bind(o)}),[o]),o}var se=x(),ce=de.prototype,fe=new J;function le(e,t){var n=c(e)&&-1,r=c(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function de(e,t,n,r){var o=this,i={filters:v({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?de.pageSize:r};for(var a in e=v({},e))z(e,a);var u=se(o,{filters:Object.freeze(e),defaults:i,items:[]}),s=function(){u.sorted=u.items.length?void 0:[],this!==o&&(u.filtered=u.sorted),fe.emitAsync("viewChange",o)};v(this,i),F(o,s),F(o.filters,s)}function pe(e,n,r,o,i){if("string"!=typeof e)return pe("__dataView",e,n,r,o);var u=ue(e),s=(0,t.useState)()[1],c=(0,t.useState)((function(){return v(new de(n,r,o,i),u.get())}))[0];return(0,t.useEffect)((function(){var e=se(c);return P(c.on("viewChange",(function(){s({})})),u.onPopState?u.onPopState((function(t){u.set(c.toJSON()),v(c,t||e.defaults)})):a,(function(){u.set(c.toJSON())}))}),[c]),c}function ve(){var e=[];return function t(n){m(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(p(r.getClassNames()));else for(var o in r){var i=r[o];i&&e.push(!0===i?o:o+"-"+i)}}))}(p(arguments)),e.join(" ")}function me(e){return d(e)?{dangerouslySetInnerHTML:e}:{children:e}}function he(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=b(t,l(n)?n(e[t],e):n)),v({},e,t)}))};return t?n.bind(0,t):n}function ye(){return P(p(arguments).map(ge))}function ge(e){return e&&!l(e)?function(t){return e.current=t}:e||a}function Se(e,n){n=n||t.Fragment,l(n)&&(n=(0,t.createElement)(n));var r=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:n},(0,t.createElement)(r,e))}}function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}R(de,{pageSize:0}),V(de,{itemCount:0,on:function(e,t){return fe.add(this,e,t)},getView:function(e,t){var n=this,r=se(n),o=n.pageIndex||0,i=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var a=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=a,e&&(n.itemCount=a.length),[a.slice(o*i,i?(o+1)*i:void 0),a.length]},sort:function(e,t){if(e=p(e),!l(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return m(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),i=o.get(t);return r*(f(n)?S(n,(function(e,t){return le(e,i[t])})):le(n,i))}))},toJSON:function(){var e=this;return v(C(e,k(se(e).defaults)),{filters:v({},e.filters),itemCount:e.itemCount})},reset:function(){v(this,se(this).defaults)}}),z(ce,"sortBy"),z(ce,"sortOrder"),z(ce,"pageIndex"),z(ce,"pageSize"),z(ce,"filters",{},(function(e){return v(se(this).filters,e)}));var Ce=x(),we=new J,Oe={},Pe=(0,t.createContext)(null),xe=Pe.Provider;function Ee(e){return c(e)||""===e||f(e)&&!e.length}function ke(e,t,n){var r=this,o={},i={},a={},u=Ce(r,{fields:o,errors:i,viewState:n,vlocks:{},refs:{},pending:{},defaults:a,initialData:I(a,e),setValid:z(this,"isValid",!0,(function(){return!g(o,(function(e,t){var n=e.props;return!n.disabled&&(i[t]||n.required&&(n.isEmpty||e.preset.isEmpty||Ee)(r.data[t]))}))}))});v(r,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),v({autoPersist:!0,validateOnChange:!0},e)}(t)),r.ref=function(e){u.ref=e},r.isValid=!0,r.data=function(e,t){return new Proxy(v({},t),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(t,n,r){return"string"==typeof n&&t[n]!==r&&(n in t&&(Ce(e).pending[n]=!0,we.emitAsync("dataChange",e,[n],{},(function(e,t){return e.concat(t)}))),t[n]=r),!0}})}(r,n.get()||u.initialData),r.on("dataChange",(function(e){if(u.pending={},r.validateOnChange){var t=y(e.data,(function(e){return o[e]&&!1!==o[e].props.validateOnChange}));t[0]&&r.validate.apply(r,t)}}))}function Re(e,n,r){if("string"!=typeof e)return Re("",e,n);var o=ue(e),i=(0,t.useState)((function(){return new ke(n,r,o)}))[0],a=(0,t.useState)()[1];return Z(i,"isValid"),(0,t.useEffect)((function(){return P(i.on("dataChange",(function(){a({})})),(function(){i.autoPersist&&i.persist()}))}),[i]),i}function Ve(e,n,r,o){"string"!=typeof e&&(o=r,r=n,n=e,e="");var i=Oe[e]||{};o=o||i.valueProperty||"value";var s=(0,t.useContext)(Pe),c=(0,t.useRef)(),f=n.name||"",l=(0,t.useState)((function(){return s&&s.data[f]||r}))[0],d=(0,t.useState)(l),p=(0,t.useState)(""),v=Q(n.onValidate),m=o in n,h=m?n[o]:d[0],y=m?a:d[1],g=p[0],S=p[1],b=Q((function(e){e="function"==typeof e?e(h):e,m?n.onChange||console.warn("onChange not supplied"):y(e),(n.onChange||a)(e)}));return s&&f&&(Ce(s).fields[f]={preset:i,props:n}),(0,t.useEffect)((function(){if(s&&f){var e=Ce(s);return e.refs[f]=c,e.defaults[f]=r,f in s.data&&y(s.data[f]),P((function(){delete e.defaults[f],delete e.fields[f],delete e.refs[f],e.setValid()}),s.on("dataChange",(function(e){e.data.includes(f)&&y(s.data[f])})),s.on("validationChange",(function(t){t.name===f&&S(e.errors[f])})),s.on("validate",(function(e){if(e.name===f)return v(e.value,e.name,s)})),s.on("reset",(function(){y(l),S("")})))}}),[s,f,l,v]),(0,t.useEffect)((function(){var e=s&&f&&Ce(s).pending;e&&!e[f]&&(s.data[f]=h,e[f]=!1)}),[s,f,h]),(0,t.useEffect)((function(){s&&f&&Ce(s).setValid()}),[s,f,n.validateOnChange,n.disabled,n.required]),(i.postHook||u)({form:s,value:h,error:String(n.error||g||""),setValue:b,setError:S,elementRef:function(e){c.current=e}},n)}function ze(){var e=y(p(arguments),l);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),M())}}function Fe(e,t){l(t)&&(t={postHook:t}),Oe[e]=t}V(ke,{element:function(e){var t=Ce(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&K(t)},on:function(e,t){return we.add(this,e,t)},persist:function(){var e=this;Ce(e).viewState.set(v({},e.data)),e.autoPersist=!1},restore:function(){var e=Ce(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,n=Ce(t);for(var r in t.data)delete t.data[r];v(t.data,e||n.initialData),t.isValid=!0,we.emit("reset",t)},setError:function(e,t){var n=Ce(this),r=n.errors,o=r[e]||"";l(t)&&(t=function(e,t,n){return{toString:function(){return n((e.fields[t]||"").props||{})}}}(n,e,t)),r[e]=t,(t||"")!==o&&(we.emit("validationChange",this,{name:e,isValid:!t,message:String(t||"")}),n.setValid())},validate:function(){var e=this,t=Ce(e),n=t.vlocks,r=p(arguments);r.length||(r=k(t.fields));var o=function(t){return we.emit("validate",e,{name:t,value:e.data[t]})},i=r.map((function(e){var t=n[e]=n[e]||[],r=t[0];return r?t[1]||(t[1]=j(t[0],(function(){var n=o(e);return j(n,(function(){t[0]===r&&t.shift()})),n}))):(t[0]=M(o(e)),t[0])}));return N(i).then((function(o){return r.forEach((function(t,r){n[t][0]===i[r]&&(n[t].shift(),e.setError(t,o[r]))})),t.setValid(),!g(o,(function(e){return e}))}))}});var Ie=(0,t.forwardRef)((function(e,n){var r=e.context;return v(r,C(e,["enterKeyHint"])),(0,t.createElement)(xe,{value:r},(0,t.createElement)("form",v(w(e,["context","enterKeyHint"]),{ref:ye(n,r.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||a).call(this,t)}})))}));Fe("text",(function(e,t){var n=e.form,r=C(t,["type","autoComplete","maxLength","inputMode","placeholder","enterKeyHint"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,v(e,{inputProps:r})})),Fe("choice",(function(e,n){var r=(0,t.useMemo)((function(){return n.items.map((function(e){return"object"===be(e)?e:{label:String(e),value:e}}))}),[n.items]),o=r.findIndex((function(t){return t.value===e.value}));return(0,t.useEffect)((function(){if(o<0){var t=n.allowUnselect||!r[0]?"":r[0].value;t!==e.value&&e.setValue(t)}})),v(e,{items:r,selectedIndex:o,selectedItem:r[o]})})),Fe("toggle",{valueProperty:"checked",isEmpty:function(e){return!e}});const Ae=e;n.react=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map