/*! zeta-dom-react v0.5.5 | (c) misonou | https://misonou.github.io */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("zeta-dom"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["zeta-dom","react","react-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("zeta-dom"),require("react"),require("react-dom")):(e.zeta=e.zeta||{},e.zeta.react=t(e.zeta,e.React,e.ReactDOM))}(self,((e,t,n)=>(()=>{"use strict";var r={12:e=>{e.exports=t},311:e=>{e.exports=n},231:t=>{t.exports=e}},o={};function u(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,u),n.exports}u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{u.r(i),u.d(i,{ChoiceField:()=>it,DataView:()=>Ge,DateField:()=>pt,Form:()=>Yt,FormArray:()=>$t,FormContext:()=>Wt,FormContextProvider:()=>Gt,FormObject:()=>Qt,HiddenField:()=>Zt,MultiChoiceField:()=>mt,NumericField:()=>ht,TextField:()=>gt,ToggleField:()=>yt,ValidationError:()=>zt,ViewStateProvider:()=>Be,classNames:()=>Xe,combineRef:()=>nt,combineValidators:()=>Jt,createBreakpointContext:()=>Le,domEventRef:()=>Ze,innerTextOrHTML:()=>et,isSingletonDisposed:()=>De,partial:()=>tt,registerFieldType:()=>Ut,toRefCallback:()=>rt,useAsync:()=>Me,useAutoSetRef:()=>Ce,useDataView:()=>$e,useDispose:()=>Fe,useEagerReducer:()=>Ee,useEagerState:()=>xe,useErrorHandler:()=>He,useErrorHandlerRef:()=>Ne,useEventTrigger:()=>Oe,useFormContext:()=>Kt,useFormField:()=>_t,useMediaQuery:()=>Te,useMemoizedFunction:()=>ze,useObservableProperty:()=>Pe,useRefInitCallback:()=>Re,useSingleton:()=>Ie,useUnloadEffect:()=>je,useUpdateTrigger:()=>Ve,useValueTrigger:()=>ke,useViewState:()=>We,withSuspense:()=>ot});var e=u(231),t=e.util,n=t.always,r=t.any,o=t.catchAsync,a=t.clearImmediateOnce,f=t.combineFn,c=t.createPrivateStore,s=t.deferrable,l=t.define,d=t.defineGetterProperty,v=t.defineObservableProperty,p=t.definePrototype,m=t.delay,h=t.each,g=t.either,y=t.exclude,b=t.extend,S=t.fill,w=t.freeze,C=t.grep,E=t.hasOwnProperty,x=t.is,V=t.isArray,k=t.isErrorWithCode,O=t.isFunction,z=t.isPlainObject,P=t.isUndefinedOrNull,M=t.keys,R=t.kv,F=t.makeArray,D=t.makeAsync,I=t.map,N=t.mapGet,H=t.mapRemove,j=t.noop,T=t.pick,L=t.pipe,A=t.randomId,q=t.resolve,B=t.resolveAll,W=t.sameValueZero,K=t.setAdd,_=t.setImmediate,J=t.setImmediateOnce,U=t.single,Y=t.splice,G=t.throwNotFunction,$=t.throws,Q=t.watch,Z=u(12),X=e.util,ee=X.bind,te=X.comparePosition,ne=X.parentsAndSelf,re=e.dom;const oe=re;var ue=re.focus,ie=re.reportError,ae=e.dom,fe=ae.notifyAsync,ce=ae.preventLeave,se=e.EventContainer,le=u(311),de=!0;le.flushSync((function(){function e(){return de=!de,null}var t=document.createElement("div"),n=(0,Z.createElement)(Z.StrictMode,null,(0,Z.createElement)(e));le.createRoot?le.createRoot(t).render(n):le.render(n,t)}));var ve=de,pe=new se,me=new Map,he=new WeakSet,ge=new Set,ye=window.AbortController,be=ve?function(e,t){me.has(e)||(me.set(e,t),we.d=0,a(we));(0,Z.useEffect)((function(){var t=function(t){me.get(e).d=t?4:2,we.d|=t?1:2,J(we)};return t(!0),t}),[e])}:function(e,t){(0,Z.useEffect)((function(){return function(){he.add(e),t(!0)}}),[e])},Se=Object.is||function(e,t){return W(e,t)&&(0!==e||1/e==1/t)};function we(){h(me,(function(e,t){we.d&(t.d||1)&&(he.add(e),H(me,e)(2===t.d))})),we.d=0}function Ce(e){var t=(0,Z.useRef)();return t.current=e,t}function Ee(e,t){var n=(0,Z.useState)((function(){var r=O(t)?t():t;return[r,function t(o){o=e(r,o),Se(o,r)||(r=o,n[1]([r,t]))}]}));return n[0]}function xe(e){return Ee((function(e,t){return O(t)?t(e):t}),e)}function Ve(){return(0,Z.useReducer)((function(){return{}}))[1]}function ke(e){var t=Ee((function(e,t){return Se(t,e.current)?e:{}}),{});return t[0].current=e,t[1]}function Oe(e,t,n,r){var o=xe(r);return(0,Z.useEffect)((function(){var r=function(e){o[1](n?n.bind(this,e):{})};return e.addEventListener?ee(e,t,r):e.on(S(t,r))}),[e,t]),n?o[0]:void 0}function ze(e){var t=Ce(e);return(0,Z.useCallback)((function(){return(O(t.current)||j).apply(this,arguments)}),[])}function Pe(e,t){var n=e[t],r=ke(n);return(0,Z.useEffect)((function(){return r(e[t]),Q(e,t,r)}),[e,t]),n}function Me(e,t,r){var u=Ie((function(){var t,i,a;return{loading:!1,value:void 0,error:void 0,elementRef:function(e){t=e},on:function(e,t){return pe.add(u,e,t)},onError:function(e){return u.on("error",(function(t){return e.call(u,t.error)}))},refresh:function(f){if(r&&!f)return(a=a||s()).waitFor(m(r)),a.d||(a.d=function(e){return o(e),e}(a.then((function(){return a=null,u.refresh(!0)}))));var c=ye?new ye:{abort:j};i&&i.abort(),b(u,{loading:!0,error:void 0});var l=D(e)(c.signal),d=n(l,(function(e,t){if(i===c)if(e)b(u,{loading:!1,value:t}),pe.emit("load",u,{data:t});else if(b(u,{loading:!1,value:void 0,error:t}),!pe.emit("error",u,{error:t}))throw t}));return i=c,fe(t||oe.root,d),l},abort:function(e){i&&(i.abort(e),i=null),u.loading=!1}}}),(function(){u.abort()}));return t=[!1!==t].concat(V(t)||[]),e=ze(e),(0,Z.useEffect)((function(){t[0]&&J(u.refresh)}),t),(0,Z.useMemo)((function(){t[0]&&!r&&(u.loading=!0)}),t),Pe(u,"loading"),[u.value,u]}function Re(e){var t=F(arguments),n=(0,Z.useState)(new WeakSet)[0];return function(r){r&&K(n,r)&&(t[0]=r,e.apply(null,t))}}function Fe(){var e=(0,Z.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return b(f(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,Z.useEffect)((function(){return e}),[e]),e}function De(e){return he.has(e)}function Ie(e,t){var n=O(e)?(0,Z.useMemo)(e,[]):(0,Z.useMemo)(L.bind(0,e),[e]);return be(n,(function(){(t||n.dispose||j).call(n)})),n}function Ne(){return He.apply(this,arguments).ref}function He(){var e=(0,Z.useRef)(!1),t=(0,Z.useRef)(null),n=F(arguments),o=(0,Z.useState)((function(){return{ref:function(e){t.current=e,a(e)},emit:function(e){return i(e)||u(e)||q()},catch:function(e,t){var n;return t?n=V(e)?function(e,t){return r(t,(function(t){return(O(t)?x:k)(e,t)}))}:O(e)?x:k:t=e,pe.add(o,n?"error":"default",(function(r){if((n||L)(r.error,e))return t(r.error)}))}}}))[0],u=(0,Z.useCallback)((function(n){try{return e.current=!0,ie(n,t.current)}finally{e.current=!1}}),[]),i=(0,Z.useCallback)((function(e){return pe.emit("error",o,{error:e})||pe.emit("default",o,{error:e})}),[]),a=Re((function(t){oe.on(t,"error",(function(t){if(!e.current)return i(t.error)}))}));return(0,Z.useEffect)((function(){return f(I(n,(function(e){return e.onError(o.emit)})))}),n),o}function je(e){e=ze(e),ge.add(e),be(e,(function(t){return ge.delete(e),t&&e(!1)}))}function Te(e){var t=(0,Z.useMemo)((function(){return matchMedia(e)}),[e]);return Oe(t,"change"),t.matches}function Le(e){var t={};return Q(t,!0),h(e,(function(e,n){var r=matchMedia(n),o=v(t,e,r.matches,!0);ee(r,"change",(function(){o(r.matches)}))})),{breakpoints:Object.freeze(t),useBreakpoint:function(){var e=Ve();return(0,Z.useEffect)((function(){return Q(t,e)}),[]),t}}}ee(window,"pagehide",(function(e){f(F(ge))(e.persisted)}));var Ae=(0,Z.createContext)(null),qe=Object.freeze({get:j,set:j}),Be=Ae.Provider;function We(e){var t=(0,Z.useState)(A)[0],n=(0,Z.useContext)(Ae);return Ie(n&&e&&n.getState(t,e)||qe)}var Ke=c(),_e=Ge.prototype,Je=new se;function Ue(e,t){var n=P(e)&&-1,r=P(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function Ye(e,t,n){Ke(e).setPageCount(Math.ceil(n/(t||n||1)))}function Ge(e,t,n,r){var o=this,u={filters:b({},e),sortBy:t,sortOrder:n||t&&"asc",itemCount:null,pageIndex:0,pageSize:void 0===r?Ge.pageSize:r},i=Ke(o,{setPageCount:v(o,"pageCount",0,!0),defaults:u,items:[]}),a=function(){Je.emit("viewChange",o)},f=function(e){var t=this!==o,n=t||U(e.newValues,(function(e,t){return"pageCount"!==t&&"itemCount"!==t}));i.sorted=i.items.length?void 0:[],t&&(i.filtered=i.sorted),o.pageIndex=t||!E(e.newValues,"pageIndex")?0:o.pageIndex,n&&J(a)};e=b(o,u).filters;for(var c in i.callback=Q(e,!1),Q(o,f),Q(o.filters,f),e)v(e,c);w(e)}function $e(e,t,n,r,o){if("string"!=typeof e)return $e("__dataView",e,t,n,r);var u=We(e),i=Ve(),a=(0,Z.useState)((function(){return new Ge(t,n,r,o).reset(u.get())}))[0];return(0,Z.useEffect)((function(){return f(a.on("viewChange",(function(){u.set(a.toJSON()),i()})),u.onPopState?u.onPopState((function(e){u.set(a.toJSON()),a.reset(e)})):j)}),[a]),a}l(Ge,{pageSize:0}),p(Ge,{get hasPreviousPage(){return this.pageIndex>0},get hasNextPage(){return this.pageIndex<this.pageCount-1},on:function(e,t){return Je.add(this,e,t)},getView:function(e,t){var n=this,r=Ke(n),o=n.pageIndex||0,u=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var i=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=i,e&&(n.itemCount=i.length),[i.slice(o*u,u?(o+1)*u:void 0),i.length]},sort:function(e,t){if(e=F(e),!O(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return h(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),u=o.get(t);return r*(V(n)?U(n,(function(e,t){return Ue(e,u[t])})):Ue(n,u))}))},toggleSort:function(e,t){var n=this;n.sortBy===e?n.sortOrder="asc"===n.sortOrder?"desc":"asc":(n.sortBy=e,n.sortOrder=t||"asc")},toJSON:function(){var e=this;return b(T(e,M(Ke(e).defaults)),{filters:b({},e.filters),itemCount:e.itemCount})},reset:function(e){var t=this,n=Ke(t);return delete n.itemCount,e=e||n.defaults,n.callback((function(){b(t.filters,e.filters)})),b(t,e)}}),v(_e,"sortBy"),v(_e,"sortOrder"),v(_e,"itemCount",0,(function(e){return Ke(this).itemCount=e,Ye(this,this.pageSize,e),e||0})),v(_e,"pageSize",0,(function(e){return Ye(this,e,this.itemCount),e})),v(_e,"pageIndex",0,(function(e){return Math.max(0,P(Ke(this).itemCount)?e:Math.min(e,this.pageCount-1))})),v(_e,"filters",{},(function(e,t){return b(t||{},e)}));var Qe=new WeakMap;function Ze(e,t){var n;return t=z(e)||R(e,t),function(e){if(e){if(n&&n.ref)throw new Error("Callback can only be passed to single React element");void 0===(n=N(Qe,e,Array)).index&&(n.index=0);var r=n.index++,o=n[r]||(n[r]={keys:{}});h(t,(function(t,n){G(n),o.keys[t]=o.keys[t]||oe.on(e,t,(function(){return(o.handler[t]||j).apply(this,arguments)}))})),o.handler=t}else n.index=0;n.ref=e}}function Xe(){var e=[];return function t(n){h(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(F(r.getClassNames()));else for(var o in r){var u=r[o];(u||0===u)&&e.push(!0===u?o:o+"-"+u)}}))}(F(arguments)),e.join(" ")}function et(e){return z(e)?{dangerouslySetInnerHTML:e}:{children:e}}function tt(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=R(t,O(n)?n(e[t],e):n)),U(t,(function(n,r){return n!==e[r]&&b({},e,t)}))||e}))};return t?n.bind(0,t):n}function nt(){return f(F(arguments).map(rt))}function rt(e){return e&&!O(e)?function(t){return e.current=t}:e||j}function ot(e,t){t=t||Z.Fragment,O(t)&&(t=(0,Z.createElement)(t));var n=(0,Z.lazy)(e);return function(e){return(0,Z.createElement)(Z.Suspense,{fallback:t},(0,Z.createElement)(n,e))}}function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function it(){}function at(e){return(0,Z.useMemo)((function(){return(e||[]).map((function(e){return"object"===ut(e)?e:{label:String(e),value:e}}))}),[e])}l(it,{normalizeItems:at}),p(it,{defaultValue:"",postHook:function(e,t){var n=at(t.items),r=n.findIndex((function(t){return t.value===e.value}));return(0,Z.useEffect)((function(){r<0&&(r=t.allowUnselect||!n[0]?-1:0,e.setValue(r<0?"":n[0].value))})),b(e,{items:n,selectedIndex:r,selectedItem:n[r]})}});var ft=/^-?\d{4,}-\d{2}-\d{2}$/,ct={y:["getFullYear","setFullYear"],m:["getMonth","setMonth"],d:["getDate","setDate"]};function st(e){if("string"==typeof e){if(ft.test(e))return Date.parse(e+"T00:00");e="+"===e[0]||"-"===e[0]?function(e){var t=new Date,n="-"===e[0]?-1:1;return e.toLowerCase().replace(/([+-]?)(\d+)([dwmy])/g,(function(e,r,o,u){t[ct[u][1]](t[ct[u][0]]()+o*("-"===r?-1:"+"===r?1:n)*("w"===u?7:1))})),t}(e):Date.parse(e)}return new Date(e).setHours(0,0,0,0)}function lt(e,t,n){var r=st(e);return r<t?t:r>n?n:e}function dt(e){var t=st(e);return isNaN(t)?null:new Date(t)}function vt(e){if(!isNaN(e)){var t=6e4*new Date(e).getTimezoneOffset(),n=new Date(e-t).toISOString();return n.slice(0,n.indexOf("T",10))}return""}function pt(){}function mt(){}function ht(){}function gt(){}function yt(){}ct.w=ct.d,l(pt,{toDateString:vt,toDateObject:dt}),p(pt,{defaultValue:"",normalizeValue:function(e){return vt(st(e))},postHook:function(e,t){var n=e.setValue,r=e.value,o=st(t.min),u=st(t.max),i=(0,Z.useMemo)((function(){return r&&t.formatDisplay?t.formatDisplay(dt(r)):r}),[r]);return(0,Z.useEffect)((function(){var e=r&&lt(r,o,u);e!==r&&n(e)}),[r,o,u]),b(e,{min:vt(o),max:vt(u),displayText:i,setValue:ze((function(t){(t=O(t)?t(e.value):t)?/\d{4}/.test(t)&&/[^\s\d]/.test(t)&&(t=st(t),isNaN(t)||n(lt(t,o,u))):n("")}))})}}),p(mt,{defaultValue:w([]),normalizeValue:function(e){return V(e)||F(e)},postHook:function(e,t){var n=t.allowCustomValues||!t.items,r=it.normalizeItems(t.items),o=function(e){return!r.some((function(t){return t.value===e}))},u=ze((function(t,r){!n&&o(t)||e.setValue((function(e){var n=e.indexOf(t);return(P(r)||g(n>=0,r))&&(e=F(e),n<0?e.push(t):e.splice(n,1)),e}))}));return(0,Z.useEffect)((function(){if(!n){var t=F(e.value);Y(t,o).length&&e.setValue(t)}})),b(e,{items:r,toggleValue:u})}}),p(ht,{normalizeValue:function(e){return e=+e,isNaN(e)?void 0:e},postHook:function(e,t){var n=e.value,r=t.min,o=t.max,u=t.step,i=t.allowEmpty;return(0,Z.useEffect)((function(){var t=u>0?Math.round(n/u)*u:n;t<r||isNaN(t)&&!i?t=r||0:t>o&&(t=o),t!==n&&e.setValue(t)}),[n,r,o,u,i]),e}}),p(gt,{defaultValue:"",normalizeValue:function(e){return P(e)?"":String(e)},postHook:function(e,t){var n=e.form,r=T(t,["type","disabled","autoComplete","maxLength","inputMode","placeholder","enterKeyHint","readOnly"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,b(e,{inputProps:r})}}),p(yt,{defaultValue:!1,valueProperty:"checked",normalizeValue:function(e){return!!e},isEmpty:function(e){return!e},postHook:function(e){var t=(0,Z.useCallback)((function(){e.setValue((function(e){return!e}))}),[]);return b(e,{toggleValue:t})}});var bt=c(),St=new se,wt=new WeakMap,Ct=new WeakMap,Et=new Map,xt=new Wt({},{},{get:j}),Vt={text:gt,toggle:yt,choice:it},kt=(0,Z.createContext)(null),Ot=kt.Provider;function zt(e,t,n){this.kind=e,this.args=n,this.message=t}function Pt(e,t){var n=e.props.isEmpty||e.preset.isEmpty;return n?n(t):P(t)||""===t||V(t)&&!t.length}function Mt(e){return e.props.required&&Pt(e,e.value)}function Rt(e){return bt(e)?b(!0,V(e)?[]:{},e):e}function Ft(e){return(bt(e)||"").uniqueId}function Dt(e,t){for(var n=V(t)||t.split("."),r=e.data,o=r,u=0,i=n.length;u<i;u++){if(!E(r,n[u]))return{name:n[i-1],parent:u===i-1?r:null};o=r,r=r[n[u]]}return{exists:!0,name:n[i-1],value:r,parent:o}}function It(e,t){var n=Dt(e,t),r=Ft(n.parent);return r&&bt(e).fields[r+"."+n.name]}function Nt(e,t,n){if(t===e.data)return n;for(var r=bt(e).paths,o=[n],u=Ft(t);u=r[u];u=u.slice(0,8))o.unshift(u.slice(9));return Dt(e,o).parent===t?o.join("."):""}function Ht(){h(Et,(function(e){var t=bt(e),n=H(Et,e);for(var r in n)for(;r=r.replace(/(^|\.)[^.]+$/,"");)n[r]=!0;var o=t.ref||oe.root,u=C(t.fields,(function(e){return n[e.path]}));if(St.emit("dataChange",e,M(n)),qt(e,C(u,(function(t){return t.version&&(t.props.validateOnChange+1||e.validateOnChange+1)>1}))),e.preventLeave&&!t.unlock&&u[0]&&"script"!==oe.getEventSource(o)){var i=new Promise((function(e){t.unlock=function(){t.unlock=null,e()}}));ce(o,i,(function(){return St.emit("beforeLeave",e)||q()}))}}))}function jt(e){var t,n=jt.d||(jt.d=t=new Set);try{e()}finally{n===t&&(h(t,(function(e,t){t.onChange(t.value)})),jt.d=null)}}function Tt(e,t){var n=bt(e),r=V(t)?[]:{},o=A(),u=function(t,u){var a=Nt(e,f,t);if(a){if(u){if(u.value=r[t],!W(u.value,r[t]))return void i(t,u.value);jt.d.add(u)}for(var c=o;c=n.paths[c];c=c.slice(0,8))n.fields[c]&&jt.d.add(n.fields[c]);return e!==xt&&(N(Et,e,Object)[a]=!0,J(Ht)),!0}},i=function(t,u){return(z(u)||V(u))&&((bt(u)||"").context!==e&&(u=Tt(e,u)),n.paths[Ft(u)]=o+"."+t),r[t]=u,u},a=function(e){delete r[e]},f=new Proxy(r,{set:function(e,t,r){return"string"!=typeof t||W(e[t],r)&&t in e||jt((function(){var a=e[t];if(V(e)){if("length"===t){for(var f=a-1;f>=r;f--)u(f);return e[t]=r,!0}}else{if(bt(r)&&$("Cannot assign proxied data object"),V(r)&&V(a))return a.splice.apply(a,[0,a.length].concat(r)),!0;if(z(r)&&bt(a)){for(var c in y(a,r))delete a[c];return b(a,r),!0}}i(t,r),u(t,n.fields[o+"."+t])})),!0},deleteProperty:function(e,t){return"string"==typeof t&&t in e&&jt((function(){a(t),u(t)})),!0}});return bt(f,{context:e,uniqueId:o,set:i,delete:a}),h(t,(function(e,t){i(e,t)})),f}function Lt(e){var t={version:0,initialValue:e,value:e,error:"",preset:{},onChange:function(e){t.controlled||t.version++,t.props.onChange&&t.props.onChange(Rt(e))},setValue:function(e){e=O(e)?e(t.value):e,t.controlled?W(e,t.value)||t.onChange(e):t.value=e},setError:function(e){t.error=O(e)?e(t.error):e,(t.form||{}).isValid=null},validate:function(){return qt(t.key?t.form:null,[t])},elementRef:function(e){t.element=e}};return Q(t,!0),v(t,"value",e,(function(e,n){return(e=(t.preset.normalizeValue||L)(e,t.props))!==n&&bt(n)&&e!==t.dict[t.name]?(t.dict[t.name]=e,n):e})),v(t,"error","",(function(e){return O(e)||x(e,zt)?function(e,t){return{toString:function(){return x(t,zt)?U([e.props,e.form||"",Wt],(function(n){return(n.formatError||j).call(n,t,e.path||null,e.props,e.form)}))||t.message:t(e.props||{})}}}(t,e):e||""})),Q(t,"value",(function(e){t.version++,t.key?t.dict[t.name]=e:t.controlled||t.onChange(e)})),Q(t,"error",(function(e){t.version++,t.key&&St.emit("validationChange",t.form,{name:t.path,isValid:!e,message:String(e)})})),t}function At(e,t,n,r,o,u,i,a){var f="error"in o,c=n.key||a;b(n,{form:e,props:o,preset:r,controlled:u,dict:i,key:a}),e&&a?(n.name=a.slice(9),n.path=Nt(e,i,n.name),c!==a&&(n.locks=[],f||(n.error="")),t.fields[a]=n):n.path="",f&&(n.error=o.error),(0,Z.useEffect)((function(){return e&&a&&(t.fields[a]=n),function(){t&&t.fields[a]===n&&(delete t.fields[a],(n.props.clearWhenUnmount||n.form===xt)&&_((function(){t.fields[a]||delete i[a.slice(9)]})),t.setValid())}}),[t,n,a]),(0,Z.useEffect)((function(){t&&t.setValid()}),[t,n.error,o.disabled,o.required])}function qt(e,t){var o=function(t){var n=t.path,r=t.value,o=St.emit("validate",e,{name:n,value:r});return o||!t.props?o:(t.props.onValidate||j)(r,n,e)||Mt(t)&&new zt("required","Required")},u=t.map((function(e){var t=e.locks||(e.locks=[]),r=t[0];return r?t[1]||(t[1]=n(t[0],(function(){var u=o(e);return n(u,(function(){t[0]===r&&t.shift()})),u}))):(t[0]=q(o(e)),t[0])}));return B(u).then((function(n){t.forEach((function(e,t){e.locks[0]===u[t]&&(e.locks.shift(),e.error=n[t])}));var o=bt(e);return o&&o.setValid(),!r(n)}))}function Bt(e){bt(e).viewState.set(e.toJSON())}function Wt(e,t,n){O(e)&&(e=e());var o=this,u={},i=bt(o,{fields:u,viewState:n,paths:{},initialData:e,setValid:v(this,"isValid",!0,(function(){return!r(u,(function(e){return!e.props.disabled&&(e.error||Mt(e))}))}))});b(o,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),b({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),o.ref=function(e){i.ref=e,e&&Ct.set(e,o)},o.isValid=!0,o.data=Tt(o,n.get()||i.initialData)}function Kt(e,t,n){if("string"!=typeof e)return Kt("",e,t);var r=We(e),o=(0,Z.useState)((function(){return new Wt(t,n,r)}))[0],u=Ve();return Pe(o,"isValid"),je((function(){(bt(o).unlock||j)(),o.autoPersist&&Bt(o)})),(0,Z.useEffect)((function(){return H(Et,o)&&u(),o.on({dataChange:u,reset:u})}),[o]),o}function _t(e,t,n,r){"string"==typeof e&&(e=Vt[e]),O(e)||(r=n,n=t,t=e,e="");var o=e?N(wt,e,e):{};r=r||o.valueProperty||"value";var u=(0,Z.useContext)(kt),i=u&&bt(u).context,a=i&&bt(i),f=t.name||"",c=i&&f&&Ft(u)+"."+f,s=r in t,l=(0,Z.useState)((function(){return Lt(s?t[r]:(o.normalizeValue||L)(void 0!==n?n:o.defaultValue))}))[0];At(i,a,l,o,t,s,u,c),s&&(l.value=t[r]),i&&c&&(f in u?s||(l.value=u[f]):(Pt(l,l.initialValue)?l.value=bt(u).set(f,l.initialValue):u[f]=l.initialValue,l.version=0));var d=(o.postHook||L)({form:i,key:c,path:l.path,value:l.value,error:String(l.error),setValue:l.setValue,setError:l.setError,validate:l.validate,elementRef:l.elementRef},t);return d.value=l.value,d.error=String(l.error),Pe(l,"version"),d}function Jt(){var e=C(F(arguments),O);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),q())}}function Ut(e,t){O(t)&&(t={postHook:t}),Vt[e]=function(){return t}}jt.d=null,l(Wt,{ERROR_FIELD:1,EMPTY_FIELD:2,get:function(e){return U(ne(e),Ct.get.bind(Ct))||null}}),p(Wt,{element:function(e){return e?(It(this,e)||"").element:bt(this).ref},focus:function(e){var t;return!!(t="number"==typeof e?I(bt(this).fields,(function(t){return t.error&&1&e||Pt(t,t.value)&&2&e?t.element:null})).sort(te)[0]:this.element(e))&&ue(t)},on:function(e,t){return St.add(this,e,t)},persist:function(){Bt(this),this.autoPersist=!1},restore:function(){var e=bt(this).viewState.get();return e&&this.reset(e),!!e},clear:function(){this.reset({})},reset:function(e){var t=this,n=bt(t),r=bt(t.data);for(var o in t.data)r.delete(o);h(e||n.initialData,(function(e,t){r.set(e,t)})),h(n.fields,(function(e,n){var r=Dt(t,n.path);n.controlled?n.onChange(r.exists?r.value:n.initialValue):r.exists&&(n.value=r.value),n.error=null})),n.setValid(),(n.unlock||j)(),St.emit("reset",t)},getValue:function(e){return Rt(Dt(this,e).value)},setValue:function(e,t){var n=Dt(this,e);n.parent&&(n.parent[n.name]=Rt(t))},getErrors:function(){var e=C(bt(this).fields,(function(e){return e.error}));return e[0]?e.reduce((function(e,t){return e[t.path]=String(t.error),e}),{}):null},getError:function(e){return String((It(this,e)||"").error||"")},setError:function(e,t){(It(this,e)||{}).error=t},validate:function(){var e=this,t=bt(e).fields,n=F(arguments);return n.length?qt(e,C(t,(function(e){return r(n,(function(t){var n=t.length;return e.path.slice(0,n)===t&&(!e.path[n]||"."===e.path[n])}))}))):qt(e,C(t,(function(e){return!e.props.disabled})))},toJSON:function(){return b(!0,{},this.data)}}),v(Wt.prototype,"preventLeave",!1,(function(e){return e||(bt(this).unlock||j)(),!!e}));var Yt=(0,Z.forwardRef)((function(e,t){var n=e.context;return b(n,T(e,["enterKeyHint","preventLeave","formatError"])),(0,Z.createElement)(Ot,{value:n.data},(0,Z.createElement)("form",b(y(e,["context","enterKeyHint","preventLeave","formatError"]),{ref:nt(t,n.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||j).call(this,t)},onReset:function(t){t.preventDefault(),n.reset(),(e.onReset||j).call(this,t)}})))}));function Gt(e){return(0,Z.createElement)(Ot,{value:e.value.data},e.children)}function $t(e){return Qt(b({},e,{defaultValue:[]}))}function Qt(e){var t=(0,Z.useState)(A)[0],n=e.name,r=(0,Z.useContext)(kt);r||(r=xt.data,n=t);var o=(0,Z.useRef)(),u=bt(r).context,i=bt(u),a=e.value;n?(a="value"in e?a:z(r[n])||V(r[n])||e.defaultValue||{},a=bt(r).set(n,a)):(bt(a)||"").context||$("Value must be a data object or array");var f=i.paths[Ft(a)];if("boolean"!=typeof(i.fields[f]||"").controlled){var c=o.current||(o.current=Lt(a));At(u,i,c,{},e,0,r,f),c.value=a}else(0,Z.useEffect)(j,[null]),(0,Z.useEffect)(j,[null]);var s=e.children;return O(s)&&(s=s(a)),(0,Z.createElement)(Ot,{value:a},s)}function Zt(e){return _t(e,e.value),null}l(Qt,{keyFor:Ft}),d(window,"zeta-dom-react",(function(){return console.warn('window["zeta-dom-react"] is deprecated, access zeta.react instead.'),zeta.react}))})(),i})()));
//# sourceMappingURL=zeta-dom-react.min.js.map