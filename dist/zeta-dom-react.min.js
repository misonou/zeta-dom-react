!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{i.d(o,{default:()=>oe});var e={};i.r(e),i.d(e,{DataView:()=>F,FormContext:()=>X,FormContextProvider:()=>K,classNames:()=>te,combineRef:()=>re,combineValidators:()=>ee,partial:()=>ne,toRefCallback:()=>ie,useAsync:()=>H,useDataView:()=>k,useDispose:()=>_,useErrorHandlerRef:()=>U,useFormContext:()=>Y,useFormField:()=>$,useMemoizedFunction:()=>B,useObservableProperty:()=>G,useRefInitCallback:()=>L});var t=i(359),n=i(654),r=n.util,a=r.noop,u=(r.either,r.is,r.isUndefinedOrNull,r.isArray),s=r.isFunction,c=(r.isThenable,r.isPlainObject,r.isArrayLike,r.makeArray),f=r.extend,d=r.each,l=r.map,v=r.grep,p=(r.splice,r.any),m=(r.single,r.kv),h=(r.pick,r.exclude,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),g=(r.equal,r.combineFn),y=(r.executeOnce,r.createPrivateStore),b=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.keys),S=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define),C=r.definePrototype,O=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),x=r.watch,w=(r.watchOnce,r.watchable,r.inherit,r.deepFreeze,r.iequal,r.randomId,r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),P=(r.reject,r.always),E=r.resolveAll,z=r.catchAsync,V=(r.setPromiseTimeout,y()),I=F.prototype;function F(e,t,n,r){for(var i in V(this,{}),e=f({},e))O(e,i);f(this,{filters:Object.freeze(e),sortBy:t,sortOrder:n,pageSize:r||F.pageSize})}function k(e,n,r,i){var o=(0,t.useState)(!1)[1];return(0,t.useState)((function(){var t=new F(e,n,r,i),a=V(t),u=function(){a.filteredItems=a.items.length?void 0:[],o((function(e){return!e}))};return x(t,u),x(t.filters,u),t}))[0]}S(F,{pageSize:0}),C(F,{pageIndex:0,pageSize:0,itemCount:0,getView:function(e,t){var n=this,r=V(n),i=n.pageIndex||0,o=n.pageSize||0;(e=e||[])!==r.items&&(r.items=e,r.filteredItems=e.length?void 0:[]);var a=r.filteredItems||(r.filteredItems=(t(r.items,n.filters,n.sortBy)||[])["desc"===n.sortOrder?"reverse":"slice"]());return n.itemCount=a.length,[a.slice(i*o,o?(i+1)*o:void 0),a.length]}}),O(I,"sortBy"),O(I,"sortOrder"),O(I,"pageIndex"),O(I,"pageSize");var j=n.EventContainer;const R=n.dom;var A=n.dom,q=(A.textInputAllowed,A.beginDrag,A.beginPinchZoom,A.getShortcut,A.setShortcut,A.focusable,A.focused,A.setModal,A.releaseModal,A.retainFocus,A.releaseFocus,A.iterateFocusPath,A.focus);const D=R;var M=n.dom,T=M.lock,N=(M.locked,M.cancelLock,new WeakMap),W=new j;function B(e){var n=(0,t.useState)((function(){return function e(){var t=N.get(e);return t&&t.apply(this,arguments)}}))[0];return N.set(n,e),n}function G(e,n){var r=(0,t.useState)(e[n]),i=r[0],o=r[1];return(0,t.useEffect)((function(){return o(e[n]),x(e,n,(function(e){o((function(){return e}))}))}),[e,n]),i}function H(e,n){var r=(0,t.useState)((function(){var t;return{loading:!0,elementRef:function(e){t=e},onError:function(e){return W.add(r,"error",(function(t){return e.call(r,t.error)}))},refresh:function(){var n;n=P(w().then(e),(function(e,t){if(!r.disposed&&r.promise===n)if(e)f(r,{loading:!1,value:t});else if(f(r,{loading:!1,value:void 0,error:t}),i=t,!W.emit("error",r,{error:i},!0))throw t;var i})),f(r,{promise:n,loading:!0,error:void 0}),t&&z(T(t,n))}}}))[0],i=u(n);return e=B(e),n=!1!==n,G(r,"loading"),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n&&r.refresh()}),[r,n].concat(i)),[r.value,r]}function L(e){var n=c(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&h(r,t)&&(n[0]=t,e.apply(null,n))}}function _(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return f(g(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function U(){var e=(0,t.useRef)(null),n=c(arguments);return(0,t.useEffect)((function(){return g(l(n,(function(t){return t.onError((function(t){if(e.current)return D.emit("error",e.current,{error:t},!0)}))})))}),[e].concat(n)),e}var Z=y(),J=(0,t.createContext)(null),K=J.Provider;function Q(e,t,n){return{toString:function(){return n(f({},e.fields[t]))}}}function X(e,t){var n=this,r={},i={},o=new j;Z(n,{fields:r,errors:i,eventContainer:o,refs:{},initialData:e||{},setValid:O(this,"isValid",!0,(function(){return!p(r,(function(e,t){return!e.disabled&&(i[t]||e.required&&(e.isEmpty?e.isEmpty(n.data[t]):!n.data[t]))}))}))});n.isValid=!0,n.validateOnChange=!1!==t,n.data=function(e,t,n){return new Proxy(f({},n),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(n,r,i){return"string"==typeof r&&n[r]!==i&&(r in n&&t.emitAsync("dataChange",e,[r],{},(function(e,t){return e.concat(t)})),n[r]=i),!0}})}(n,o,e),n.on("dataChange",(function(e){if(n.validateOnChange){var t=v(e.data,(function(e){return!1!==r[e].validateOnChange}));t[0]&&n.validate.apply(n,t)}}))}function Y(e,n){var r=(0,t.useState)((function(){return new X(e,n)}))[0],i=(0,t.useState)(0)[1];return G(r,"isValid"),(0,t.useEffect)((function(){return r.on("dataChange",(function(){i((function(e){return++e}))}))}),[r]),r}function $(e,n,r){var i=(0,t.useContext)(J),o=(0,t.useRef)(),a=e.name||"",u=(0,t.useState)((function(){return i&&i.data[a]||n}))[0],s=(0,t.useState)(u),c=(0,t.useState)(""),d=B(e.onValidate),l=s[0],v=s[1],p=c[0],m=c[1],h=B((function(t){e.onChange?e.onChange("function"==typeof t?t(e[r]):t):console.warn("onChange not supplied")}));return(r=r||"value")in e||(h=v,(e=f({},e))[r]=l),i&&a&&(Z(i).fields[a]=e),(0,t.useEffect)((function(){if(i&&a){var e=Z(i);return e.refs[a]=o,a in i.data&&v(i.data[a]),g((function(){delete e.fields[a],delete e.refs[a],e.setValid()}),i.on("dataChange",(function(e){e.data.includes(a)&&v(i.data[a])})),i.on("validationChange",(function(t){t.name===a&&m(e.errors[a])})),i.on("validate",(function(e){if(e.name===a)return d(e.value,e.name,i)})),i.on("reset",(function(){v(u),m("")})))}}),[i,a,u,d]),(0,t.useEffect)((function(){i&&a&&(i.data[a]=l)}),[i,a,l]),(0,t.useEffect)((function(){i&&a&&Z(i).setValid()}),[i,a,e.validateOnChange,e.disabled,e.required]),{value:e[r],error:String(e.error||p||""),setValue:h,setError:m,elementRef:function(e){o.current=e}}}function ee(){var e=v(c(arguments),s);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),w())}}function te(){var e=[];return function t(n){d(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(c(r.getClassNames()));else for(var i in r){var o=r[i];o&&e.push(!0===o?i:i+"-"+o)}}))}(c(arguments)),e.join(" ")}function ne(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=m(t,s(n)?n(e[t],e):n)),f({},e,t)}))};return t?n.bind(0,t):n}function re(){return g(c(arguments).map(ie))}function ie(e){return e&&!s(e)?function(t){return e.current=t}:e||a}C(X,{element:function(e){var t=Z(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&q(t)},on:function(e,t){return Z(this).eventContainer.add(this,e,t)},reset:function(){var e=this,t=Z(e);for(var n in e.data)delete e.data[n];f(e.data,t.initialData),e.isValid=!0,t.eventContainer.emit("reset",e)},validate:function(){var e=this,t=Z(e),n=t.errors,r=t.eventContainer,i=c(arguments);i.length||(i=b(t.fields));var o=f({},n),a=E(i.map((function(t){return r.emit("validate",e,{name:t,value:e.data[t]})})));return a.then((function(a){return i.forEach((function(i,u){s(a[u])&&(a[u]=Q(t,i,a[u])),n[i]=a[u],(a[u]||"")!==(o[i]||"")&&r.emit("validationChange",e,{name:i,isValid:!a[u],message:String(a[u]||"")})})),t.setValid(),!p(a,(function(e){return e}))}))}});const oe=e})(),o=o.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map