/*! zeta-dom-react v0.6.0 | (c) misonou | https://misonou.github.io */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("zeta-dom"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["zeta-dom","react","react-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("zeta-dom"),require("react"),require("react-dom")):(e.zeta=e.zeta||{},e.zeta.react=t(e.zeta,e.React,e.ReactDOM))}(self,((e,t,n)=>(()=>{"use strict";var r={12:e=>{e.exports=t},33:e=>{e.exports=n},231:t=>{t.exports=e}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{i.r(u),i.d(u,{ChoiceField:()=>Ft,DataView:()=>bt,DateField:()=>Kt,Form:()=>On,FormArray:()=>Pn,FormContext:()=>Cn,FormContextProvider:()=>Dn,FormObject:()=>Mn,HiddenField:()=>zn,MultiChoiceField:()=>_t,NumericField:()=>Jt,TextField:()=>Ut,ToggleField:()=>Yt,ValidationError:()=>on,ViewStateProvider:()=>dt,classNames:()=>xt,combineRef:()=>Dt,combineValidators:()=>xn,createAsyncScope:()=>Be,createBreakpointContext:()=>st,createDependency:()=>at,createErrorHandler:()=>ot,domEventRef:()=>kt,innerTextOrHTML:()=>Et,isSingletonDisposed:()=>tt,partial:()=>Ot,registerFieldType:()=>En,toRefCallback:()=>Pt,useAsync:()=>Ze,useAutoSetRef:()=>Ke,useDataView:()=>wt,useDependency:()=>ct,useDispose:()=>et,useEagerReducer:()=>_e,useEagerState:()=>Je,useErrorHandler:()=>it,useErrorHandlerRef:()=>rt,useEventTrigger:()=>Ge,useFormContext:()=>Vn,useFormField:()=>kn,useMediaQuery:()=>ft,useMemoizedFunction:()=>$e,useObservableProperty:()=>Qe,useRefInitCallback:()=>Xe,useSingleton:()=>nt,useUnloadEffect:()=>ut,useUpdateTrigger:()=>Ue,useValueTrigger:()=>Ye,useViewState:()=>vt,withSuspense:()=>Mt});var e=i(231),t=e.util,n=t.always,r=t.any,o=t.arrRemove,a=t.catchAsync,c=t.clearImmediateOnce,f=t.combineFn,s=t.createPrivateStore,l=t.define,d=t.defineGetterProperty,v=t.defineObservableProperty,p=t.defineOwnProperty,m=t.definePrototype,h=t.delay,g=t.each,y=t.either,b=t.equal,w=t.errorWithCode,S=t.exclude,C=t.extend,V=t.fill,k=t.freeze,x=t.grep,E=t.hasOwnProperty,O=t.is,D=t.isArray,P=t.isErrorWithCode,M=t.isFunction,z=t.isPlainObject,F=t.isUndefinedOrNull,R=t.keys,N=t.kv,I=t.makeArray,H=t.makeAsync,j=t.map,A=t.mapGet,L=t.mapRemove,T=t.noop,q=t.pick,W=t.pipe,B=t.randomId,K=t.resolve,_=t.resolveAll,J=t.sameValue,U=t.sameValueZero,Y=t.setAdd,G=t.setImmediate,$=t.setImmediateOnce,Q=t.single,Z=t.splice,X=t.throwNotFunction,ee=t.throws,te=t.watch,ne=i(12),re=ne.Fragment,oe=ne.StrictMode,ie=ne.Suspense,ue=ne.createContext,ae=ne.createElement,ce=ne.forwardRef,fe=ne.lazy,se=ne.useCallback,le=ne.useContext,de=ne.useEffect,ve=ne.useMemo,pe=ne.useReducer,me=ne.useRef,he=ne.useState,ge=e.util,ye=ge.bind,be=ge.comparePosition,we=ge.parentsAndSelf,Se=e.dom;const Ce=Se;var Ve=Se.focus,ke=Se.reportError,xe=e.dom,Ee=xe.notifyAsync,Oe=xe.preventLeave,De=e.EventContainer,Pe=e.ErrorCode.cancelled,Me=i(33),ze=!0;Me.flushSync((function(){function e(){return ze=!ze,null}var t=document.createElement("div"),n=ae(oe,null,ae(e));Me.createRoot?Me.createRoot(t).render(n):Me.render(n,t)}));var Fe=ze,Re=s(),Ne=new De,Ie=new Map,He=new WeakSet,je=new Set,Ae=ue(null),Le=window.AbortController,Te=Fe?function(e,t,n){var r=ve((function(){var n=e();return Ie.has(n)||(Ie.set(n,t),qe.d=0,c(qe)),n}),n);return de((function(){var e=function(e){Ie.get(r).d=e?4:2,qe.d|=e?1:2,$(qe)};return e(!0),e}),[r]),r}:function(e,t,n){var r=ve(e,n);return de((function(){return function(){He.add(r),t.call(r,r,!0)}}),[r]),r};function qe(){g(Ie,(function(e,t){qe.d&(t.d||1)&&(He.add(e),L(Ie,e).call(e,e,2===t.d))})),qe.d=0}function We(e,t,n){return function(r){r&&Y(e,r)&&(n[0]=r,t.apply(null,n))}}function Be(e){return{errorHandler:ot(e),Provider:function(t){return ae(Ae.Provider,{value:e},t.children)}}}function Ke(e){var t=me();return t.current=e,t}function _e(e,t){var n=he((function(){var r=M(t)?t():t;return[r,function t(o){o=e(r,o),J(o,r)||(r=o,n[1]([r,t]))}]}));return n[0]}function Je(e){return _e((function(e,t){return M(t)?t(e):t}),e)}function Ue(){return pe((function(){return{}}))[1]}function Ye(e,t){var n=_e((function(e,n){var r=e.current;return J(r,n)||t&&t(r,n)?e:{current:n}}),{});return n[0].current=e,n[1]}function Ge(e,t,n,r){var o=Je(r);return de((function(){var r=function(e){o[1](n?n.bind(this,e):{})};return e.addEventListener?ye(e,t,r):e.on(V(t,r))}),[e,t]),n?o[0]:void 0}function $e(e){var t=Ke(e);return se((function(){return(M(t.current)||T).apply(this,arguments)}),[])}function Qe(e,t,n){var r=e[t],o=Ye(r,n);return de((function(){return o(e[t]),te(e,t,o)}),[e,t]),r}function Ze(e,t,r){var o=le(Ae),i=nt((function(){var t,c,f,s=0,l=function(e,t,n,r){c&&(c.abort(r),c=null),f=null,C(i,{loading:e,value:t,error:n}),u([e,t,n])},d=function(){var r=Le?new Le:{abort:T},u=H(e)(r.signal),a=n(u,(function(e,t){if(c===r)if(c=null,e)l(!1,t),Ne.emit("load",i,{data:t});else if(l(!1,void 0,t),!Ne.emit("error",i,{error:t}))throw t}));return l(!0,i.value),s=Date.now(),c=r,Ee(t||o||Ce.root,a),u};return{loading:!1,value:void 0,error:void 0,elementRef:function(e){t=e},on:function(e,t){return Ne.add(i,e,t)},onError:function(e){return i.on("error",(function(t){return e.call(i,t.error)}))},refresh:function(){return f||(e=new Promise((function(e,t){var n=c||{abort:T};c={abort:function(e){n.abort(e),t(e||w(Pe))}},(Date.now()-s<r?h(r):Promise.resolve()).then(e)})).then(d),a(e),f=e);var e},abort:function(e){l(!1,i.value,i.error,e)},reset:function(){l(!1),s=0}}}),[],(function(){i.abort()}));t=[!1!==t].concat(D(t)||[]),e=$e(e),de((function(){t[0]&&i.refresh()}),t),ve((function(){t[0]&&!r&&(i.loading=!0)}),t);var u=Ye([i.loading,i.value,i.error],b);return[i.value,i]}function Xe(){var e=I(arguments);return We(he(new WeakSet)[0],e[0],e)}function et(){var e=he((function(){var e=[function(){e.splice(0,e.length-1)}];return C(f(e),{push:e.splice.bind(e,-1,0)})}))[0];return de((function(){return e}),[e]),e}function tt(e){return He.has(e)}function nt(e,t,n){return M(t)&&(n=t,t=[]),n=n||function(e){(e.dispose||T).call(e)},M(e)?Te(e,n,t||[]):Te(W.bind(0,e),n,[e])}function rt(){return it.apply(this,arguments).ref}function ot(e){var t,n=function(e,t){var n={error:e,sourceElement:t?t.target:null};return Ne.emit("error",i,n,{source:t})||Ne.emit("default",i,n,{source:t})},o=function(r){return e=r,Ce.on(r,"error",(function(e){return t?void 0:n(e.error,e)}))},i={emit:function(r){return n(r)||function(n){try{return t=!0,ke(n,e)}finally{t=!1}}(r)||K()},catch:function(e,t){var n=W;return t?n=D(e)?function(e,t){return r(t,(function(t){return(M(t)?O:P)(e,t)}))}:M(e)?O:P:t=e,Ne.add(i,n===W?"default":"error",(function(r){if(n(r.error,e))return t(r.error,q(r,["source","sourceKeyName","sourceElement"]))}))}};return e?o(e):i.ref=We(new WeakSet,o,[]),i}function it(){var e=I(arguments),t=he(ot)[0];return de((function(){return f(j(e,(function(e){return e.onError(t.emit)})))}),e),t}function ut(e){e=$e(e),je.add(e),Te(W.bind(0,e),(function(t,n){return je.delete(e),n&&e(!1)}),[])}function at(e){var t=k({}),n=k({}),o={Provider:t,Consumer:n},i=Re(o,C([],o,{current:e,update:function(){var t=r(i,(function(e){return!F(e.value)}));i.current=t?t.value:e}}));return Re(t,i),Re(n,i),k(o)}function ct(e,t,n){var r=Re(e);if(e===r.Provider){var i=nt((function(){var e={};return r.push(e)&&e}),[r],(function(){o(r,i),r.update()}));return ve((function(){p(i,"value",M(t)?t():t,!0),r.update()}),[i].concat(n||[t])),i}return Qe(r,"current")}function ft(e){var t=ve((function(){return matchMedia(e)}),[e]);return Ge(t,"change"),t.matches}function st(e){var t={},n=te(t,!0),r=f(j(e,(function(e,o){var i=matchMedia(e),u=v(t,o,i.matches,!0);return ye(i,"change",(function(){i.matches!==t[o]&&n(r)})),function(){return u(i.matches)}})));return{breakpoints:Object.freeze(t),useBreakpoint:function(){var e=I(arguments),n=Ue();return de((function(){return te(t,(function(t){e.length&&!Q(e,E.bind(0,t.newValues))||n()}))}),e),t}}}ye(window,"pagehide",(function(e){f(I(je))(e.persisted)}));var lt=ue(null),dt=lt.Provider;function vt(e){var t=he(B)[0],n=le(lt);return nt((function(){return n&&e&&n.getState(t,e)||{get:T,set:T}}),[n,e,t])}var pt=s(),mt=bt.prototype,ht=new De;function gt(e,t){var n=F(e)&&-1,r=F(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function yt(e,t,n){pt(e).setPageCount(Math.ceil(n/(t||n||1)))}function bt(e,t,n,r){var o=this,i={filters:C({},e),sortBy:t,sortOrder:n||t&&"asc",itemCount:null,pageIndex:0,pageSize:void 0===r?bt.pageSize:r},u=pt(o,{setPageCount:v(o,"pageCount",0,!0),defaults:i,items:[]}),a=function(){ht.emit("viewChange",o)},c=function(e){var t=this!==o,n=t||Q(e.newValues,(function(e,t){return"pageCount"!==t&&"itemCount"!==t}));u.sorted=u.items.length?void 0:[],t&&(u.filtered=u.sorted),o.pageIndex=t||!E(e.newValues,"pageIndex")?0:o.pageIndex,n&&$(a)};e=C(o,i).filters;for(var f in te(o,c),te(e,c),e)v(e,f);k(e)}function wt(e,t,n,r,o){if("string"!=typeof e)return wt("__dataView",e,t,n,r);var i=vt(e),u=Ue(),a=he((function(){return new bt(t,n,r,o).reset(i.get())}))[0];return de((function(){return f(a.on("viewChange",(function(){i.set(a.toJSON()),u()})),i.onPopState?i.onPopState((function(e){i.set(a.toJSON()),a.reset(e)})):T)}),[a]),a}l(bt,{pageSize:0}),m(bt,{get hasPreviousPage(){return this.pageIndex>0},get hasNextPage(){return this.pageIndex<this.pageCount-1},on:function(e,t){return ht.add(this,e,t)},getView:function(e,t){var n=this,r=pt(n),o=n.pageIndex||0,i=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var u=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=u,e&&(n.itemCount=u.length),[u.slice(o*i,i?(o+1)*i:void 0),u.length]},sort:function(e,t){if(e=I(e),!M(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return g(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),i=o.get(t);return r*(D(n)?Q(n,(function(e,t){return gt(e,i[t])})):gt(n,i))}))},toggleSort:function(e,t){var n=this;n.sortBy===e?n.sortOrder="asc"===n.sortOrder?"desc":"asc":(n.sortBy=e,n.sortOrder=t||"asc")},toJSON:function(){var e=this;return C(q(e,R(pt(e).defaults)),{filters:C({},e.filters),itemCount:e.itemCount})},reset:function(e){var t=pt(this);return delete t.itemCount,C(this,e||t.defaults)}}),v(mt,"sortBy"),v(mt,"sortOrder"),v(mt,"itemCount",0,(function(e){return pt(this).itemCount=e,yt(this,this.pageSize,e),e||0})),v(mt,"pageSize",0,(function(e){return yt(this,e,this.itemCount),e})),v(mt,"pageIndex",0,(function(e){return Math.max(0,F(pt(this).itemCount)?e:Math.min(e,this.pageCount-1))})),v(mt,"filters",{},(function(e,t){return C(t||{},e)}));var St=new WeakMap,Ct=new WeakMap;function Vt(e,t,n){e((function(e){return"string"==typeof t&&(t=N(t,M(n)?n(e[t],e):n)),Q(t,(function(n,r){return!J(n,e[r])&&C({},e,t)}))||e}))}function kt(e,t){var n;return t=z(e)||N(e,t),function(e){if(e){if(n&&n.ref)throw new Error("Callback can only be passed to single React element");void 0===(n=A(St,e,Array)).index&&(n.index=0);var r=n.index++,o=n[r]||(n[r]={keys:{}});g(t,(function(t,n){X(n),o.keys[t]=o.keys[t]||Ce.on(e,t,(function(){return(o.handler[t]||T).apply(this,arguments)}))})),o.handler=t}else n.index=0;n.ref=e}}function xt(){var e=[];return function t(n){g(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(I(r.getClassNames()));else for(var o in r){var i=r[o];(i||0===i)&&e.push(!0===i?o:o+"-"+i)}}))}(I(arguments)),e.join(" ")}function Et(e){return z(e)?{dangerouslySetInnerHTML:e}:{children:e}}function Ot(e,t){var n=A(Ct,e,Map);return A(n,t,(function(){return void 0!==t?Vt.bind(0,e,t):Vt.bind(0,e)}))}function Dt(){return f(I(arguments).map(Pt))}function Pt(e){return e&&!M(e)?function(t){return e.current=t}:e||T}function Mt(e,t){M(t=t||re)&&(t=ae(t));var n=fe(e);return function(e){return ae(ie,{fallback:t},ae(n,e))}}function zt(e){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zt(e)}function Ft(){}function Rt(e){return(e||[]).map((function(e){return"object"===zt(e)?e:{label:String(e),value:e}}))}l(Ft,{normalizeItems:Rt}),m(Ft,{defaultValue:"",postHook:function(e,t,n){var r=!t.items,o=n.memo((function(){return Rt(t.items)}),[t.items]),i=t.allowUnselect||!o[0],u=o.findIndex((function(t){return t.value===e.value}));return n.memo((function(){!r&&u<0&&e.setValue(i?"":o[0].value)}),[e.version,u,i,r]),C(e,{items:o,selectedIndex:u,selectedItem:o[u]})}});var Nt=/^(\d{4}|[+-]\d{6})-\d{2}-\d{2}$/,It={y:function(e,t){At(e,e.getDate(),e.setFullYear(e.getFullYear()+t))},m:function(e,t){At(e,e.getDate(),e.setMonth(e.getMonth()+t))},d:function(e,t){e.setDate(e.getDate()+t)},w:function(e,t){It.d(e,7*t)}},Ht={ys:function(e){e.setMonth(0,1)},ye:function(e){e.setMonth(11,31)},ms:function(e){e.setDate(1)},me:function(e){e.setMonth(e.getMonth()+1,0)},nb:function(e,t,n,r){It.d(e,-((7-t+e.getDay())%7||r||0)-7*(n-1))},na:function(e,t,n,r){It.d(e,+((7+t-e.getDay())%7||r||0)+7*(n-1))}},jt={"year-start":Ht.ys,"year-end":Ht.ye,"month-start":Ht.ms,"month-end":Ht.me,"week-start":function(e){It.d(e,-e.getDay())},"week-end":function(e){It.d(e,6-e.getDay())},"nth-after":function(e,t,n){Ht.na(e,n,t,7)},"nth-before":function(e,t,n){Ht.nb(e,n,t,7)},"nth-of-year":function(e,t,n){Ht.ys(e),Ht.na(e,n,t)},"nth-of-month":function(e,t,n){Ht.ms(e),Ht.na(e,n,t)},"nth-last-of-year":function(e,t,n){Ht.ye(e),Ht.nb(e,n,t)},"nth-last-of-month":function(e,t,n){Ht.me(e),Ht.nb(e,n,t)}};function At(e,t,n){t>28&&e.getDate()!==t&&e.setDate(0)}function Lt(e,t){for(var n,r=/([+-]?)(\d+)([dwmy])/g,o="-"===e[0]?-1:1,i=0;(n=r.exec(e))&&n.index===i;)i+=n[0].length,It[n[3]](t,n[2]*("-"===n[1]?-1:"+"===n[1]?1:o));return i!==e.length?void 0:t}function Tt(e,t){if("string"==typeof e){if(!e)return NaN;if(Nt.test(e))return Date.parse(e+"T00:00");!1!==t&&(e=function(e,t){if(e.length<8||/^[0-9+-]/.test(e))return Lt(e,t);var n=e.indexOf("("),r=n<0?e:e.slice(0,n);if(E(jt,r)){var o,i,u=0;return n>0&&(o=e.slice(n+1,e.lastIndexOf(")"))),o&&"n"===r[0]&&(i=+(o=o.split(/\s*,\s*/))[0],u={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6}[o[1]],o=o[2]),o&&(t=Lt(o,t)),t&&void 0!==u?(jt[r](t,i,u),t):void 0}}(e.toLowerCase(),t||new Date)||e)}return new Date(e).setHours(0,0,0,0)}function qt(e,t,n){var r=Tt(e,!1);return r<t?t:r>n?n:e}function Wt(e){var t=Tt(e,!1);return isNaN(t)?null:new Date(t)}function Bt(e){function t(e,t){return(e=String(e)).length>=t?e:("00000"+e).slice(-t)}if(e=new Date(e),!isNaN(e)){var n=e.getFullYear();return(n<0?"-"+t(Math.abs(n),6):n>9999?"+"+t(n,6):t(n,4))+"-"+t(e.getMonth()+1,2)+"-"+t(e.getDate(),2)}return""}function Kt(){}function _t(){}function Jt(){}function Ut(){}function Yt(){}l(Kt,{toDateString:Bt,toDateObject:Wt,getDate:function(e,t){return t=void 0!==t?Tt(t,!1):Date.now(),isNaN(t)?"":Bt(Tt(e,new Date(t)))}}),m(Kt,{defaultValue:"",normalizeValue:function(e){return Bt(Tt(e,!1))},postHook:function(e,t,n){var r=e.setValue,o=e.value,i=n.memo(Tt,[t.min]),u=n.memo(Tt,[t.max]),a=t.formatDisplay,c=n.memo((function(){return o&&a?a(Wt(o)):o}),[o,a]);return n.memo((function(){var e=o&&qt(o,i,u);e!==o&&r(e)}),[o,i,u]),C(e,{min:Bt(i),max:Bt(u),displayText:c,setValue:n.callback((function(e){(e=M(e)?e(o):e)?/\d{4}/.test(e)&&/[^\s\d]/.test(e)&&(e=Tt(e),isNaN(e)||r(qt(e,i,u))):r("")}))})}}),m(_t,{defaultValue:k([]),normalizeValue:function(e){return D(e)||I(e)},postHook:function(e,t,n){var r=t.allowCustomValues||!t.items,o=n.memo((function(){return Ft.normalizeItems(t.items)}),[t.items]),i=function(e){return!o.some((function(t){return t.value===e}))},u=n.callback((function(t,n){e.setValue((function(e){var o=I(e);return x(I(t),(function(e){var t=o.indexOf(e);if(F(n)||y(t>=0,n)){if(t>=0)return o.splice(t,1);if(r||!i(e))return o.push(e)}})).length?o:e}))})),a=n.memo((function(){return I(e.value)}),[e.version]);return n.memo((function(){if(!r){var t=I(a);Z(t,i).length&&e.setValue(t)}}),[a,o,r]),C(e,{value:a,items:o,toggleValue:u})}}),m(Jt,{normalizeValue:function(e){return e=+e,isNaN(e)?void 0:e},postHook:function(e,t,n){var r=e.value,o=t.min,i=t.max,u=t.step,a=t.allowEmpty;return n.memo((function(){var t=u>0?Math.round(r/u)*u:r;t<o||isNaN(t)&&!a?t=o||0:t>i&&(t=i),t!==r&&e.setValue(t)}),[r,o,i,u,a]),e}}),m(Ut,{defaultValue:"",normalizeValue:function(e){return F(e)?"":String(e)},postHook:function(e,t){var n=e.form,r=q(t,["type","disabled","autoComplete","maxLength","inputMode","placeholder","enterKeyHint","readOnly"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,C(e,{inputProps:r})}}),m(Yt,{defaultValue:!1,valueProperty:"checked",normalizeValue:function(e){return!!e},isEmpty:function(e){return!e},postHook:function(e,t,n){return C(e,{toggleValue:n.callback((function(){e.setValue((function(e){return!e}))}))})}});var Gt=s(),$t=new De,Qt=new WeakMap,Zt=new Map,Xt=new Set,en=new Cn({},{},{get:T}),tn={text:Ut,toggle:Yt,choice:Ft},nn=ue(null),rn=nn.Provider;function on(e,t,n){this.kind=e,this.args=n,this.message=t}function un(e){var t=[],n=function(n,r){var o=e.i++;return t[o]=r&&t[o]&&b(t[o][0],r)?t[o]:[r,n.apply(null,r)],t[o][1]};return{memo:n,callback:function(e){var t=n(Object,[]);return t.current=e,t.cb||(t.cb=function(){return t.current.apply(this,arguments)})},effect:function(t,r){n((function(){e.push(X(t))}),r)}}}function an(e){return F(e)||""===e||D(e)&&!e.length}function cn(e){return e.props.required&&e.isEmpty(e.value)}function fn(e){return Gt(e)?C(!0,D(e)?[]:{},e):e}function sn(e){return(Gt(e)||"").uniqueId}function ln(e,t){for(var n=D(t)||t.split("."),r=e.data,o=r,i=0,u=n.length;i<u;i++){if(!E(r,n[i]))return{name:n[u-1],parent:i===u-1?r:null};o=r,r=r[n[i]]}return{exists:!0,name:n[u-1],value:r,parent:o}}function dn(e,t){var n=t.length;return e.slice(0,n)===t&&(!e[n]||"."===e[n])}function vn(e,t){var n=ln(e,t),r=sn(n.parent);return r&&Gt(e).fields[r+"."+n.name]}function pn(e,t,n){if(t===e.data)return n;for(var r=Gt(e).paths,o=n?[n]:[],i=sn(t);i=r[i];i=i.slice(0,8))o.unshift(i.slice(9));return ln(e,o)[n?"parent":"value"]===t?o.join("."):""}function mn(){var e=I(Xt);g(Xt,(function(e,t){t.onChange(t.value,!0)})),Xt.clear(),g(Zt,(function(t){var n=Gt(t),r=L(Zt,t),o=n.ref||Ce.root,i=x(e,(function(e){return(e.form||en)===t}));if(t!==en&&$t.emit("dataChange",t,function(e){for(var t in e)for(;t=t.replace(/(^|\.)[^.]+$/,"");)e[t]=!0;return R(e)}(r)),wn(t,x(i,(function(e){return e.version&&(e.props.validateOnChange+1||t.validateOnChange+1)>1}))),t.preventLeave&&!n.unlock&&i[0]&&"script"!==Ce.getEventSource(o)){var u=new Promise((function(e){n.unlock=function(){n.unlock=null,e()}}));Oe(o,u,(function(e){return $t.emit("beforeLeave",t,{reason:e})||K()}))}}))}function hn(e){!e.controlled||e.committing?(e.version++,e.meta=null,Xt.add(e)):e.onChange(e.value)}function gn(e,t){var n=Gt(e),r=D(t)?[]:{},o=B(),i=function(t,i){var u=pn(e,c,t);if(u){i&&(i.value=r[t],hn(i));for(var a=o;a=n.paths[a];a=a.slice(0,8))n.fields[a]&&hn(n.fields[a]);A(Zt,e,Object)[u]=!0,$(mn)}},u=function(t,i){return(z(i)||D(i))&&((Gt(i)||"").state!==n&&(i=gn(e,i)),n.paths[sn(i)]=o+"."+t),r[t]=i,i},a=function(e){delete r[e]},c=new Proxy(r,{set:function(e,t,r){if(!("string"!=typeof t||U(e[t],r)&&t in e)){var a=e[t],c=n.fields[o+"."+t];if(c&&(r=c.normalizeValue(r),U(r,a)))return!0;if(D(e)){if("length"===t){for(var f=a-1;f>=r;f--)i(f);return e[t]=r,!0}}else{if(Gt(r)&&ee("Cannot assign proxied data object"),D(r)&&D(a))return a.splice.apply(a,[0,a.length].concat(r)),!0;if(z(r)&&Gt(a)){for(var s in S(a,R(r)))delete a[s];return C(a,r),!0}}u(t,r),i(t,c)}return!0},deleteProperty:function(e,t){return"string"==typeof t&&t in e&&(a(t),i(t)),!0}});for(var f in Gt(c,{state:n,uniqueId:o,set:u,delete:a}),t)u(f,t[f]);return c}function yn(e){var t={version:0,initialValue:e,error:"",preset:{},onChange:function(e,n){!t.props.onChange||t.controlled&&n||t.props.onChange(fn(e))},setValue:function(e){var n=(t.pending||t).value;if(e=M(e)?e(n):e,t.controlled)if(e=t.normalizeValue(e),t.pending={value:e},Xt.delete(t),t.updating){var r=t.pending;G((function(){t.pending!==r||U(t.value,e)||t.onChange(e)}))}else U(n,e)||t.onChange(e);else t.dict[t.name]=e},setError:function(e){t.error=M(e)?e(t.error):e},validate:function(){return wn(t.form,[t])},getMeta:function(e){var n={empty:t.isEmpty(e)};return k((t.preset.getMeta||W).call(t.preset,n,e,t.props))},isEmpty:function(e){return(t.props.isEmpty||(t.preset.isEmpty||an).bind(t.preset))(e)},normalizeValue:function(e){return(t.preset.normalizeValue||W).call(t.preset,e,t.props)},elementRef:function(e){t.element=e}};return te(t,!0),v(t,"error","",(function(e){return M(e)||O(e,on)?function(e,t){return{toString:function(){return O(t,on)?Q([e.props,e.form||"",Cn],(function(n){return(n.formatError||T).call(n,t,e.path||null,e.props,e.form)}))||t.message:t(e.props||{})}}}(t,e):e||""})),te(t,"error",(function(e){t.form&&$t.emit("validationChange",t.form,{name:t.path,isValid:!e,message:String(e)})})),d(t.elementRef,"current",(function(){return t.element||null})),t}function bn(e,t,n,r,o,i,u){var a=e.form===en?null:e.form,c=u?sn(i)+"."+u:e.paths[sn(i)],f=t.key!==c;C(t,{form:a,props:r,preset:n,controlled:o,dict:i,key:c,name:u,path:a?pn(a,i,u):"",error:"error"in r?r.error:f?"":t.error,locks:f?[]:t.locks});var s=a?e.setValid:T;e.fields[c]=t,de((function(){return e.fields[c]=t,function(){e.fields[c]===t&&(delete e.fields[c],t.pending=!1,!t.props.clearWhenUnmount&&a||G((function(){e.fields[c]||delete i[u]})),s())}}),[e,t,c]),de((function(){s()}),[e,t.error,r.disabled,r.required])}function wn(e,t){e===en&&(e=null);var o=function(t){var n=t.path,r=t.value,o=t.meta||(t.meta=t.getMeta(r)),i=$t.emit("validate",e,{name:n,value:r,meta:o});return i||!t.props?i:(t.props.onValidate||T)(r,n,e,o)||cn(t)&&new on("required","Required")},i=t.map((function(e){var t=e.locks||(e.locks=[]),r=t[0];return r?t[1]||(t[1]=n(t[0],(function(){var i=o(e);return n(i,(function(){t[0]===r&&t.shift()})),i}))):(t[0]=K(o(e)),t[0])}));return _(i).then((function(n){return t.forEach((function(e,t){e.locks[0]===i[t]&&(e.locks.shift(),e.error=n[t])})),(e||{}).isValid=null,!r(n)}))}function Sn(e){Gt(e).viewState.set(e.toJSON())}function Cn(e,t,n){M(e)&&(e=e());var o=this,i={},u=Gt(o,{form:o,fields:i,viewState:n,paths:{},initialData:e,setValid:v(o,"isValid",!0,(function(){return!r(i,(function(e){return!e.props.disabled&&(e.error||cn(e))}))}))});C(o,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),C({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),o.ref=function(e){u.ref=e,e&&Qt.set(e,o)},o.data=gn(o,n.get()||u.initialData)}function Vn(e,t,n){if("string"!=typeof e)return Vn("",e,t);var r=vt(e),o=he((function(){return new Cn(t,n,r)}))[0],i=Ue();return Qe(o,"isValid"),ut((function(){(Gt(o).unlock||T)(),o.autoPersist&&Sn(o)})),de((function(){return L(Zt,o)&&i(),o.on({dataChange:i,reset:i})}),[o]),o}function kn(e,t,n,r){"string"==typeof e?e=tn[e]:M(e)||(r=n,n=t,t=e,e="");var o=he(B)[0],i=le(nn),u=he([])[0],a=ve((function(){return e?[new e,un(u)]:[{}]}),[e]),c=a[0];r=r||c.valueProperty||"value";var s=i,l=t.name;s&&l||(s=en.data,l=o);var d=l in s,v=r in t,p=he((function(){return yn(v?t[r]:void 0!==n?n:c.defaultValue)}))[0],m=p.key;bn(Gt(s).state,p,c,t,v,s,l);var h=v?t[r]:d?s[l]:p.initialValue;m!==p.key&&(h=p.normalizeValue(h)),!d&&p.isEmpty(h)?Gt(s).set(l,h):(p.committing=!0,s[l]=h,p.committing=!1),p.pending=!1,p.value=s[l],p.meta=p.getMeta(p.value),d||(p.version=0),u.i=0,de((function(){f(u.splice(0))()})),Qe(p,"error"),Qe(p,"version",(function(){return p.committing}));try{return p.updating=!0,(c.postHook||W).call(c,{form:i&&Gt(i).state.form,key:p.form?p.key:"",path:p.path,value:p.value,error:String(p.error),version:p.version,meta:p.meta,setValue:p.setValue,setError:p.setError,validate:p.validate,elementRef:p.elementRef},t,a[1])}finally{p.updating=!1}}function xn(){var e=x(I(arguments),M);return function(t,n,r,o){return e.reduce((function(e,i){return e.then((function(e){return e||i(t,n,r,o)}))}),K())}}function En(e,t){M(t)&&(t={postHook:t}),tn[e]=function(){return t}}l(Cn,{ERROR_FIELD:1,EMPTY_FIELD:2,get:function(e){return Q(we(e),Qt.get.bind(Qt))||null}}),m(Cn,{element:function(e){return e?(vn(this,e)||"").element:Gt(this).ref},focus:function(e){var t,n=this;return!!(t="number"==typeof e?j(Gt(n).fields,(function(t){return t.error&&1&e||t.isEmpty(t.value)&&2&e?t.element:null})).sort(be)[0]:e?n.element(e)||j(Gt(n).fields,(function(t){return dn(t.path,e)?t.element:null})).sort(be)[0]:n.element())&&Ve(t)},on:function(e,t){return $t.add(this,e,t)},persist:function(){Sn(this),this.autoPersist=!1},restore:function(){var e=Gt(this).viewState.get();return e&&this.reset(e),!!e},clear:function(){this.reset({})},reset:function(e){var t=this,n=Gt(t),r=Gt(t.data);for(var o in t.data)r.delete(o);for(var o in e=e||n.initialData)r.set(o,e[o]);g(n.fields,(function(e,n){var r=ln(t,n.path);n.controlled?n.onChange(r.exists?r.value:n.initialValue):r.exists&&(n.value=r.value,n.version=0,n.meta=null),n.error=null})),n.setValid(),(n.unlock||T)(),$t.emit("reset",t)},getValue:function(e){return fn(ln(this,e).value)},setValue:function(e,t){var n=ln(this,e);n.parent&&(n.parent[n.name]=fn(t))},getErrors:function(){var e=x(Gt(this).fields,(function(e){return e.error}));return e[0]?e.reduce((function(e,t){return e[t.path]=String(t.error),e}),{}):null},getError:function(e){return String((vn(this,e)||"").error||"")},setError:function(e,t){(vn(this,e)||{}).error=t},validate:function(){var e=this,t=Gt(e).fields,n=I(arguments);return n.length?wn(e,x(t,(function(e){return r(n,(function(t){return dn(e.path,t)}))}))):wn(e,x(t,(function(e){return!e.props.disabled})))},toJSON:function(){return C(!0,{},this.data)}}),v(Cn.prototype,"preventLeave",!1,(function(e){return e||(Gt(this).unlock||T)(),!!e}));var On=ce((function(e,t){var n=e.context;return C(n,q(e,["enterKeyHint","preventLeave","formatError"])),ae(rn,{value:n.data},ae("form",C(S(e,["context","enterKeyHint","preventLeave","formatError"]),{ref:Dt(t,n.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||T).call(this,t)},onReset:function(t){t.preventDefault(),n.reset(),(e.onReset||T).call(this,t)}})))}));function Dn(e){return ae(rn,{value:e.value.data},e.children)}function Pn(e){return Mn(C({},e,{defaultValue:[]}))}function Mn(e){var t=he(B)[0],n=e.name,r=le(nn);r||(r=en.data,n=t);var o=me(),i=e.value;(Gt(i)||"").state?(r=i,n=""):n?(i="value"in e?i:z(r[n])||D(r[n])||e.defaultValue||{},i=Gt(r).set(n,i)):ee("Value must be a data object or array");var u=Gt(r).state,a=u.fields[u.paths[sn(i)]];a&&0!==a.controlled?(de(T,[null]),de(T,[null])):(bn(u,a=o.current||(o.current=yn(i)),{},e,0,r,n),a.value=i);var c=e.children;return M(c)&&(c=c(i)),ae(rn,{value:i},c)}function zn(e){return kn(e,e.value),null}l(Mn,{keyFor:sn}),d(window,"zeta-dom-react",(function(){return console.warn('window["zeta-dom-react"] is deprecated, access zeta.react instead.'),zeta.react}))})(),u})()));
//# sourceMappingURL=zeta-dom-react.min.js.map