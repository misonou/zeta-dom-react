!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,a),i.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{a.d(i,{default:()=>Z});var e={};a.r(e),a.d(e,{FormContext:()=>T,FormContextProvider:()=>I,classNames:()=>H,combineValidators:()=>_,partial:()=>L,toRefCallback:()=>U,useAsync:()=>z,useDispose:()=>R,useFormContext:()=>W,useFormField:()=>G,useMemoizedFunction:()=>A,useObservableProperty:()=>k,useRefInitCallback:()=>q});var t=a(359),n=a(654),r=n.util,o=r.noop,u=(r.either,r.is,r.isUndefinedOrNull,r.isArray),s=r.isFunction,c=(r.isThenable,r.isPlainObject,r.isArrayLike,r.makeArray),f=r.extend,d=r.each,l=(r.map,r.grep),p=(r.splice,r.any),v=(r.single,r.kv),m=(r.pick,r.exclude,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),h=(r.equal,r.combineFn),g=(r.executeOnce,r.createPrivateStore),y=(r.setTimeoutOnce,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.keys),b=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define,r.definePrototype),C=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),S=r.watch,x=(r.watchOnce,r.watchable,r.inherit,r.deepFreeze,r.iequal,r.randomId,r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),O=(r.reject,r.always),P=r.resolveAll,w=(r.catchAsync,r.setPromiseTimeout,n.EventContainer);const E=n.dom;var F=n.dom;F.textInputAllowed,F.beginDrag,F.beginPinchZoom,F.getShortcut,F.setShortcut,F.focusable,F.focused,F.setModal,F.releaseModal,F.retainFocus,F.releaseFocus,F.focus;const V=E;var j=new WeakMap;function A(e){var n=(0,t.useState)((function(){return function e(){var t=j.get(e);return t&&t.apply(this,arguments)}}))[0];return j.set(n,e),n}function k(e,n){var r=(0,t.useState)(e[n]),a=r[0],i=r[1];return(0,t.useEffect)((function(){return i(e[n]),S(e,n,(function(e){i((function(){return e}))}))}),[e,n]),a}function z(e,n){var r=(0,t.useState)((function(){return{loading:!0,refresh:function(){var t=x().then(e);f(r,{promise:t,loading:!0,error:void 0}),O(t,(function(e,n){r.disposed||r.promise!==t||f(r,e?{loading:!1,value:n}:{loading:!1,value:void 0,error:n})}))}}}))[0],a=u(n);return e=A(e),n=!1!==n,k(r,"loading"),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n&&r.refresh()}),[r,n].concat(a)),[r.value,r]}function q(e){var n=c(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&m(r,t)&&(n[0]=t,e.apply(null,n))}}function R(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return f(h(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}var D=g(),M=(0,t.createContext)(null),I=M.Provider;function N(e,t,n){return{toString:function(){return n(f({},e.fields[t]))}}}function T(e,t){var n=this,r={},a={},i=new w;D(n,{fields:r,errors:a,eventContainer:i,refs:{},initialData:e||{},setValid:C(this,"isValid",!0,(function(){return!p(r,(function(e,t){return!e.disabled&&(a[t]||e.required&&(e.isEmpty?e.isEmpty(n.data[t]):!n.data[t]))}))}))});n.isValid=!0,n.validateOnChange=!1!==t,n.data=function(e,t,n){return new Proxy(f({},n),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(n,r,a){return"string"==typeof r&&n[r]!==a&&(r in n&&t.emitAsync("dataChange",e,[r],{},(function(e,t){return e.concat(t)})),n[r]=a),!0}})}(n,i,e),n.on("dataChange",(function(e){if(n.validateOnChange){var t=l(e.data,(function(e){return!1!==r[e].validateOnChange}));t[0]&&n.validate.apply(n,t)}}))}function W(e,n){var r=(0,t.useState)((function(){return new T(e,n)}))[0],a=(0,t.useState)(0)[1];return k(r,"isValid"),(0,t.useEffect)((function(){return r.on("dataChange",(function(){a((function(e){return++e}))}))}),[r]),r}function G(e,n,r){var a=(0,t.useContext)(M),i=(0,t.useRef)(),o=e.name||"",u=(0,t.useState)((function(){return a&&a.data[o]||n}))[0],s=(0,t.useState)(u),c=(0,t.useState)(""),d=A(e.onValidate),l=s[0],p=s[1],v=c[0],m=c[1],g=A((function(t){e.onChange?e.onChange("function"==typeof t?t(e[r]):t):console.warn("onChange not supplied")}));return(r=r||"value")in e||(g=p,(e=f({},e))[r]=l),a&&o&&(D(a).fields[o]=e),(0,t.useEffect)((function(){if(a&&o){var e=D(a);return e.refs[o]=i,o in a.data&&p(a.data[o]),h((function(){delete e.fields[o],delete e.refs[o],e.setValid()}),a.on("dataChange",(function(e){e.data.includes(o)&&p(a.data[o])})),a.on("validationChange",(function(t){t.name===o&&m(e.errors[o])})),a.on("validate",(function(e){if(e.name===o)return d(e.value,e.name,a)})),a.on("reset",(function(){p(u),m("")})))}}),[a,o,u,d]),(0,t.useEffect)((function(){a&&o&&(a.data[o]=l)}),[a,o,l]),(0,t.useEffect)((function(){a&&o&&D(a).setValid()}),[a,o,e.validateOnChange,e.disabled,e.required]),{value:e[r],error:String(e.error||v||""),setValue:g,setError:m,elementRef:function(e){i.current=e}}}function _(){var e=l(c(arguments),s);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),x())}}function H(){var e=[];return function t(n){d(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(c(r.getClassNames()));else for(var a in r){var i=r[a];i&&e.push(!0===i?a:a+"-"+i)}}))}(c(arguments)),e.join(" ")}function L(e){return function(t,n){e((function(e){return"string"==typeof t&&(t=v(t,s(n)?n(e[t],e):n)),f({},e,t)}))}}function U(e){return e&&!s(e)?function(t){return e.current=t}:e||o}b(T,{element:function(e){var t=D(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&V.focus(t)},on:function(e,t){return D(this).eventContainer.add(this,e,t)},reset:function(){var e=this,t=D(e);for(var n in e.data)delete e.data[n];f(e.data,t.initialData),e.isValid=!0,t.eventContainer.emit("reset",e)},validate:function(){var e=this,t=D(e),n=t.errors,r=t.eventContainer,a=c(arguments);a.length||(a=y(t.fields));var i=f({},n),o=P(a.map((function(t){return r.emit("validate",e,{name:t,value:e.data[t]})})));return o.then((function(o){return a.forEach((function(a,u){s(o[u])&&(o[u]=N(t,a,o[u])),n[a]=o[u],(o[u]||"")!==(i[a]||"")&&r.emit("validationChange",e,{name:a,isValid:!o[u],message:String(o[u]||"")})})),t.setValid(),!p(o,(function(e){return e}))}))}});const Z=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map