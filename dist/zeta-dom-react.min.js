!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.d(i,{default:()=>We});var e={};o.r(e),o.d(e,{ChoiceField:()=>Le,DataView:()=>he,Form:()=>je,FormContext:()=>Ie,FormContextProvider:()=>Re,MultiChoiceField:()=>qe,TextField:()=>De,ToggleField:()=>Be,ViewStateProvider:()=>fe,classNames:()=>ge,combineRef:()=>Ce,combineValidators:()=>Ne,createBreakpointContext:()=>ae,innerTextOrHTML:()=>be,partial:()=>Se,registerFieldType:()=>He,toRefCallback:()=>we,useAsync:()=>te,useDataView:()=>ye,useDispose:()=>re,useErrorHandler:()=>ie,useErrorHandlerRef:()=>oe,useFormContext:()=>Me,useFormField:()=>Ae,useMediaQuery:()=>ue,useMemoizedFunction:()=>$,useObservableProperty:()=>ee,useRefInitCallback:()=>ne,useUpdateTrigger:()=>Y,useViewState:()=>le,withSuspense:()=>Oe});var t=o(359),n=o(654),r=n.util,u=r.noop,a=r.pipe,s=r.either,c=r.is,f=r.isUndefinedOrNull,l=r.isArray,d=r.isFunction,p=(r.isThenable,r.isPlainObject),v=(r.isArrayLike,r.makeArray),m=r.extend,h=r.each,y=r.map,g=r.grep,b=r.splice,S=r.any,C=r.single,w=r.kv,O=(r.fill,r.pick),k=r.exclude,x=(r.mapObject,r.mapGet),P=(r.mapRemove,r.arrRemove,r.setAdd),E=(r.equal,r.combineFn),V=(r.executeOnce,r.createPrivateStore),F=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.isErrorWithCode),R=r.keys,z=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define),I=r.definePrototype,M=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),A=r.watch,N=(r.watchOnce,r.watchable,r.inherit,r.freeze,r.deepFreeze,r.iequal,r.randomId),H=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),j=(r.reject,r.always),T=r.resolveAll,D=(r.retryable,r.deferrable,r.catchAsync,r.setPromiseTimeout,r.delay,r.makeAsync),L=n.util,q=(L.domReady,L.tagName,L.isVisible,L.matchSelector,L.comparePosition,L.connected,L.containsOrEquals,L.acceptNode,L.combineNodeFilters,L.iterateNode,L.iterateNodeToArray,L.getCommonAncestor,L.parentsAndSelf,L.selectIncludeSelf,L.selectClosestRelative,L.createNodeIterator,L.createTreeWalker,L.bind);L.bindUntil,L.dispatchDOMMouseEvent,L.removeNode,L.getClass,L.setClass,L.getScrollOffset,L.getScrollParent,L.getContentRect,L.scrollBy,L.scrollIntoView,L.makeSelection,L.getRect,L.getRects,L.toPlainRect,L.rectEquals,L.rectCovers,L.rectIntersects,L.pointInRect,L.mergeRect,L.elementFromPoint;const B=n.dom;var W=n.dom,K=(W.textInputAllowed,W.beginDrag,W.beginPinchZoom,W.getShortcut,W.setShortcut,W.focusable,W.focused,W.setModal,W.releaseModal,W.retainFocus,W.releaseFocus,W.iterateFocusPath,W.focus);const J=B;var U=n.dom,_=(U.lock,U.locked,U.cancelLock,U.subscribeAsync,U.notifyAsync),G=U.preventLeave,Q=n.EventContainer,Z=new WeakMap,X=new Q;function Y(){var e=(0,t.useState)()[1];return(0,t.useCallback)((function(){e({})}),[])}function $(e){var n=(0,t.useCallback)((function e(){var t=Z.get(e);return t&&t.apply(this,arguments)}),[]);return Z.set(n,e),n}function ee(e,n){var r=Y(),o=e[n],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&r()};return t(e[n]),A(e,n,t)}),[e,n]),o}function te(e,n){var r=(0,t.useState)((function(){var t,n;return{loading:!0,elementRef:function(e){t=e},on:function(e,t){return X.add(r,e,t)},onError:function(e){return r.on("error",(function(t){return e.call(r,t.error)}))},refresh:function(){m(r,{loading:!0,error:void 0});var o=D(e)(),i=j(o,(function(e,t){if(!r.disposed&&n===i)if(e)m(r,{loading:!1,value:t}),X.emit("load",r,{data:t});else if(m(r,{loading:!1,value:void 0,error:t}),!X.emit("error",r,{error:t}))throw t}));return n=i,_(t||J.root,i),o}}}))[0];return n=[!1!==n].concat(l(n)||[]),e=$(e),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n[0]&&r.refresh()}),n),(0,t.useMemo)((function(){n[0]&&(r.loading=!0)}),n),ee(r,"loading"),[r.value,r]}function ne(e){var n=v(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&P(r,t)&&(n[0]=t,e.apply(null,n))}}function re(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return m(E(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function oe(){return ie.apply(this,arguments).ref}function ie(){var e=(0,t.useRef)(!1),n=(0,t.useRef)(null),r=v(arguments),o=(0,t.useState)((function(){return{ref:function(e){n.current=e,s(e)},catch:function(e,t){var n;return t?n=d(e)?c:F:t=e,X.add(o,n?"error":"default",(function(r){if((n||a)(r.error,e))return t(r.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,J.emit("error",n.current||J.root,{error:t},!0)}finally{e.current=!1}}),[]),u=(0,t.useCallback)((function(e){return X.emit("error",o,{error:e})||X.emit("default",o,{error:e})}),[]),s=ne((function(t){J.on(t,"error",(function(t){if(!e.current)return u(t.error)}))}));return(0,t.useEffect)((function(){return E(y(r,(function(e){return e.onError((function(e){return u(e)||i(e)||H()}))})))}),r),o}function ue(e){var n=re(),r=(0,t.useState)((function(){var t=matchMedia(e);return n.push(q(t,"change",(function(){r[1](t.matches)}))),t.matches}));return r[0]}function ae(e){var n={};return A(n,!0),h(e,(function(e,t){var r=matchMedia(t),o=M(n,e,r.matches,!0);q(r,"change",(function(){o(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=Y();return(0,t.useEffect)((function(){return A(n,e)}),[]),n}}}var se=(0,t.createContext)(null),ce=Object.freeze({get:u,set:u}),fe=se.Provider;function le(e){var n=(0,t.useState)(N)[0],r=(0,t.useContext)(se),o=r&&e&&r.getState(n,e)||ce;return(0,t.useEffect)((function(){return o.dispose&&o.dispose.bind(o)}),[o]),o}var de=V(),pe=he.prototype,ve=new Q;function me(e,t){var n=f(e)&&-1,r=f(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function he(e,t,n,r){var o=this,i={filters:m({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?he.pageSize:r};for(var u in e=m({},e))M(e,u);var a=de(o,{filters:Object.freeze(e),defaults:i,items:[]}),s=function(){a.sorted=a.items.length?void 0:[],this!==o&&(a.filtered=a.sorted),ve.emitAsync("viewChange",o)};m(this,i),A(o,s),A(o.filters,s)}function ye(e,n,r,o,i){if("string"!=typeof e)return ye("__dataView",e,n,r,o);var a=le(e),s=Y(),c=(0,t.useState)((function(){return m(new he(n,r,o,i),a.get())}))[0];return(0,t.useEffect)((function(){var e=de(c);return E(c.on("viewChange",s),a.onPopState?a.onPopState((function(t){a.set(c.toJSON()),m(c,t||e.defaults)})):u,(function(){a.set(c.toJSON())}))}),[c]),c}function ge(){var e=[];return function t(n){h(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(v(r.getClassNames()));else for(var o in r){var i=r[o];i&&e.push(!0===i?o:o+"-"+i)}}))}(v(arguments)),e.join(" ")}function be(e){return p(e)?{dangerouslySetInnerHTML:e}:{children:e}}function Se(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=w(t,d(n)?n(e[t],e):n)),m({},e,t)}))};return t?n.bind(0,t):n}function Ce(){return E(v(arguments).map(we))}function we(e){return e&&!d(e)?function(t){return e.current=t}:e||u}function Oe(e,n){n=n||t.Fragment,d(n)&&(n=(0,t.createElement)(n));var r=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:n},(0,t.createElement)(r,e))}}function ke(e){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(e)}z(he,{pageSize:0}),I(he,{itemCount:0,on:function(e,t){return ve.add(this,e,t)},getView:function(e,t){var n=this,r=de(n),o=n.pageIndex||0,i=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var u=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=u,e&&(n.itemCount=u.length),[u.slice(o*i,i?(o+1)*i:void 0),u.length]},sort:function(e,t){if(e=v(e),!d(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return h(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),i=o.get(t);return r*(l(n)?C(n,(function(e,t){return me(e,i[t])})):me(n,i))}))},toJSON:function(){var e=this;return m(O(e,R(de(e).defaults)),{filters:m({},e.filters),itemCount:e.itemCount})},reset:function(){m(this,de(this).defaults)}}),M(pe,"sortBy"),M(pe,"sortOrder"),M(pe,"pageIndex"),M(pe,"pageSize"),M(pe,"filters",{},(function(e){return m(de(this).filters,e)}));var xe=V(),Pe=new Q,Ee=new WeakMap,Ve={text:De,toggle:Be,choice:Le},Fe=(0,t.createContext)(null),Re=Fe.Provider;function ze(e){return f(e)||""===e||l(e)&&!e.length}function Ie(e,t,n){var r=this,o={},i=xe(r,{fields:o,viewState:n,vlocks:{},initialData:e,setValid:M(this,"isValid",!0,(function(){return!S(o,(function(e,t){var n=e.props;return!n.disabled&&(e.error||n.required&&(n.isEmpty||e.preset.isEmpty||ze)(r.data[t]))}))}))});m(r,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),m({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),r.ref=function(e){i.ref=e},r.isValid=!0,r.data=function(e,t){var n=xe(e);return new Proxy(m({},t),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(t,r,o){return"string"==typeof r&&t[r]!==o&&(r in t&&((n.fields[r]||{}).dirty=!0,Pe.emitAsync("dataChange",e,[r],{},(function(e,t){return e.indexOf(t[0])<0?e.concat(t):e}))),t[r]=o),!0}})}(r,n.get()||i.initialData),r.on("dataChange",(function(e){if(r.validateOnChange){var t=g(e.data,(function(e){return o[e]&&!1!==o[e].props.validateOnChange}));t[0]&&r.validate.apply(r,t)}if(r.preventLeave&&!i.unlock){var n=new Promise((function(e){i.unlock=function(){i.unlock=null,e()}}));G(i.ref||J.root,n,(function(){return Pe.emit("beforeLeave",r)}))}}))}function Me(e,n,r){if("string"!=typeof e)return Me("",e,n);var o=le(e),i=(0,t.useState)((function(){return new Ie(n,r,o)}))[0],a=Y();return ee(i,"isValid"),(0,t.useEffect)((function(){return E(i.on("dataChange",a),i.on("reset",a),(function(){(xe(i).unlock||u)(),i.autoPersist&&i.persist()}))}),[i]),i}function Ae(e,n,r,o){"string"==typeof e&&(e=Ve[e]),d(e)||(o=r,r=n,n=e,e="");var i=e?x(Ee,e,e):{};o=o||i.valueProperty||"value";var s=m((0,t.useState)({})[0],{preset:i,props:n}),c=(0,t.useContext)(Fe),f=c&&c.data,l=c&&xe(c),p=n.name||"",v=(0,t.useState)((function(){return c&&p in f?f[p]:r}))[0],h=(0,t.useState)(v),y=(0,t.useState)(""),g=o in n,b=g?n[o]:h[0],S=g?u:h[1],C=y[0],w=y[1],O=$((function(e){e="function"==typeof e?e(b):e,S(e),c&&!s.dirty&&(f[p]=e,s.dirty=!1),g&&!n.onChange&&console.warn("onChange not supplied"),(n.onChange||u)(e)}));return c&&p&&(l.fields[p]=s,!g&&p in f||(f[p]=b)),(0,t.useEffect)((function(){if(c&&p)return E((function(){l.fields[p]===s&&(delete l.fields[p],l.setValid())}),c.on("dataChange",(function(e){e.data.includes(p)&&(s.dirty=!1,S(f[p]))})),c.on("validationChange",(function(e){e.name===p&&w(s.error)})),c.on("reset",(function(){f[p]=v,S(v),w("")})))}),[c,p,f,v]),(0,t.useEffect)((function(){l&&(s.error=n.error||C,l.setValid())}),[l,C,n.error,n.disabled,n.required]),(i.postHook||a)({form:c,value:b,error:String(n.error||C||""),setValue:O,setError:w,elementRef:function(e){s.element=e}},n)}function Ne(){var e=g(v(arguments),d);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),H())}}function He(e,t){d(t)&&(t={postHook:t}),Ve[e]=function(){return t}}I(Ie,{element:function(e){var t=xe(this).fields[e];return t&&t.element},focus:function(e){var t=this.element(e);t&&K(t)},on:function(e,t){return Pe.add(this,e,t)},persist:function(){var e=this;xe(e).viewState.set(e.toJSON()),e.autoPersist=!1},restore:function(){var e=xe(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,n=xe(t);for(var r in t.data)delete t.data[r];h(n.fields,(function(e,t){t.error=null})),m(t.data,e||n.initialData),n.setValid(),(n.unlock||u)(),Pe.emit("reset",t)},setError:function(e,t){var n=xe(this),r=n.fields[e]||{},o=r.error||"";d(t)&&(t=function(e,t){return{toString:function(){return t(e.props||{})}}}(r,t)),r.error=t,(t||"")!==o&&(Pe.emit("validationChange",this,{name:e,isValid:!t,message:String(t||"")}),n.setValid())},validate:function(){var e=this,t=xe(e),n=t.vlocks,r=v(arguments);r.length||(r=R(t.fields));var o=function(n){var r=t.fields[n],o=e.data[n],i=Pe.emit("validate",e,{name:n,value:o});return!i&&r&&(i=(r.props.onValidate||u)(o,n,e)),i},i=r.map((function(e){var t=n[e]=n[e]||[],r=t[0];return r?t[1]||(t[1]=j(t[0],(function(){var n=o(e);return j(n,(function(){t[0]===r&&t.shift()})),n}))):(t[0]=H(o(e)),t[0])}));return T(i).then((function(o){return r.forEach((function(t,r){n[t][0]===i[r]&&(n[t].shift(),e.setError(t,o[r]))})),t.setValid(),!S(o,(function(e){return e}))}))},toJSON:function(){return m(!0,{},this.data)}});var je=(0,t.forwardRef)((function(e,n){var r=e.context;return m(r,O(e,["enterKeyHint","preventLeave"])),(0,t.createElement)(Re,{value:r},(0,t.createElement)("form",m(k(e,["context","enterKeyHint","preventLeave"]),{ref:Ce(n,r.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||u).call(this,t)},onReset:function(t){t.preventDefault(),r.reset(),(e.onReset||u).call(this,t)}})))}));function Te(e){return(0,t.useMemo)((function(){return(e||[]).map((function(e){return"object"===ke(e)?e:{label:String(e),value:e}}))}),[e])}function De(){this.postHook=function(e,t){var n=e.form,r=O(t,["type","autoComplete","maxLength","inputMode","placeholder","enterKeyHint"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,m(e,{inputProps:r})}}function Le(){this.postHook=function(e,n){var r=Te(n.items),o=r.findIndex((function(t){return t.value===e.value}));return(0,t.useEffect)((function(){if(o<0){var t=n.allowUnselect||!r[0]?"":r[0].value;t!==e.value&&e.setValue(t)}})),m(e,{items:r,selectedIndex:o,selectedItem:r[o]})}}function qe(){this.postHook=function(e,t){var n=t.allowCustomValues||!t.items,r=Te(t.items),o=function(e){return!r.some((function(t){return t.value===e}))},i=$((function(t,r){!n&&o(t)||e.setValue((function(e){var n=e.indexOf(t);return(f(r)||s(n<0,r))&&(e=v(e),n<0?e.push(t):e.splice(n,1)),e}))}));if(!n){var u=v(e.value);b(u,o).length&&e.setValue(u)}return m(e,{items:r,toggleValue:i})}}function Be(){this.valueProperty="checked",this.isEmpty=function(e){return!e}}const We=e;n.react=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map