/*! zeta-dom-react v0.5.1 | (c) misonou | https://misonou.github.io */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom"),require("react-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom","react-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom"),require("react-dom")):e["zeta-dom-react"]=t(e.React,e.zeta,e.ReactDOM)}(self,((e,t,n)=>(()=>{"use strict";var r={12:t=>{t.exports=e},33:e=>{e.exports=n},231:e=>{e.exports=t}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{i.d(u,{default:()=>Jt});var e={};i.r(e),i.d(e,{ChoiceField:()=>et,DataView:()=>Be,DateField:()=>ct,Form:()=>Wt,FormArray:()=>Kt,FormContext:()=>jt,FormContextProvider:()=>Bt,FormObject:()=>Ut,HiddenField:()=>_t,MultiChoiceField:()=>st,NumericField:()=>lt,TextField:()=>ft,ToggleField:()=>dt,ValidationError:()=>Et,ViewStateProvider:()=>je,classNames:()=>Je,combineRef:()=>Ze,combineValidators:()=>qt,createBreakpointContext:()=>Ie,domEventRef:()=>_e,innerTextOrHTML:()=>Ye,isSingletonDisposed:()=>Pe,partial:()=>Ge,registerFieldType:()=>Lt,toRefCallback:()=>$e,useAsync:()=>Ve,useDataView:()=>Ke,useDispose:()=>Oe,useErrorHandler:()=>Me,useErrorHandlerRef:()=>Fe,useFormContext:()=>Ht,useFormField:()=>At,useMediaQuery:()=>ze,useMemoizedFunction:()=>ke,useObservableProperty:()=>Ce,useRefInitCallback:()=>xe,useSingleton:()=>Re,useUnloadEffect:()=>De,useUpdateTrigger:()=>Ee,useViewState:()=>He,withSuspense:()=>Qe});var t=i(12),n=i(231),r=n.util,o=r.noop,a=r.pipe,c=r.either,s=r.sameValueZero,l=r.is,f=r.isUndefinedOrNull,d=r.isArray,v=r.isFunction,p=(r.isThenable,r.isPlainObject),m=(r.isArrayLike,r.makeArray),h=r.extend,g=r.each,y=r.map,b=r.grep,S=r.splice,w=r.any,E=r.single,k=r.kv,C=(r.fill,r.pick),V=r.exclude,x=(r.mapObject,r.mapGet),O=r.mapRemove,P=(r.arrRemove,r.setAdd),R=(r.equal,r.combineFn),F=(r.executeOnce,r.createPrivateStore),M=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate),D=r.setImmediateOnce,z=r.clearImmediateOnce,I=r.throws,N=r.throwNotFunction,T=(r.errorWithCode,r.isErrorWithCode),j=r.keys,H=(r.values,r.hasOwnProperty),A=(r.getOwnPropertyDescriptors,r.define),q=r.definePrototype,L=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),W=r.watch,B=(r.watchOnce,r.watchable,r.inherit,r.freeze),K=(r.deepFreeze,r.iequal,r.randomId),U=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.matchWordMulti,r.htmlDecode,r.resolve),_=(r.reject,r.always),J=r.resolveAll,Y=(r.retryable,r.deferrable),G=r.catchAsync,Z=(r.setPromiseTimeout,r.delay),$=r.makeAsync,Q=n.util,X=(Q.domReady,Q.tagName,Q.isVisible,Q.matchSelector,Q.comparePosition),ee=(Q.connected,Q.containsOrEquals,Q.acceptNode,Q.combineNodeFilters,Q.iterateNode,Q.iterateNodeToArray,Q.getCommonAncestor,Q.parentsAndSelf),te=(Q.selectIncludeSelf,Q.selectClosestRelative,Q.createNodeIterator,Q.createTreeWalker,Q.bind);Q.bindOnce,Q.bindUntil,Q.dispatchDOMMouseEvent,Q.removeNode,Q.getClass,Q.setClass,Q.getSafeAreaInset,Q.getScrollOffset,Q.getScrollParent,Q.getContentRect,Q.scrollBy,Q.scrollIntoView,Q.makeSelection,Q.getRect,Q.getRects,Q.toPlainRect,Q.rectEquals,Q.rectCovers,Q.rectIntersects,Q.pointInRect,Q.mergeRect,Q.elementFromPoint;const ne=n.dom;var re=n.dom,oe=re.reportError,ie=(re.textInputAllowed,re.beginDrag,re.beginPinchZoom,re.insertText,re.getShortcut,re.setShortcut,re.focusable,re.focused,re.setTabRoot,re.unsetTabRoot,re.setModal,re.releaseModal,re.retainFocus,re.releaseFocus,re.iterateFocusPath,re.focus);re.blur;const ue=ne;var ae=n.dom,ce=(ae.lock,ae.locked,ae.cancelLock,ae.subscribeAsync,ae.notifyAsync),se=(ae.runAsync,ae.preventLeave),le=n.EventContainer,fe=i(33),de=!0;fe.flushSync((function(){function e(){return de=!de,null}var n=document.createElement("div"),r=(0,t.createElement)(t.StrictMode,null,(0,t.createElement)(e));fe.createRoot?fe.createRoot(n).render(r):fe.render(r,n)}));var ve,pe=de,me=new le,he=new WeakSet,ge=new Map,ye=window.AbortController,be=pe?function(e,n){P(he,e)&&(ge.set(e,n),z(Se));(0,t.useEffect)((function(){return ge.delete(e),D(Se),function(){ge.set(e,n),D(Se)}}),[e])}:we;function Se(){g(ge,(function(e){he.delete(e),O(ge,e)()}))}function we(e,n){(0,t.useEffect)((function(){return function(){he.add(e),n()}}),[e])}function Ee(){var e=(0,t.useState)()[1];return(0,t.useCallback)((function(){e({})}),[])}function ke(e){var n=(0,t.useRef)();return n.current=v(e)||o,(0,t.useCallback)((function(){return n.current.apply(this,arguments)}),[])}function Ce(e,n){var r=Ee(),o=e[n],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&r()};return t(e[n]),W(e,n,t)}),[e,n]),o}function Ve(e,n,r){var i=Re((function(){var t,n,u;return{loading:!1,value:void 0,error:void 0,elementRef:function(e){t=e},on:function(e,t){return me.add(i,e,t)},onError:function(e){return i.on("error",(function(t){return e.call(i,t.error)}))},refresh:function(a){if(r&&!a)return(u=u||Y()).waitFor(Z(r)),u.d||(u.d=function(e){return G(e),e}(u.then((function(){return u=null,i.refresh(!0)}))));var c=ye?new ye:{abort:o};n&&n.abort(),h(i,{loading:!0,error:void 0});var s=$(e)(c.signal),l=_(s,(function(e,t){if(n===c)if(e)h(i,{loading:!1,value:t}),me.emit("load",i,{data:t});else if(h(i,{loading:!1,value:void 0,error:t}),!me.emit("error",i,{error:t}))throw t}));return n=c,ce(t||ue.root,l),s},abort:function(e){n&&(n.abort(e),n=null),i.loading=!1}}}),(function(){i.abort()}));return n=[!1!==n].concat(d(n)||[]),e=ke(e),(0,t.useEffect)((function(){n[0]&&D(i.refresh)}),n),(0,t.useMemo)((function(){n[0]&&!r&&(i.loading=!0)}),n),Ce(i,"loading"),[i.value,i]}function xe(e){var n=m(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&P(r,t)&&(n[0]=t,e.apply(null,n))}}function Oe(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return h(R(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function Pe(e){return c(be!==we,he.has(e))}function Re(e,n){var r=v(e)?(0,t.useMemo)(e,[]):(0,t.useMemo)(a.bind(0,e),[e]);return be(r,(function(){(n||r.dispose||o).call(r)})),r}function Fe(){return Me.apply(this,arguments).ref}function Me(){var e=(0,t.useRef)(!1),n=(0,t.useRef)(null),r=m(arguments),o=(0,t.useState)((function(){return{ref:function(e){n.current=e,c(e)},emit:function(e){return u(e)||i(e)||U()},catch:function(e,t){var n;return t?n=d(e)?function(e,t){return w(t,(function(t){return(v(t)?l:T)(e,t)}))}:v(e)?l:T:t=e,me.add(o,n?"error":"default",(function(r){if((n||a)(r.error,e))return t(r.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,oe(t,n.current)}finally{e.current=!1}}),[]),u=(0,t.useCallback)((function(e){return me.emit("error",o,{error:e})||me.emit("default",o,{error:e})}),[]),c=xe((function(t){ue.on(t,"error",(function(t){if(!e.current)return u(t.error)}))}));return(0,t.useEffect)((function(){return R(y(r,(function(e){return e.onError(o.emit)})))}),r),o}function De(e){ve||(ve=new Set,te(window,"pagehide",(function(e){R(m(ve).reverse())(e.persisted)}))),e=ke(e),(0,t.useEffect)((function(){return ve.add(e),function(){ve.delete(e),e(!1)}}),[])}function ze(e){var n=(0,t.useMemo)((function(){return matchMedia(e)}),[e]),r=(0,t.useState)(n.matches);return(0,t.useEffect)((function(){return te(n,"change",(function(){r[1](n.matches)}))}),[n]),r[0]}function Ie(e){var n={};return W(n,!0),g(e,(function(e,t){var r=matchMedia(t),o=L(n,e,r.matches,!0);te(r,"change",(function(){o(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=Ee();return(0,t.useEffect)((function(){return W(n,e)}),[]),n}}}var Ne=(0,t.createContext)(null),Te=Object.freeze({get:o,set:o}),je=Ne.Provider;function He(e){var n=(0,t.useState)(K)[0],r=(0,t.useContext)(Ne);return Re(r&&e&&r.getState(n,e)||Te)}var Ae=F(),qe=Be.prototype,Le=new le;function We(e,t){var n=f(e)&&-1,r=f(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function Be(e,t,n,r){var o=this,i={filters:h({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?Be.pageSize:r};for(var u in e=h({},e))L(e,u);var a=Ae(o,{filters:Object.freeze(e),defaults:i,items:[]}),c=function(){Le.emit("viewChange",o)},s=function(){a.sorted=a.items.length?void 0:[],this!==o&&(a.filtered=a.sorted),D(c)};h(this,i),W(o,s),W(o.filters,s)}function Ke(e,n,r,i,u){if("string"!=typeof e)return Ke("__dataView",e,n,r,i);var a=He(e),c=Ee(),s=(0,t.useState)((function(){return h(new Be(n,r,i,u),a.get())}))[0];return(0,t.useEffect)((function(){var e=Ae(s);return R(s.on("viewChange",(function(){a.set(s.toJSON()),c()})),a.onPopState?a.onPopState((function(t){a.set(s.toJSON()),h(s,t||e.defaults)})):o)}),[s]),s}A(Be,{pageSize:0}),q(Be,{itemCount:0,on:function(e,t){return Le.add(this,e,t)},getView:function(e,t){var n=this,r=Ae(n),o=n.pageIndex||0,i=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var u=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=u,e&&(n.itemCount=u.length),[u.slice(o*i,i?(o+1)*i:void 0),u.length]},sort:function(e,t){if(e=m(e),!v(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return g(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),i=o.get(t);return r*(d(n)?E(n,(function(e,t){return We(e,i[t])})):We(n,i))}))},toggleSort:function(e,t){var n=this;n.sortBy===e?n.sortOrder="asc"===n.sortOrder?"desc":"asc":(n.sortBy=e,n.sortOrder=t||"asc")},toJSON:function(){var e=this;return h(C(e,j(Ae(e).defaults)),{filters:h({},e.filters),itemCount:e.itemCount})},reset:function(){h(this,Ae(this).defaults)}}),L(qe,"sortBy"),L(qe,"sortOrder"),L(qe,"pageIndex"),L(qe,"pageSize"),L(qe,"filters",{},(function(e){return h(Ae(this).filters,e)}));var Ue=new WeakMap;function _e(e,t){var n;return t=p(e)||k(e,t),function(e){if(e){if(n&&n.ref)throw new Error("Callback can only be passed to single React element");void 0===(n=x(Ue,e,Array)).index&&(n.index=0);var r=n.index++,i=n[r]||(n[r]={keys:{}});g(t,(function(t,n){N(n),i.keys[t]=i.keys[t]||ue.on(e,t,(function(){return(i.handler[t]||o).apply(this,arguments)}))})),i.handler=t}else n.index=0;n.ref=e}}function Je(){var e=[];return function t(n){g(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(m(r.getClassNames()));else for(var o in r){var i=r[o];(i||0===i)&&e.push(!0===i?o:o+"-"+i)}}))}(m(arguments)),e.join(" ")}function Ye(e){return p(e)?{dangerouslySetInnerHTML:e}:{children:e}}function Ge(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=k(t,v(n)?n(e[t],e):n)),h({},e,t)}))};return t?n.bind(0,t):n}function Ze(){return R(m(arguments).map($e))}function $e(e){return e&&!v(e)?function(t){return e.current=t}:e||o}function Qe(e,n){n=n||t.Fragment,v(n)&&(n=(0,t.createElement)(n));var r=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:n},(0,t.createElement)(r,e))}}function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function et(){}function tt(e){return(0,t.useMemo)((function(){return(e||[]).map((function(e){return"object"===Xe(e)?e:{label:String(e),value:e}}))}),[e])}A(et,{normalizeItems:tt}),q(et,{defaultValue:"",postHook:function(e,n){var r=tt(n.items),o=r.findIndex((function(t){return t.value===e.value}));return(0,t.useEffect)((function(){o<0&&(o=n.allowUnselect||!r[0]?-1:0,e.setValue(o<0?"":r[0].value))})),h(e,{items:r,selectedIndex:o,selectedItem:r[o]})}});var nt=/^-?\d{4,}-\d{2}-\d{2}$/,rt={y:["getFullYear","setFullYear"],m:["getMonth","setMonth"],d:["getDate","setDate"]};function ot(e){if("string"==typeof e){if(nt.test(e))return Date.parse(e+"T00:00");e="+"===e[0]||"-"===e[0]?function(e){var t=new Date,n="-"===e[0]?-1:1;return e.toLowerCase().replace(/([+-]?)(\d+)([dwmy])/g,(function(e,r,o,i){t[rt[i][1]](t[rt[i][0]]()+o*("-"===r?-1:"+"===r?1:n)*("w"===i?7:1))})),t}(e):Date.parse(e)}return new Date(e).setHours(0,0,0,0)}function it(e,t,n){var r=ot(e);return r<t?t:r>n?n:e}function ut(e){var t=ot(e);return isNaN(t)?null:new Date(t)}function at(e){if(!isNaN(e)){var t=6e4*new Date(e).getTimezoneOffset(),n=new Date(e-t).toISOString();return n.slice(0,n.indexOf("T",10))}return""}function ct(){}function st(){}function lt(){}function ft(){}function dt(){}rt.w=rt.d,A(ct,{toDateString:at,toDateObject:ut}),q(ct,{defaultValue:"",normalizeValue:function(e){return at(ot(e))},postHook:function(e,n){var r=e.setValue,o=e.value,i=ot(n.min),u=ot(n.max),a=(0,t.useMemo)((function(){return o&&n.formatDisplay?n.formatDisplay(ut(o)):o}),[o]);return(0,t.useEffect)((function(){var e=o&&it(o,i,u);e!==o&&r(e)}),[o,i,u]),h(e,{min:at(i),max:at(u),displayText:a,setValue:ke((function(t){(t=v(t)?t(e.value):t)?/\d{4}/.test(t)&&/[^\s\d]/.test(t)&&(t=ot(t),isNaN(t)||r(it(t,i,u))):r("")}))})}}),q(st,{defaultValue:B([]),normalizeValue:function(e){return d(e)||m(e)},postHook:function(e,n){var r=n.allowCustomValues||!n.items,o=et.normalizeItems(n.items),i=function(e){return!o.some((function(t){return t.value===e}))},u=ke((function(t,n){!r&&i(t)||e.setValue((function(e){var r=e.indexOf(t);return(f(n)||c(r>=0,n))&&(e=m(e),r<0?e.push(t):e.splice(r,1)),e}))}));return(0,t.useEffect)((function(){if(!r){var t=m(e.value);S(t,i).length&&e.setValue(t)}})),h(e,{items:o,toggleValue:u})}}),q(lt,{normalizeValue:function(e){return e=+e,isNaN(e)?void 0:e},postHook:function(e,n){var r=e.value,o=n.min,i=n.max,u=n.step,a=n.allowEmpty;return(0,t.useEffect)((function(){var t=u>0?Math.round(r/u)*u:r;t<o||isNaN(t)&&!a?t=o||0:t>i&&(t=i),t!==r&&e.setValue(t)}),[r,o,i,u,a]),e}}),q(ft,{defaultValue:"",normalizeValue:function(e){return f(e)?"":String(e)},postHook:function(e,t){var n=e.form,r=C(t,["type","disabled","autoComplete","maxLength","inputMode","placeholder","enterKeyHint","readOnly"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,h(e,{inputProps:r})}}),q(dt,{defaultValue:!1,valueProperty:"checked",normalizeValue:function(e){return!!e},isEmpty:function(e){return!e},postHook:function(e){var n=(0,t.useCallback)((function(){e.setValue((function(e){return!e}))}),[]);return h(e,{toggleValue:n})}});var vt=F(),pt=new le,mt=new WeakMap,ht=new WeakMap,gt=new Map,yt=new jt({},{},{get:o}),bt={text:ft,toggle:dt,choice:et},St=(0,t.createContext)(null),wt=St.Provider;function Et(e,t,n){this.kind=e,this.args=n,this.message=t}function kt(e,t){var n=e.props.isEmpty||e.preset.isEmpty;return n?n(t):f(t)||""===t||d(t)&&!t.length}function Ct(e){return e.props.required&&kt(e,e.value)}function Vt(e){return vt(e)?h(!0,d(e)?[]:{},e):e}function xt(e){return(vt(e)||"").uniqueId}function Ot(e,t){for(var n=d(t)||t.split("."),r=e.data,o=r,i=0,u=n.length;i<u;i++){if(!H(r,n[i]))return{name:n[u-1],parent:i===u-1?r:null};o=r,r=r[n[i]]}return{exists:!0,name:n[u-1],value:r,parent:o}}function Pt(e,t){var n=Ot(e,t),r=xt(n.parent);return r&&vt(e).fields[r+"."+n.name]}function Rt(e,t,n){if(t===e.data)return n;for(var r=vt(e).paths,o=[n],i=xt(t);i=r[i];i=i.slice(0,8))o.unshift(i.slice(9));return Ot(e,o).parent===t?o.join("."):""}function Ft(){g(gt,(function(e){var t=vt(e),n=O(gt,e);for(var r in n)for(;r=r.replace(/(^|\.)[^.]+$/,"");)n[r]=!0;var o=t.ref||ue.root,i=b(t.fields,(function(e){return n[e.path]}));if(pt.emit("dataChange",e,j(n)),Nt(e,b(i,(function(t){return t.version&&(t.props.validateOnChange+1||e.validateOnChange+1)>1}))),e.preventLeave&&!t.unlock&&i[0]&&"script"!==ue.getEventSource(o)){var u=new Promise((function(e){t.unlock=function(){t.unlock=null,e()}}));se(o,u,(function(){return pt.emit("beforeLeave",e)||U()}))}}))}function Mt(e){var t,n=Mt.d||(Mt.d=t=new Set);try{e()}finally{n===t&&(g(t,(function(e,t){t.onChange(t.value)})),Mt.d=null)}}function Dt(e,t){var n=vt(e),r=d(t)?[]:{},o=K(),i=function(t,i){var a=Rt(e,c,t);if(a){if(i){if(i.value=r[t],!s(i.value,r[t]))return void u(t,i.value);Mt.d.add(i)}for(var l=o;l=n.paths[l];l=l.slice(0,8))n.fields[l]&&Mt.d.add(n.fields[l]);return e!==yt&&(x(gt,e,Object)[a]=!0,D(Ft)),!0}},u=function(t,i){return(p(i)||d(i))&&((vt(i)||"").context!==e&&(i=Dt(e,i)),n.paths[xt(i)]=o+"."+t),r[t]=i,i},a=function(e){delete r[e]},c=new Proxy(r,{set:function(e,t,r){return"string"!=typeof t||s(e[t],r)&&t in e||Mt((function(){var a=e[t];if(d(e)){if("length"===t){for(var c=a-1;c>=r;c--)i(c);return e[t]=r,!0}}else{if(vt(r)&&I("Cannot assign proxied data object"),d(r)&&d(a))return a.splice.apply(a,[0,a.length].concat(r)),!0;if(p(r)&&vt(a)){for(var s in V(a,r))delete a[s];return h(a,r),!0}}u(t,r),i(t,n.fields[o+"."+t])})),!0},deleteProperty:function(e,t){return"string"==typeof t&&t in e&&Mt((function(){a(t),i(t)})),!0}});return vt(c,{context:e,uniqueId:o,set:u,delete:a}),g(t,(function(e,t){u(e,t)})),c}function zt(e){var t={version:0,initialValue:e,value:e,error:"",preset:{},onChange:function(e){t.controlled||t.version++,t.props.onChange&&t.props.onChange(Vt(e))},setValue:function(e){e=v(e)?e(t.value):e,t.controlled?s(e,t.value)||t.onChange(e):t.value=e},setError:function(e){t.error=v(e)?e(t.error):e,(t.form||{}).isValid=null},validate:function(){return Nt(t.key?t.form:null,[t])},elementRef:function(e){t.element=e}};return W(t,!0),L(t,"value",e,(function(e,n){return(e=(t.preset.normalizeValue||a)(e,t.props))!==n&&vt(n)&&e!==t.dict[t.name]?(t.dict[t.name]=e,n):e})),L(t,"error","",(function(e){return v(e)||l(e,Et)?function(e,t){return{toString:function(){return l(t,Et)?E([e.props,e.form||"",jt],(function(n){return(n.formatError||o).call(n,t,e.path||null,e.props,e.form)}))||t.message:t(e.props||{})}}}(t,e):e||""})),W(t,"value",(function(e){t.version++,t.key?t.dict[t.name]=e:t.controlled||t.onChange(e)})),W(t,"error",(function(e){t.version++,t.key&&pt.emit("validationChange",t.form,{name:t.path,isValid:!e,message:String(e)})})),t}function It(e,n,r,o,i,u,a,c){var s="error"in i,l=r.key||c;h(r,{form:e,props:i,preset:o,controlled:u,dict:a,key:c}),e&&c?(r.name=c.slice(9),r.path=Rt(e,a,r.name),l!==c&&(r.locks=[],s||(r.error="")),n.fields[c]=r):r.path="",s&&(r.error=i.error),(0,t.useEffect)((function(){return e&&c&&(n.fields[c]=r),function(){n&&n.fields[c]===r&&(delete n.fields[c],(r.props.clearWhenUnmount||r.form===yt)&&M((function(){n.fields[c]||delete a[c.slice(9)]})),n.setValid())}}),[n,r,c]),(0,t.useEffect)((function(){n&&n.setValid()}),[n,r.error,i.disabled,i.required])}function Nt(e,t){var n=function(t){var n=t.path,r=t.value,i=pt.emit("validate",e,{name:n,value:r});return i||!t.props?i:(t.props.onValidate||o)(r,n,e)||Ct(t)&&new Et("required","Required")},r=t.map((function(e){var t=e.locks||(e.locks=[]),r=t[0];return r?t[1]||(t[1]=_(t[0],(function(){var o=n(e);return _(o,(function(){t[0]===r&&t.shift()})),o}))):(t[0]=U(n(e)),t[0])}));return J(r).then((function(n){t.forEach((function(e,t){e.locks[0]===r[t]&&(e.locks.shift(),e.error=n[t])}));var o=vt(e);return o&&o.setValid(),!w(n)}))}function Tt(e){vt(e).viewState.set(e.toJSON())}function jt(e,t,n){v(e)&&(e=e());var r=this,o={},i=vt(r,{fields:o,viewState:n,paths:{},initialData:e,setValid:L(this,"isValid",!0,(function(){return!w(o,(function(e){return!e.props.disabled&&(e.error||Ct(e))}))}))});h(r,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),h({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),r.ref=function(e){i.ref=e,e&&ht.set(e,r)},r.isValid=!0,r.data=Dt(r,n.get()||i.initialData)}function Ht(e,n,r){if("string"!=typeof e)return Ht("",e,n);var i=He(e),u=(0,t.useState)((function(){return new jt(n,r,i)}))[0],a=Ee();return Ce(u,"isValid"),De((function(){(vt(u).unlock||o)(),u.autoPersist&&Tt(u)})),(0,t.useEffect)((function(){return O(gt,u)&&a(),u.on({dataChange:a,reset:a})}),[u]),u}function At(e,n,r,o){"string"==typeof e&&(e=bt[e]),v(e)||(o=r,r=n,n=e,e="");var i=e?x(mt,e,e):{};o=o||i.valueProperty||"value";var u=(0,t.useContext)(St),c=u&&vt(u).context,s=c&&vt(c),l=n.name||"",f=c&&l&&xt(u)+"."+l,d=o in n,p=(0,t.useState)((function(){return zt(d?n[o]:(i.normalizeValue||a)(void 0!==r?r:i.defaultValue))}))[0];It(c,s,p,i,n,d,u,f),d&&(p.value=n[o]),c&&f&&(l in u?d||(p.value=u[l]):(kt(p,p.initialValue)?p.value=vt(u).set(l,p.initialValue):u[l]=p.initialValue,p.version=0));var m=(i.postHook||a)({form:c,key:f,path:p.path,value:p.value,error:String(p.error),setValue:p.setValue,setError:p.setError,validate:p.validate,elementRef:p.elementRef},n);return m.value=p.value,m.error=String(p.error),Ce(p,"version"),m}function qt(){var e=b(m(arguments),v);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),U())}}function Lt(e,t){v(t)&&(t={postHook:t}),bt[e]=function(){return t}}Mt.d=null,A(jt,{ERROR_FIELD:1,EMPTY_FIELD:2,get:function(e){return E(ee(e),ht.get.bind(ht))||null}}),q(jt,{element:function(e){return e?(Pt(this,e)||"").element:vt(this).ref},focus:function(e){var t;return!!(t="number"==typeof e?y(vt(this).fields,(function(t){return t.error&&1&e||kt(t,t.value)&&2&e?t.element:null})).sort(X)[0]:this.element(e))&&ie(t)},on:function(e,t){return pt.add(this,e,t)},persist:function(){Tt(this),this.autoPersist=!1},restore:function(){var e=vt(this).viewState.get();return e&&this.reset(e),!!e},clear:function(){this.reset({})},reset:function(e){var t=this,n=vt(t),r=vt(t.data);for(var i in t.data)r.delete(i);g(e||n.initialData,(function(e,t){r.set(e,t)})),g(n.fields,(function(e,n){var r=Ot(t,n.path);n.controlled?n.onChange(r.exists?r.value:n.initialValue):r.exists&&(n.value=r.value),n.error=null})),n.setValid(),(n.unlock||o)(),pt.emit("reset",t)},getValue:function(e){return Vt(Ot(this,e).value)},setValue:function(e,t){var n=Ot(this,e);n.parent&&(n.parent[n.name]=Vt(t))},getErrors:function(){var e=b(vt(this).fields,(function(e){return e.error}));return e[0]?e.reduce((function(e,t){return e[t.path]=String(t.error),e}),{}):null},getError:function(e){return String((Pt(this,e)||"").error||"")},setError:function(e,t){(Pt(this,e)||{}).error=t},validate:function(){var e=this,t=vt(e).fields,n=m(arguments);return n[0]?Nt(e,b(t,(function(e){return w(n,(function(t){var n=t.length;return e.path.slice(0,n)===t&&(!e.path[n]||"."===e.path[n])}))}))):Nt(e,b(t,(function(e){return!e.props.disabled})))},toJSON:function(){return h(!0,{},this.data)}}),L(jt.prototype,"preventLeave",!1,(function(e){return e||(vt(this).unlock||o)(),!!e}));var Wt=(0,t.forwardRef)((function(e,n){var r=e.context;return h(r,C(e,["enterKeyHint","preventLeave","formatError"])),(0,t.createElement)(wt,{value:r.data},(0,t.createElement)("form",h(V(e,["context","enterKeyHint","preventLeave","formatError"]),{ref:Ze(n,r.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||o).call(this,t)},onReset:function(t){t.preventDefault(),r.reset(),(e.onReset||o).call(this,t)}})))}));function Bt(e){return(0,t.createElement)(wt,{value:e.value.data},e.children)}function Kt(e){return Ut(h({},e,{defaultValue:[]}))}function Ut(e){var n=(0,t.useState)(K)[0],r=e.name,i=(0,t.useContext)(St);i||(i=yt.data,r=n);var u=(0,t.useRef)(),a=vt(i).context,c=vt(a),s=e.value;r?(s="value"in e?s:p(i[r])||d(i[r])||e.defaultValue||{},s=vt(i).set(r,s)):(vt(s)||"").context||I("Value must be a data object or array");var l=c.paths[xt(s)];if("boolean"!=typeof(c.fields[l]||"").controlled){var f=u.current||(u.current=zt(s));It(a,c,f,{},e,0,i,l),f.value=s}else(0,t.useEffect)(o,[null]),(0,t.useEffect)(o,[null]);var m=e.children;return v(m)&&(m=m(s)),(0,t.createElement)(wt,{value:s},m)}function _t(e){return At(e,e.value),null}A(Ut,{keyFor:xt});const Jt=e;n.react=e})(),u=u.default})()));
//# sourceMappingURL=zeta-dom-react.min.js.map