!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.d(i,{default:()=>Tt});var e={};o.r(e),o.d(e,{ChoiceField:()=>Ke,DataView:()=>Me,DateField:()=>Qe,Form:()=>Dt,FormArray:()=>Nt,FormContext:()=>Ot,FormContextProvider:()=>Mt,FormObject:()=>It,MultiChoiceField:()=>Xe,NumericField:()=>et,TextField:()=>tt,ToggleField:()=>nt,ValidationError:()=>dt,ViewStateProvider:()=>Oe,classNames:()=>je,combineRef:()=>Le,combineValidators:()=>Ft,createBreakpointContext:()=>Ce,domEventRef:()=>Te,innerTextOrHTML:()=>He,isSingletonDisposed:()=>ye,partial:()=>Ae,registerFieldType:()=>zt,toRefCallback:()=>qe,useAsync:()=>me,useDataView:()=>Ne,useDispose:()=>ge,useErrorHandler:()=>we,useErrorHandlerRef:()=>Se,useFormContext:()=>Pt,useFormField:()=>Rt,useMediaQuery:()=>ke,useMemoizedFunction:()=>pe,useObservableProperty:()=>ve,useRefInitCallback:()=>he,useSingleton:()=>be,useUnloadEffect:()=>Ee,useUpdateTrigger:()=>de,useViewState:()=>Pe,withSuspense:()=>We});var t=o(359),n=o(654),r=n.util,u=r.noop,a=r.pipe,s=r.either,c=r.sameValueZero,f=r.is,l=r.isUndefinedOrNull,d=r.isArray,p=r.isFunction,v=(r.isThenable,r.isPlainObject),m=(r.isArrayLike,r.makeArray),h=r.extend,g=r.each,y=r.map,b=r.grep,S=r.splice,w=r.any,E=r.single,k=r.kv,C=(r.fill,r.pick),x=r.exclude,V=(r.mapObject,r.mapGet),O=r.mapRemove,P=(r.arrRemove,r.setAdd),R=(r.equal,r.combineFn),F=(r.executeOnce,r.createPrivateStore),z=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate),D=r.setImmediateOnce,M=r.throws,N=r.throwNotFunction,I=(r.errorWithCode,r.isErrorWithCode),T=r.keys,j=(r.values,r.hasOwnProperty),H=(r.getOwnPropertyDescriptors,r.define),A=r.definePrototype,L=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),q=r.watch,W=(r.watchOnce,r.watchable,r.inherit,r.freeze),B=(r.deepFreeze,r.iequal,r.randomId),K=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.matchWordMulti,r.htmlDecode,r.resolve),U=(r.reject,r.always),_=r.resolveAll,J=(r.retryable,r.deferrable),Y=(r.catchAsync,r.setPromiseTimeout,r.delay),G=r.makeAsync,Z=n.util,$=(Z.domReady,Z.tagName,Z.isVisible,Z.matchSelector,Z.comparePosition),Q=(Z.connected,Z.containsOrEquals,Z.acceptNode,Z.combineNodeFilters,Z.iterateNode,Z.iterateNodeToArray,Z.getCommonAncestor,Z.parentsAndSelf),X=(Z.selectIncludeSelf,Z.selectClosestRelative,Z.createNodeIterator,Z.createTreeWalker,Z.bind);Z.bindUntil,Z.dispatchDOMMouseEvent,Z.removeNode,Z.getClass,Z.setClass,Z.getSafeAreaInset,Z.getScrollOffset,Z.getScrollParent,Z.getContentRect,Z.scrollBy,Z.scrollIntoView,Z.makeSelection,Z.getRect,Z.getRects,Z.toPlainRect,Z.rectEquals,Z.rectCovers,Z.rectIntersects,Z.pointInRect,Z.mergeRect,Z.elementFromPoint;const ee=n.dom;var te=n.dom,ne=(te.textInputAllowed,te.beginDrag,te.beginPinchZoom,te.insertText,te.getShortcut,te.setShortcut,te.focusable,te.focused,te.setTabRoot,te.unsetTabRoot,te.setModal,te.releaseModal,te.retainFocus,te.releaseFocus,te.iterateFocusPath,te.focus);te.blur;const re=ee;var oe,ie=n.dom,ue=(ie.lock,ie.locked,ie.cancelLock,ie.subscribeAsync,ie.notifyAsync),ae=ie.preventLeave,se=n.EventContainer,ce=new se,fe=new WeakSet,le=window.AbortController;function de(){var e=(0,t.useState)()[1];return(0,t.useCallback)((function(){e({})}),[])}function pe(e){var n=(0,t.useRef)();return n.current=p(e)||u,(0,t.useCallback)((function(){return n.current.apply(this,arguments)}),[])}function ve(e,n){var r=de(),o=e[n],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&r()};return t(e[n]),q(e,n,t)}),[e,n]),o}function me(e,n,r){var o=be((function(){var t,n,i;return{loading:!1,value:void 0,error:void 0,elementRef:function(e){t=e},on:function(e,t){return ce.add(o,e,t)},onError:function(e){return o.on("error",(function(t){return e.call(o,t.error)}))},refresh:function(a){if(r&&!a)return(i=i||J()).waitFor(Y(r)),i.d||(i.d=i.then((function(){return i=null,o.refresh(!0)})));var s=le?new le:{abort:u};n&&n.abort(),h(o,{loading:!0,error:void 0});var c=G(e)(s.signal),f=U(c,(function(e,t){if(n===s)if(e)h(o,{loading:!1,value:t}),ce.emit("load",o,{data:t});else if(h(o,{loading:!1,value:void 0,error:t}),!ce.emit("error",o,{error:t}))throw t}));return n=s,ue(t||re.root,f),c},abort:function(e){n&&(n.abort(e),n=null),o.loading=!1}}}),(function(){o.abort()}));return n=[!1!==n].concat(d(n)||[]),e=pe(e),(0,t.useEffect)((function(){n[0]&&D(o.refresh)}),n),(0,t.useMemo)((function(){n[0]&&!r&&(o.loading=!0)}),n),ve(o,"loading"),[o.value,o]}function he(e){var n=m(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&P(r,t)&&(n[0]=t,e.apply(null,n))}}function ge(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return h(R(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function ye(e){return!fe.has(e)}function be(e,n){var r=(0,t.useState)(e())[0];return P(fe,r),(0,t.useEffect)((function(){return P(fe,r),function(){fe.delete(r),z((function(){ye(r)&&(n||r.dispose||u).call(r)}))}}),[r]),r}function Se(){return we.apply(this,arguments).ref}function we(){var e=(0,t.useRef)(!1),n=(0,t.useRef)(null),r=m(arguments),o=(0,t.useState)((function(){return{ref:function(e){n.current=e,s(e)},emit:function(e){return u(e)||i(e)||K()},catch:function(e,t){var n;return t?n=d(e)?function(e,t){return w(t,(function(t){return(p(t)?f:I)(e,t)}))}:p(e)?f:I:t=e,ce.add(o,n?"error":"default",(function(r){if((n||a)(r.error,e))return t(r.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,re.emit("error",n.current||re.root,{error:t},!0)}finally{e.current=!1}}),[]),u=(0,t.useCallback)((function(e){return ce.emit("error",o,{error:e})||ce.emit("default",o,{error:e})}),[]),s=he((function(t){re.on(t,"error",(function(t){if(!e.current)return u(t.error)}))}));return(0,t.useEffect)((function(){return R(y(r,(function(e){return e.onError(o.emit)})))}),r),o}function Ee(e){oe||(oe=new Set,X(window,"pagehide",(function(e){R(m(oe).reverse())(e.persisted)}))),e=pe(e),(0,t.useEffect)((function(){return oe.add(e),function(){oe.delete(e),e(!1)}}),[])}function ke(e){var n=(0,t.useMemo)((function(){return matchMedia(e)}),[e]),r=(0,t.useState)(n.matches);return(0,t.useEffect)((function(){return X(n,"change",(function(){r[1](n.matches)}))}),[n]),r[0]}function Ce(e){var n={};return q(n,!0),g(e,(function(e,t){var r=matchMedia(t),o=L(n,e,r.matches,!0);X(r,"change",(function(){o(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=de();return(0,t.useEffect)((function(){return q(n,e)}),[]),n}}}var xe=(0,t.createContext)(null),Ve=Object.freeze({get:u,set:u}),Oe=xe.Provider;function Pe(e){var n=(0,t.useState)(B)[0],r=(0,t.useContext)(xe),o=r&&e&&r.getState(n,e)||Ve;return(0,t.useEffect)((function(){return o.dispose&&o.dispose.bind(o)}),[o]),o}var Re=F(),Fe=Me.prototype,ze=new se;function De(e,t){var n=l(e)&&-1,r=l(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function Me(e,t,n,r){var o=this,i={filters:h({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?Me.pageSize:r};for(var u in e=h({},e))L(e,u);var a=Re(o,{filters:Object.freeze(e),defaults:i,items:[]}),s=function(){ze.emit("viewChange",o)},c=function(){a.sorted=a.items.length?void 0:[],this!==o&&(a.filtered=a.sorted),D(s)};h(this,i),q(o,c),q(o.filters,c)}function Ne(e,n,r,o,i){if("string"!=typeof e)return Ne("__dataView",e,n,r,o);var a=Pe(e),s=de(),c=(0,t.useState)((function(){return h(new Me(n,r,o,i),a.get())}))[0];return(0,t.useEffect)((function(){var e=Re(c);return R(c.on("viewChange",(function(){a.set(c.toJSON()),s()})),a.onPopState?a.onPopState((function(t){a.set(c.toJSON()),h(c,t||e.defaults)})):u)}),[c]),c}H(Me,{pageSize:0}),A(Me,{itemCount:0,on:function(e,t){return ze.add(this,e,t)},getView:function(e,t){var n=this,r=Re(n),o=n.pageIndex||0,i=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var u=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=u,e&&(n.itemCount=u.length),[u.slice(o*i,i?(o+1)*i:void 0),u.length]},sort:function(e,t){if(e=m(e),!p(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return g(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),i=o.get(t);return r*(d(n)?E(n,(function(e,t){return De(e,i[t])})):De(n,i))}))},toJSON:function(){var e=this;return h(C(e,T(Re(e).defaults)),{filters:h({},e.filters),itemCount:e.itemCount})},reset:function(){h(this,Re(this).defaults)}}),L(Fe,"sortBy"),L(Fe,"sortOrder"),L(Fe,"pageIndex"),L(Fe,"pageSize"),L(Fe,"filters",{},(function(e){return h(Re(this).filters,e)}));var Ie=new WeakMap;function Te(e,t){var n;return t=v(e)||k(e,t),function(e){if(e){if(n&&n.ref)throw new Error("Callback can only be passed to single React element");void 0===(n=V(Ie,e,Array)).index&&(n.index=0);var r=n.index++,o=n[r]||(n[r]={keys:{}});g(t,(function(t,n){N(n),o.keys[t]=o.keys[t]||re.on(e,t,(function(){return(o.handler[t]||u).apply(this,arguments)}))})),o.handler=t}else n.index=0;n.ref=e}}function je(){var e=[];return function t(n){g(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(m(r.getClassNames()));else for(var o in r){var i=r[o];(i||0===i)&&e.push(!0===i?o:o+"-"+i)}}))}(m(arguments)),e.join(" ")}function He(e){return v(e)?{dangerouslySetInnerHTML:e}:{children:e}}function Ae(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=k(t,p(n)?n(e[t],e):n)),h({},e,t)}))};return t?n.bind(0,t):n}function Le(){return R(m(arguments).map(qe))}function qe(e){return e&&!p(e)?function(t){return e.current=t}:e||u}function We(e,n){n=n||t.Fragment,p(n)&&(n=(0,t.createElement)(n));var r=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:n},(0,t.createElement)(r,e))}}function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ke(){}function Ue(e){return(0,t.useMemo)((function(){return(e||[]).map((function(e){return"object"===Be(e)?e:{label:String(e),value:e}}))}),[e])}H(Ke,{normalizeItems:Ue}),A(Ke,{defaultValue:"",postHook:function(e,n){var r=Ue(n.items),o=r.findIndex((function(t){return t.value===e.value}));return(0,t.useEffect)((function(){o<0&&(o=n.allowUnselect||!r[0]?-1:0,e.setValue(o<0?"":r[0].value))})),h(e,{items:r,selectedIndex:o,selectedItem:r[o]})}});var _e=/^-?\d{4,}-\d{2}-\d{2}$/,Je={y:["getFullYear","setFullYear"],m:["getMonth","setMonth"],d:["getDate","setDate"]};function Ye(e){if("string"==typeof e){if(_e.test(e))return Date.parse(e+"T00:00");e="+"===e[0]||"-"===e[0]?function(e){var t=new Date,n="-"===e[0]?-1:1;return e.toLowerCase().replace(/([+-]?)(\d+)([dwmy])/g,(function(e,r,o,i){t[Je[i][1]](t[Je[i][0]]()+o*("-"===r?-1:"+"===r?1:n)*("w"===i?7:1))})),t}(e):Date.parse(e)}return new Date(e).setHours(0,0,0,0)}function Ge(e,t,n){var r=Ye(e);return r<t?t:r>n?n:e}function Ze(e){var t=Ye(e);return isNaN(t)?null:new Date(t)}function $e(e){if(!isNaN(e)){var t=6e4*new Date(e).getTimezoneOffset(),n=new Date(e-t).toISOString();return n.slice(0,n.indexOf("T",10))}return""}function Qe(){}function Xe(){}function et(){}function tt(){}function nt(){}Je.w=Je.d,H(Qe,{toDateString:$e,toDateObject:Ze}),A(Qe,{defaultValue:"",normalizeValue:function(e){return $e(Ye(e))},postHook:function(e,n){var r=e.setValue,o=e.value,i=Ye(n.min),u=Ye(n.max),a=(0,t.useMemo)((function(){return o&&n.formatDisplay?n.formatDisplay(Ze(o)):o}),[o]);return(0,t.useEffect)((function(){var e=o&&Ge(o,i,u);e!==o&&r(e)}),[o,i,u]),h(e,{min:$e(i),max:$e(u),displayText:a,setValue:pe((function(t){(t=p(t)?t(e.value):t)?/\d{4}/.test(t)&&/[^\s\d]/.test(t)&&(t=Ye(t),isNaN(t)||r(Ge(t,i,u))):r("")}))})}}),A(Xe,{defaultValue:W([]),normalizeValue:function(e){return d(e)||m(e)},postHook:function(e,n){var r=n.allowCustomValues||!n.items,o=Ke.normalizeItems(n.items),i=function(e){return!o.some((function(t){return t.value===e}))},u=pe((function(t,n){!r&&i(t)||e.setValue((function(e){var r=e.indexOf(t);return(l(n)||s(r>=0,n))&&(e=m(e),r<0?e.push(t):e.splice(r,1)),e}))}));return(0,t.useEffect)((function(){if(!r){var t=m(e.value);S(t,i).length&&e.setValue(t)}})),h(e,{items:o,toggleValue:u})}}),A(et,{normalizeValue:function(e){return e=+e,isNaN(e)?void 0:e},postHook:function(e,n){var r=e.value,o=n.min,i=n.max,u=n.step,a=n.allowEmpty;return(0,t.useEffect)((function(){var t=u>0?Math.round(r/u)*u:r;t<o||isNaN(t)&&!a?t=o||0:t>i&&(t=i),t!==r&&e.setValue(t)}),[r,o,i,u,a]),e}}),A(tt,{defaultValue:"",normalizeValue:function(e){return l(e)?"":String(e)},postHook:function(e,t){var n=e.form,r=C(t,["type","disabled","autoComplete","maxLength","inputMode","placeholder","enterKeyHint","readOnly"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,h(e,{inputProps:r})}}),A(nt,{defaultValue:!1,valueProperty:"checked",normalizeValue:function(e){return!!e},isEmpty:function(e){return!e},postHook:function(e){var n=(0,t.useCallback)((function(){e.setValue((function(e){return!e}))}),[]);return h(e,{toggleValue:n})}});var rt=F(),ot=new se,it=new WeakMap,ut=new WeakMap,at=new Map,st=new Ot({},{},{get:u}),ct={text:tt,toggle:nt,choice:Ke},ft=(0,t.createContext)(null),lt=ft.Provider;function dt(e,t,n){this.kind=e,this.args=n,this.message=t}function pt(e){return l(e)||""===e||d(e)&&!e.length}function vt(e){return e.props.required&&(e.props.isEmpty||e.preset.isEmpty||pt)(e.value)}function mt(e){return rt(e)?h(!0,d(e)?[]:{},e):e}function ht(e){return(rt(e)||"").uniqueId}function gt(e,t){for(var n=d(t)||t.split("."),r=e.data,o=r,i=0,u=n.length;i<u;i++){if(!j(r,n[i]))return{name:n[u-1],parent:i===u-1?r:null};o=r,r=r[n[i]]}return{exists:!0,name:n[u-1],value:r,parent:o}}function yt(e,t){var n=gt(e,t),r=ht(n.parent);return r&&rt(e).fields[r+"."+n.name]}function bt(e,t,n){if(t===e.data)return n;for(var r=rt(e).paths,o=[n],i=ht(t);i=r[i];i=i.slice(0,8))o.unshift(i.slice(9));return gt(e,o).parent===t?o.join("."):""}function St(){g(at,(function(e){var t=rt(e),n=O(at,e);for(var r in n)for(;r=r.replace(/(^|\.)[^.]+$/,"");)n[r]=!0;var o=t.ref||re.root,i=b(t.fields,(function(e){return n[e.path]}));if(ot.emit("dataChange",e,T(n)),xt(e,b(i,(function(t){return(t.props.validateOnChange+1||e.validateOnChange+1)>1}))),e.preventLeave&&!t.unlock&&i[0]&&"script"!==re.getEventSource(o)){var u=new Promise((function(e){t.unlock=function(){t.unlock=null,e()}}));ae(o,u,(function(){return ot.emit("beforeLeave",e)||K()}))}}))}function wt(e){var t,n=wt.d||(wt.d=t=new Set);try{e()}finally{n===t&&(g(t,(function(e,t){t.onChange(t.value)})),wt.d=null)}}function Et(e,t){var n=rt(e),r=d(t)?[]:{},o=B(),i=function(t,i){var a=bt(e,s,t);if(a){if(i){if(i.value=r[t],!c(i.value,r[t]))return void u(t,i.value);wt.d.add(i)}for(var f=o;f=n.paths[f];f=f.slice(0,8))n.fields[f]&&wt.d.add(n.fields[f]);return e!==st&&(V(at,e,Object)[a]=!0,D(St)),!0}},u=function(t,i){return(v(i)||d(i))&&((rt(i)||"").context!==e&&(i=Et(e,i)),n.paths[ht(i)]=o+"."+t),r[t]=i,i},a=function(e){delete r[e]},s=new Proxy(r,{set:function(e,t,r){return"string"!=typeof t||c(e[t],r)&&t in e||wt((function(){var a=e[t];if(d(e)){if("length"===t){for(var s=a-1;s>=r;s--)i(s);return e[t]=r,!0}}else{if(rt(r)&&M("Cannot assign proxied data object"),d(r)&&d(a))return a.splice.apply(a,[0,a.length].concat(r)),!0;if(v(r)&&rt(a)){for(var c in x(a,r))delete a[c];return h(a,r),!0}}u(t,r),i(t,n.fields[o+"."+t])})),!0},deleteProperty:function(e,t){return"string"==typeof t&&t in e&&wt((function(){a(t),i(t)})),!0}});return rt(s,{context:e,uniqueId:o,set:u,delete:a}),g(t,(function(e,t){u(e,t)})),s}function kt(e){var t={initialValue:e,value:e,error:"",preset:{},onChange:function(e){t.props.onChange&&t.props.onChange(mt(e))},setValue:function(e){e=p(e)?e(t.value):e,t.controlled?c(e,t.value)||t.onChange(e):t.value=e},setError:function(e){t.error=p(e)?e(t.error):e,(t.form||{}).isValid=null},elementRef:function(e){t.element=e}};return q(t,!0),L(t,"value",e,(function(e,n){return(e=(t.preset.normalizeValue||a)(e,t.props))!==n&&rt(n)&&e!==t.dict[t.name]?(t.dict[t.name]=e,n):e})),L(t,"error","",(function(e){return p(e)||f(e,dt)?function(e,t){return{toString:function(){return f(t,dt)?E([e.props,e.form||"",Ot],(function(n){return(n.formatError||u).call(n,t,e.path||null,e.props,e.form)}))||t.message:t(e.props||{})}}}(t,e):e||""})),q(t,"value",(function(e){t.key?t.dict[t.name]=e:t.controlled||t.onChange(e)})),q(t,"error",(function(e){t.key&&ot.emit("validationChange",t.form,{name:t.path,isValid:!e,message:String(e)})})),t}function Ct(e,n,r,o,i,u,a,s){var c="error"in i,f=r.key||s;h(r,{form:e,props:i,preset:o,controlled:u,dict:a,key:s}),e&&s&&(r.name=s.slice(9),r.path=bt(e,a,r.name),f!==s&&(r.locks=[],c||(r.error="")),n.fields[s]=r),c&&(r.error=i.error),(0,t.useEffect)((function(){return e&&s&&(n.fields[s]=r),function(){n&&n.fields[s]===r&&(delete n.fields[s],(r.props.clearWhenUnmount||r.form===st)&&rt(a).delete(s.slice(9)),n.setValid())}}),[n,r,s]),(0,t.useEffect)((function(){n&&n.setValid()}),[n,r.error,i.disabled,i.required])}function xt(e,t){var n=rt(e),r=function(t){var n=t.path,r=t.value,o=ot.emit("validate",e,{name:n,value:r});return o||!t.props?o:(t.props.onValidate||u)(r,n,e)||vt(t)&&new dt("required","Required")},o=t.map((function(e){var t=e.locks||(e.locks=[]),n=t[0];return n?t[1]||(t[1]=U(t[0],(function(){var o=r(e);return U(o,(function(){t[0]===n&&t.shift()})),o}))):(t[0]=K(r(e)),t[0])}));return _(o).then((function(e){return t.forEach((function(t,n){t.locks[0]===o[n]&&(t.locks.shift(),t.error=e[n])})),n.setValid(),!w(e)}))}function Vt(e){rt(e).viewState.set(e.toJSON())}function Ot(e,t,n){p(e)&&(e=e());var r=this,o={},i=rt(r,{fields:o,viewState:n,paths:{},initialData:e,setValid:L(this,"isValid",!0,(function(){return!w(o,(function(e){return!e.props.disabled&&(e.error||vt(e))}))}))});h(r,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),h({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),r.ref=function(e){i.ref=e,e&&ut.set(e,r)},r.isValid=!0,r.data=Et(r,n.get()||i.initialData)}function Pt(e,n,r){if("string"!=typeof e)return Pt("",e,n);var o=Pe(e),i=(0,t.useState)((function(){return new Ot(n,r,o)}))[0],a=de();return ve(i,"isValid"),Ee((function(){(rt(i).unlock||u)(),i.autoPersist&&Vt(i)})),(0,t.useEffect)((function(){return i.on({dataChange:a,reset:a})}),[i]),i}function Rt(e,n,r,o){"string"==typeof e&&(e=ct[e]),p(e)||(o=r,r=n,n=e,e="");var i=e?V(it,e,e):{};o=o||i.valueProperty||"value";var u=(0,t.useContext)(ft),s=u&&rt(u).context,c=s&&rt(s),f=n.name||"",l=s&&f&&ht(u)+"."+f,d=o in n,v=(0,t.useState)((function(){return kt(d?n[o]:(i.normalizeValue||a)(void 0!==r?r:i.defaultValue))}))[0];Ct(s,c,v,i,n,d,u,l),d&&(v.value=n[o]),s&&l&&(f in u?d||(v.value=u[f]):v.value=rt(u).set(f,v.initialValue));var m=(i.postHook||a)({form:s,key:l,path:v.path,value:v.value,error:String(v.error),setValue:v.setValue,setError:v.setError,elementRef:v.elementRef},n);return m.value=ve(v,"value"),m.error=String(ve(v,"error")),m}function Ft(){var e=b(m(arguments),p);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),K())}}function zt(e,t){p(t)&&(t={postHook:t}),ct[e]=function(){return t}}wt.d=null,H(Ot,{ERROR_FIELD:1,EMPTY_FIELD:2,get:function(e){return E(Q(e),ut.get.bind(ut))||null}}),A(Ot,{element:function(e){return e?(yt(this,e)||"").element:rt(this).ref},focus:function(e){var t;return!!(t="number"==typeof e?y(rt(this).fields,(function(t){return t.error&&1&e||pt(t.value)&&2&e?t.element:null})).sort($)[0]:this.element(e))&&ne(t)},on:function(e,t){return ot.add(this,e,t)},persist:function(){Vt(this),this.autoPersist=!1},restore:function(){var e=rt(this).viewState.get();return e&&this.reset(e),!!e},clear:function(){this.reset({})},reset:function(e){var t=this,n=rt(t),r=rt(t.data);for(var o in t.data)r.delete(o);g(e||n.initialData,(function(e,t){r.set(e,t)})),g(n.fields,(function(e,n){var r=gt(t,n.path);n.controlled?n.onChange(r.exists?r.value:n.initialValue):r.exists&&(n.value=r.value),n.error=null})),n.setValid(),(n.unlock||u)(),ot.emit("reset",t)},getValue:function(e){return mt(gt(this,e).value)},setValue:function(e,t){var n=gt(this,e);n.parent&&(n.parent[n.name]=mt(t))},getErrors:function(){var e=b(rt(this).fields,(function(e){return e.error}));return e[0]?Object.fromEntries(e.map((function(e){return[e.path,String(e.error)]}))):null},getError:function(e){return String((yt(this,e)||"").error||"")},setError:function(e,t){(yt(this,e)||{}).error=t},validate:function(){var e=this,t=rt(e).fields,n=m(arguments);return n[0]?xt(e,b(t,(function(e){return w(n,(function(t){var n=t.length;return e.path.slice(0,n)===t&&(!e.path[n]||"."===e.path[n])}))}))):xt(e,b(t,(function(e){return!e.props.disabled})))},toJSON:function(){return h(!0,{},this.data)}}),L(Ot.prototype,"preventLeave",!1,(function(e){return e||(rt(this).unlock||u)(),!!e}));var Dt=(0,t.forwardRef)((function(e,n){var r=e.context;return h(r,C(e,["enterKeyHint","preventLeave","formatError"])),(0,t.createElement)(lt,{value:r.data},(0,t.createElement)("form",h(x(e,["context","enterKeyHint","preventLeave","formatError"]),{ref:Le(n,r.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||u).call(this,t)},onReset:function(t){t.preventDefault(),r.reset(),(e.onReset||u).call(this,t)}})))}));function Mt(e){return(0,t.createElement)(lt,{value:e.value.data},e.children)}function Nt(e){return It(h({},e,{defaultValue:[]}))}function It(e){var n=(0,t.useState)(B)[0],r=e.name,o=(0,t.useContext)(ft);o||(o=st.data,r=n);var i=(0,t.useRef)(),a=rt(o).context,s=rt(a),c=e.value;r?(c="value"in e?c:v(o[r])||d(o[r])||e.defaultValue||{},c=rt(o).set(r,c)):(rt(c)||"").context||M("Value must be a data object or array");var f=s.paths[ht(c)];if("boolean"!=typeof(s.fields[f]||"").controlled){var l=i.current||(i.current=kt(c));Ct(a,s,l,{},e,0,o,f),l.value=c}else(0,t.useEffect)(u,[null]),(0,t.useEffect)(u,[null]);var m=e.children;return p(m)&&(m=m(c)),(0,t.createElement)(lt,{value:c},m)}H(It,{keyFor:ht});const Tt=e;n.react=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map