!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,a),i.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{a.d(i,{default:()=>Q});var e={};a.r(e),a.d(e,{FormContext:()=>L,FormContextProvider:()=>W,classNames:()=>Z,combineRef:()=>J,combineValidators:()=>U,partial:()=>B,toRefCallback:()=>K,useAsync:()=>I,useDispose:()=>M,useFormContext:()=>_,useFormField:()=>H,useMemoizedFunction:()=>R,useObservableProperty:()=>q,useRefInitCallback:()=>D});var t=a(359),n=a(654),r=n.util,o=r.noop,u=(r.either,r.is,r.isUndefinedOrNull,r.isArray),c=r.isFunction,s=(r.isThenable,r.isPlainObject,r.isArrayLike,r.makeArray),f=r.extend,d=r.each,l=(r.map,r.grep),v=(r.splice,r.any),p=(r.single,r.kv),m=(r.pick,r.exclude,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),h=(r.equal,r.combineFn),g=(r.executeOnce,r.createPrivateStore),y=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.keys),b=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define,r.definePrototype),C=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),S=r.watch,P=(r.watchOnce,r.watchable,r.inherit,r.deepFreeze,r.iequal,r.randomId,r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),x=(r.reject,r.always),O=r.resolveAll,w=r.catchAsync,E=(r.setPromiseTimeout,n.EventContainer);n.dom;var F=n.dom,k=(F.textInputAllowed,F.beginDrag,F.beginPinchZoom,F.getShortcut,F.setShortcut,F.focusable,F.focused,F.setModal,F.releaseModal,F.retainFocus,F.releaseFocus,F.iterateFocusPath,F.focus);var V=n.dom,j=V.lock,A=(V.locked,V.cancelLock,new WeakMap),z=new E;function R(e){var n=(0,t.useState)((function(){return function e(){var t=A.get(e);return t&&t.apply(this,arguments)}}))[0];return A.set(n,e),n}function q(e,n){var r=(0,t.useState)(e[n]),a=r[0],i=r[1];return(0,t.useEffect)((function(){return i(e[n]),S(e,n,(function(e){i((function(){return e}))}))}),[e,n]),a}function I(e,n){var r=(0,t.useState)((function(){var t;return{loading:!0,elementRef:function(e){t=e},onError:function(e){return z.add(r,"error",e)},refresh:function(){var n;n=x(P().then(e),(function(e,t){if(!r.disposed&&r.promise===n)if(e)f(r,{loading:!1,value:t});else if(f(r,{loading:!1,value:void 0,error:t}),a=t,!z.emit("error",r,{error:a},!0))throw t;var a})),f(r,{promise:n,loading:!0,error:void 0}),t&&w(j(t,n))}}}))[0],a=u(n);return e=R(e),n=!1!==n,q(r,"loading"),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n&&r.refresh()}),[r,n].concat(a)),[r.value,r]}function D(e){var n=s(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&m(r,t)&&(n[0]=t,e.apply(null,n))}}function M(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return f(h(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}var T=g(),N=(0,t.createContext)(null),W=N.Provider;function G(e,t,n){return{toString:function(){return n(f({},e.fields[t]))}}}function L(e,t){var n=this,r={},a={},i=new E;T(n,{fields:r,errors:a,eventContainer:i,refs:{},initialData:e||{},setValid:C(this,"isValid",!0,(function(){return!v(r,(function(e,t){return!e.disabled&&(a[t]||e.required&&(e.isEmpty?e.isEmpty(n.data[t]):!n.data[t]))}))}))});n.isValid=!0,n.validateOnChange=!1!==t,n.data=function(e,t,n){return new Proxy(f({},n),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(n,r,a){return"string"==typeof r&&n[r]!==a&&(r in n&&t.emitAsync("dataChange",e,[r],{},(function(e,t){return e.concat(t)})),n[r]=a),!0}})}(n,i,e),n.on("dataChange",(function(e){if(n.validateOnChange){var t=l(e.data,(function(e){return!1!==r[e].validateOnChange}));t[0]&&n.validate.apply(n,t)}}))}function _(e,n){var r=(0,t.useState)((function(){return new L(e,n)}))[0],a=(0,t.useState)(0)[1];return q(r,"isValid"),(0,t.useEffect)((function(){return r.on("dataChange",(function(){a((function(e){return++e}))}))}),[r]),r}function H(e,n,r){var a=(0,t.useContext)(N),i=(0,t.useRef)(),o=e.name||"",u=(0,t.useState)((function(){return a&&a.data[o]||n}))[0],c=(0,t.useState)(u),s=(0,t.useState)(""),d=R(e.onValidate),l=c[0],v=c[1],p=s[0],m=s[1],g=R((function(t){e.onChange?e.onChange("function"==typeof t?t(e[r]):t):console.warn("onChange not supplied")}));return(r=r||"value")in e||(g=v,(e=f({},e))[r]=l),a&&o&&(T(a).fields[o]=e),(0,t.useEffect)((function(){if(a&&o){var e=T(a);return e.refs[o]=i,o in a.data&&v(a.data[o]),h((function(){delete e.fields[o],delete e.refs[o],e.setValid()}),a.on("dataChange",(function(e){e.data.includes(o)&&v(a.data[o])})),a.on("validationChange",(function(t){t.name===o&&m(e.errors[o])})),a.on("validate",(function(e){if(e.name===o)return d(e.value,e.name,a)})),a.on("reset",(function(){v(u),m("")})))}}),[a,o,u,d]),(0,t.useEffect)((function(){a&&o&&(a.data[o]=l)}),[a,o,l]),(0,t.useEffect)((function(){a&&o&&T(a).setValid()}),[a,o,e.validateOnChange,e.disabled,e.required]),{value:e[r],error:String(e.error||p||""),setValue:g,setError:m,elementRef:function(e){i.current=e}}}function U(){var e=l(s(arguments),c);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),P())}}function Z(){var e=[];return function t(n){d(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(s(r.getClassNames()));else for(var a in r){var i=r[a];i&&e.push(!0===i?a:a+"-"+i)}}))}(s(arguments)),e.join(" ")}function B(e){return function(t,n){e((function(e){return"string"==typeof t&&(t=p(t,c(n)?n(e[t],e):n)),f({},e,t)}))}}function J(){return h(s(arguments).map(K))}function K(e){return e&&!c(e)?function(t){return e.current=t}:e||o}b(L,{element:function(e){var t=T(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&k(t)},on:function(e,t){return T(this).eventContainer.add(this,e,t)},reset:function(){var e=this,t=T(e);for(var n in e.data)delete e.data[n];f(e.data,t.initialData),e.isValid=!0,t.eventContainer.emit("reset",e)},validate:function(){var e=this,t=T(e),n=t.errors,r=t.eventContainer,a=s(arguments);a.length||(a=y(t.fields));var i=f({},n),o=O(a.map((function(t){return r.emit("validate",e,{name:t,value:e.data[t]})})));return o.then((function(o){return a.forEach((function(a,u){c(o[u])&&(o[u]=G(t,a,o[u])),n[a]=o[u],(o[u]||"")!==(i[a]||"")&&r.emit("validationChange",e,{name:a,isValid:!o[u],message:String(o[u]||"")})})),t.setValid(),!v(o,(function(e){return e}))}))}});const Q=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map