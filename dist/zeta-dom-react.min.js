!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={exports:{}};return n[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.d(i,{default:()=>It});var e={};o.r(e),o.d(e,{ChoiceField:()=>Be,DataView:()=>ze,DateField:()=>Qe,Form:()=>Dt,FormArray:()=>Mt,FormContext:()=>Vt,FormContextProvider:()=>zt,FormObject:()=>Nt,MultiChoiceField:()=>Ze,NumericField:()=>Xe,TextField:()=>et,ToggleField:()=>tt,ValidationError:()=>lt,ViewStateProvider:()=>Ve,classNames:()=>Te,combineRef:()=>Ae,combineValidators:()=>Rt,createBreakpointContext:()=>ke,domEventRef:()=>Ie,innerTextOrHTML:()=>je,isSingletonDisposed:()=>ge,partial:()=>He,registerFieldType:()=>Ft,toRefCallback:()=>Le,useAsync:()=>ve,useDataView:()=>Me,useDispose:()=>he,useErrorHandler:()=>Se,useErrorHandlerRef:()=>be,useFormContext:()=>Ot,useFormField:()=>Pt,useMediaQuery:()=>Ee,useMemoizedFunction:()=>de,useObservableProperty:()=>pe,useRefInitCallback:()=>me,useSingleton:()=>ye,useUnloadEffect:()=>we,useUpdateTrigger:()=>le,useViewState:()=>Oe,withSuspense:()=>qe});var t=o(359),n=o(654),r=n.util,u=r.noop,a=r.pipe,s=r.either,c=r.is,f=r.isUndefinedOrNull,l=r.isArray,d=r.isFunction,p=(r.isThenable,r.isPlainObject),v=(r.isArrayLike,r.makeArray),m=r.extend,h=r.each,g=r.map,y=r.grep,b=r.splice,S=r.any,w=r.single,E=r.kv,k=(r.fill,r.pick),C=r.exclude,x=(r.mapObject,r.mapGet),V=r.mapRemove,O=(r.arrRemove,r.setAdd),P=(r.equal,r.combineFn),R=(r.executeOnce,r.createPrivateStore),F=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate),D=r.setImmediateOnce,z=r.throws,M=r.throwNotFunction,N=(r.errorWithCode,r.isErrorWithCode),I=r.keys,T=(r.values,r.hasOwnProperty),j=(r.getOwnPropertyDescriptors,r.define),H=r.definePrototype,A=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),L=r.watch,q=(r.watchOnce,r.watchable,r.inherit,r.freeze),W=(r.deepFreeze,r.iequal,r.randomId),B=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.matchWordMulti,r.htmlDecode,r.resolve),K=(r.reject,r.always),U=r.resolveAll,_=(r.retryable,r.deferrable),J=(r.catchAsync,r.setPromiseTimeout,r.delay),Y=r.makeAsync,G=n.util,$=(G.domReady,G.tagName,G.isVisible,G.matchSelector,G.comparePosition),Q=(G.connected,G.containsOrEquals,G.acceptNode,G.combineNodeFilters,G.iterateNode,G.iterateNodeToArray,G.getCommonAncestor,G.parentsAndSelf),Z=(G.selectIncludeSelf,G.selectClosestRelative,G.createNodeIterator,G.createTreeWalker,G.bind);G.bindUntil,G.dispatchDOMMouseEvent,G.removeNode,G.getClass,G.setClass,G.getSafeAreaInset,G.getScrollOffset,G.getScrollParent,G.getContentRect,G.scrollBy,G.scrollIntoView,G.makeSelection,G.getRect,G.getRects,G.toPlainRect,G.rectEquals,G.rectCovers,G.rectIntersects,G.pointInRect,G.mergeRect,G.elementFromPoint;const X=n.dom;var ee=n.dom,te=(ee.textInputAllowed,ee.beginDrag,ee.beginPinchZoom,ee.insertText,ee.getShortcut,ee.setShortcut,ee.focusable,ee.focused,ee.setTabRoot,ee.unsetTabRoot,ee.setModal,ee.releaseModal,ee.retainFocus,ee.releaseFocus,ee.iterateFocusPath,ee.focus);ee.blur;const ne=X;var re,oe=n.dom,ie=(oe.lock,oe.locked,oe.cancelLock,oe.subscribeAsync,oe.notifyAsync),ue=oe.preventLeave,ae=n.EventContainer,se=new ae,ce=new WeakSet,fe=window.AbortController;function le(){var e=(0,t.useState)()[1];return(0,t.useCallback)((function(){e({})}),[])}function de(e){var n=(0,t.useRef)();return n.current=d(e)||u,(0,t.useCallback)((function(){return n.current.apply(this,arguments)}),[])}function pe(e,n){var r=le(),o=e[n],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&r()};return t(e[n]),L(e,n,t)}),[e,n]),o}function ve(e,n,r){var o=ye((function(){var t,n,i;return{loading:!1,value:void 0,error:void 0,elementRef:function(e){t=e},on:function(e,t){return se.add(o,e,t)},onError:function(e){return o.on("error",(function(t){return e.call(o,t.error)}))},refresh:function(a){if(r&&!a)return(i=i||_()).waitFor(J(r)),i.d||(i.d=i.then((function(){return i=null,o.refresh(!0)})));var s=fe?new fe:{abort:u};n&&n.abort(),m(o,{loading:!0,error:void 0});var c=Y(e)(s.signal),f=K(c,(function(e,t){if(n===s)if(e)m(o,{loading:!1,value:t}),se.emit("load",o,{data:t});else if(m(o,{loading:!1,value:void 0,error:t}),!se.emit("error",o,{error:t}))throw t}));return n=s,ie(t||ne.root,f),c},abort:function(e){n&&(n.abort(e),n=null),o.loading=!1}}}),(function(){o.abort()}));return n=[!1!==n].concat(l(n)||[]),e=de(e),(0,t.useEffect)((function(){n[0]&&D(o.refresh)}),n),(0,t.useMemo)((function(){n[0]&&!r&&(o.loading=!0)}),n),pe(o,"loading"),[o.value,o]}function me(e){var n=v(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&O(r,t)&&(n[0]=t,e.apply(null,n))}}function he(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return m(P(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function ge(e){return!ce.has(e)}function ye(e,n){var r=(0,t.useState)(e())[0];return O(ce,r),(0,t.useEffect)((function(){return O(ce,r),function(){ce.delete(r),F((function(){ge(r)&&(n||r.dispose||u).call(r)}))}}),[r]),r}function be(){return Se.apply(this,arguments).ref}function Se(){var e=(0,t.useRef)(!1),n=(0,t.useRef)(null),r=v(arguments),o=(0,t.useState)((function(){return{ref:function(e){n.current=e,s(e)},emit:function(e){return u(e)||i(e)||B()},catch:function(e,t){var n;return t?n=l(e)?function(e,t){return S(t,(function(t){return(d(t)?c:N)(e,t)}))}:d(e)?c:N:t=e,se.add(o,n?"error":"default",(function(r){if((n||a)(r.error,e))return t(r.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,ne.emit("error",n.current||ne.root,{error:t},!0)}finally{e.current=!1}}),[]),u=(0,t.useCallback)((function(e){return se.emit("error",o,{error:e})||se.emit("default",o,{error:e})}),[]),s=me((function(t){ne.on(t,"error",(function(t){if(!e.current)return u(t.error)}))}));return(0,t.useEffect)((function(){return P(g(r,(function(e){return e.onError(o.emit)})))}),r),o}function we(e){re||(re=new Set,Z(window,"pagehide",(function(e){P(v(re).reverse())(e.persisted)}))),e=de(e),(0,t.useEffect)((function(){return re.add(e),function(){re.delete(e),e(!1)}}),[])}function Ee(e){var n=(0,t.useMemo)((function(){return matchMedia(e)}),[e]),r=(0,t.useState)(n.matches);return(0,t.useEffect)((function(){return Z(n,"change",(function(){r[1](n.matches)}))}),[n]),r[0]}function ke(e){var n={};return L(n,!0),h(e,(function(e,t){var r=matchMedia(t),o=A(n,e,r.matches,!0);Z(r,"change",(function(){o(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=le();return(0,t.useEffect)((function(){return L(n,e)}),[]),n}}}var Ce=(0,t.createContext)(null),xe=Object.freeze({get:u,set:u}),Ve=Ce.Provider;function Oe(e){var n=(0,t.useState)(W)[0],r=(0,t.useContext)(Ce),o=r&&e&&r.getState(n,e)||xe;return(0,t.useEffect)((function(){return o.dispose&&o.dispose.bind(o)}),[o]),o}var Pe=R(),Re=ze.prototype,Fe=new ae;function De(e,t){var n=f(e)&&-1,r=f(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function ze(e,t,n,r){var o=this,i={filters:m({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?ze.pageSize:r};for(var u in e=m({},e))A(e,u);var a=Pe(o,{filters:Object.freeze(e),defaults:i,items:[]}),s=function(){Fe.emit("viewChange",o)},c=function(){a.sorted=a.items.length?void 0:[],this!==o&&(a.filtered=a.sorted),D(s)};m(this,i),L(o,c),L(o.filters,c)}function Me(e,n,r,o,i){if("string"!=typeof e)return Me("__dataView",e,n,r,o);var a=Oe(e),s=le(),c=(0,t.useState)((function(){return m(new ze(n,r,o,i),a.get())}))[0];return(0,t.useEffect)((function(){var e=Pe(c);return P(c.on("viewChange",(function(){a.set(c.toJSON()),s()})),a.onPopState?a.onPopState((function(t){a.set(c.toJSON()),m(c,t||e.defaults)})):u)}),[c]),c}j(ze,{pageSize:0}),H(ze,{itemCount:0,on:function(e,t){return Fe.add(this,e,t)},getView:function(e,t){var n=this,r=Pe(n),o=n.pageIndex||0,i=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var u=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=u,e&&(n.itemCount=u.length),[u.slice(o*i,i?(o+1)*i:void 0),u.length]},sort:function(e,t){if(e=v(e),!d(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,o=new Map;return h(e,(function(e,n){o.set(n,t(n))})),e.sort((function(e,t){var n=o.get(e),i=o.get(t);return r*(l(n)?w(n,(function(e,t){return De(e,i[t])})):De(n,i))}))},toJSON:function(){var e=this;return m(k(e,I(Pe(e).defaults)),{filters:m({},e.filters),itemCount:e.itemCount})},reset:function(){m(this,Pe(this).defaults)}}),A(Re,"sortBy"),A(Re,"sortOrder"),A(Re,"pageIndex"),A(Re,"pageSize"),A(Re,"filters",{},(function(e){return m(Pe(this).filters,e)}));var Ne=new WeakMap;function Ie(e,t){var n;return t=p(e)||E(e,t),function(e){if(e){if(n&&n.ref)throw new Error("Callback can only be passed to single React element");void 0===(n=x(Ne,e,Array)).index&&(n.index=0);var r=n.index++,o=n[r]||(n[r]={keys:{}});h(t,(function(t,n){M(n),o.keys[t]=o.keys[t]||ne.on(e,t,(function(){return(o.handler[t]||u).apply(this,arguments)}))})),o.handler=t}else n.index=0;n.ref=e}}function Te(){var e=[];return function t(n){h(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(v(r.getClassNames()));else for(var o in r){var i=r[o];i&&e.push(!0===i?o:o+"-"+i)}}))}(v(arguments)),e.join(" ")}function je(e){return p(e)?{dangerouslySetInnerHTML:e}:{children:e}}function He(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=E(t,d(n)?n(e[t],e):n)),m({},e,t)}))};return t?n.bind(0,t):n}function Ae(){return P(v(arguments).map(Le))}function Le(e){return e&&!d(e)?function(t){return e.current=t}:e||u}function qe(e,n){n=n||t.Fragment,d(n)&&(n=(0,t.createElement)(n));var r=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:n},(0,t.createElement)(r,e))}}function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Be(){}function Ke(e){return(0,t.useMemo)((function(){return(e||[]).map((function(e){return"object"===We(e)?e:{label:String(e),value:e}}))}),[e])}j(Be,{normalizeItems:Ke}),H(Be,{defaultValue:"",postHook:function(e,n){var r=Ke(n.items),o=r.findIndex((function(t){return t.value===e.value}));return(0,t.useEffect)((function(){o<0&&(o=n.allowUnselect||!r[0]?-1:0,e.setValue(o<0?"":r[0].value))})),m(e,{items:r,selectedIndex:o,selectedItem:r[o]})}});var Ue=/^-?\d{4,}-\d{2}-\d{2}$/,_e={y:["getFullYear","setFullYear"],m:["getMonth","setMonth"],d:["getDate","setDate"]};function Je(e){if("string"==typeof e){if(Ue.test(e))return Date.parse(e+"T00:00");e="+"===e[0]||"-"===e[0]?function(e){var t=new Date,n="-"===e[0]?-1:1;return e.toLowerCase().replace(/([+-]?)(\d+)([dwmy])/g,(function(e,r,o,i){t[_e[i][1]](t[_e[i][0]]()+o*("-"===r?-1:"+"===r?1:n)*("w"===i?7:1))})),t}(e):Date.parse(e)}return new Date(e).setHours(0,0,0,0)}function Ye(e,t,n){var r=Je(e);return r<t?t:r>n?n:e}function Ge(e){var t=Je(e);return isNaN(t)?null:new Date(t)}function $e(e){if(!isNaN(e)){var t=6e4*new Date(e).getTimezoneOffset(),n=new Date(e-t).toISOString();return n.slice(0,n.indexOf("T",10))}return""}function Qe(){}function Ze(){}function Xe(){}function et(){}function tt(){}_e.w=_e.d,j(Qe,{toDateString:$e,toDateObject:Ge}),H(Qe,{defaultValue:"",normalizeValue:function(e){return $e(Je(e))},postHook:function(e,n){var r=e.setValue,o=e.value,i=Je(n.min),u=Je(n.max),a=(0,t.useMemo)((function(){return o&&n.formatDisplay?n.formatDisplay(Ge(o)):o}),[o]);return(0,t.useEffect)((function(){var e=o&&Ye(o,i,u);e!==o&&r(e)}),[o,i,u]),m(e,{min:$e(i),max:$e(u),displayText:a,setValue:de((function(t){(t=d(t)?t(e.value):t)?/\d{4}/.test(t)&&/[^\s\d]/.test(t)&&(t=Je(t),isNaN(t)||r(Ye(t,i,u))):r("")}))})}}),H(Ze,{defaultValue:q([]),normalizeValue:function(e){return l(e)||v(e)},postHook:function(e,n){var r=n.allowCustomValues||!n.items,o=Be.normalizeItems(n.items),i=function(e){return!o.some((function(t){return t.value===e}))},u=de((function(t,n){!r&&i(t)||e.setValue((function(e){var r=e.indexOf(t);return(f(n)||s(r>=0,n))&&(e=v(e),r<0?e.push(t):e.splice(r,1)),e}))}));return(0,t.useEffect)((function(){if(!r){var t=v(e.value);b(t,i).length&&e.setValue(t)}})),m(e,{items:o,toggleValue:u})}}),H(Xe,{normalizeValue:function(e){return e=+e,isNaN(e)?void 0:e},postHook:function(e,n){var r=e.value,o=n.min,i=n.max,u=n.step,a=n.allowEmpty;return(0,t.useEffect)((function(){var t=u>0?Math.round(r/u)*u:r;t<o||isNaN(t)&&!a?t=o||0:t>i&&(t=i),t!==r&&e.setValue(t)}),[r,o,i,u,a]),e}}),H(et,{defaultValue:"",postHook:function(e,t){var n=e.form,r=k(t,["type","disabled","autoComplete","maxLength","inputMode","placeholder","enterKeyHint"]);return"password"!==t.type||r.autoComplete||(r.autoComplete="current-password"),r.type=r.type||"text",r.enterKeyHint=r.enterKeyHint||n&&n.enterKeyHint,m(e,{inputProps:r})}}),H(tt,{defaultValue:!1,valueProperty:"checked",normalizeValue:function(e){return!!e},isEmpty:function(e){return!e},postHook:function(e){return e}});var nt=R(),rt=new ae,ot=new WeakMap,it=new WeakMap,ut=new Map,at=new Vt({},{},{get:u}),st={text:et,toggle:tt,choice:Be},ct=(0,t.createContext)(null),ft=ct.Provider;function lt(e,t,n){this.kind=e,this.args=n,this.message=t}function dt(e){return f(e)||""===e||l(e)&&!e.length}function pt(e){return e.props.required&&(e.props.isEmpty||e.preset.isEmpty||dt)(e.value)}function vt(e){return nt(e)?m(!0,l(e)?[]:{},e):e}function mt(e){return(nt(e)||"").uniqueId}function ht(e,t){for(var n=l(t)||t.split("."),r=e.data,o=r,i=0,u=n.length;i<u;i++){if(!T(r,n[i]))return{name:n[u-1],parent:i===u-1?r:null};o=r,r=r[n[i]]}return{exists:!0,name:n[u-1],value:r,parent:o}}function gt(e,t){var n=ht(e,t),r=mt(n.parent);return r&&nt(e).fields[r+"."+n.name]}function yt(e,t,n){if(t===e.data)return n;for(var r=nt(e).paths,o=[n],i=mt(t);i=r[i];i=i.slice(0,8))o.unshift(i.slice(9));return ht(e,o).parent===t?o.join("."):""}function bt(){h(ut,(function(e){var t=nt(e),n=V(ut,e);for(var r in n)for(;r=r.replace(/(^|\.)[^.]+$/,"");)n[r]=!0;var o=t.ref||ne.root,i=y(t.fields,(function(e){return n[e.path]}));if(rt.emit("dataChange",e,I(n)),Ct(e,y(i,(function(t){return(t.props.validateOnChange+1||e.validateOnChange+1)>1}))),e.preventLeave&&!t.unlock&&i[0]&&"script"!==ne.getEventSource(o)){var u=new Promise((function(e){t.unlock=function(){t.unlock=null,e()}}));ue(o,u,(function(){return rt.emit("beforeLeave",e)||B()}))}}))}function St(e){var t,n=St.d||(St.d=t=new Set);try{e()}finally{n===t&&(h(t,(function(e,t){t.onChange(t.value)})),St.d=null)}}function wt(e,t){var n=nt(e),r=l(t)?[]:{},o=W(),i=function(t,i){var a=yt(e,s,t);if(a){if(i){if(i.value=r[t],i.value!==r[t])return void u(t,i.value);St.d.add(i)}for(var c=o;c=n.paths[c];c=c.slice(0,8))n.fields[c]&&St.d.add(n.fields[c]);return e!==at&&(x(ut,e,Object)[a]=!0,D(bt)),!0}},u=function(t,i){return(p(i)||l(i))&&((nt(i)||"").context!==e&&(i=wt(e,i)),n.paths[mt(i)]=o+"."+t),r[t]=i,i},a=function(e){delete r[e]},s=new Proxy(r,{set:function(e,t,r){return"string"!=typeof t||e[t]===r&&t in e||St((function(){var a=e[t];if(l(e)){if("length"===t){for(var s=a-1;s>=r;s--)i(s);return e[t]=r,!0}}else{if(nt(r)&&z("Cannot assign proxied data object"),l(r)&&l(a))return a.splice.apply(a,[0,a.length].concat(r)),!0;if(p(r)&&nt(a)){for(var c in C(a,r))delete a[c];return m(a,r),!0}}u(t,r),i(t,n.fields[o+"."+t])})),!0},deleteProperty:function(e,t){return"string"==typeof t&&t in e&&St((function(){a(t),i(t)})),!0}});return nt(s,{context:e,uniqueId:o,set:u,delete:a}),h(t,(function(e,t){u(e,t)})),s}function Et(e){var t={initialValue:e,value:e,error:"",preset:{},onChange:function(e){t.props.onChange&&t.props.onChange(vt(e))},setValue:function(e){e=d(e)?e(t.value):e,t.controlled?e!==t.value&&t.onChange(e):t.value=e},setError:function(e){t.error=d(e)?e(t.error):e,(t.form||{}).isValid=null},elementRef:function(e){t.element=e}};return L(t,!0),A(t,"value",e,(function(e,n){return(e=(t.preset.normalizeValue||a)(e,t.props))!==n&&nt(n)?(t.dict[t.name]=e,n):e})),A(t,"error","",(function(e){return d(e)||c(e,lt)?function(e,t){return{toString:function(){return c(t,lt)?w([e.props,e.form||"",Vt],(function(n){return(n.formatError||u).call(n,t,e.path||null,e.props,e.form)}))||t.message:t(e.props||{})}}}(t,e):e||""})),L(t,"value",(function(e){t.key?t.dict[t.name]=e:t.controlled||t.onChange(e)})),L(t,"error",(function(e){t.key&&rt.emit("validationChange",t.form,{name:t.path,isValid:!e,message:String(e)})})),t}function kt(e,n,r,o,i,u,a,s){var c="error"in i,f=r.key||s;m(r,{form:e,props:i,preset:o,controlled:u,dict:a,key:s}),e&&s&&(r.name=s.slice(9),r.path=yt(e,a,r.name),f!==s&&(r.locks=[],c||(r.error="")),n.fields[s]=r),c&&(r.error=i.error),(0,t.useEffect)((function(){return e&&s&&(n.fields[s]=r),function(){n&&n.fields[s]===r&&(delete n.fields[s],(r.props.clearWhenUnmount||r.form===at)&&nt(a).delete(s.slice(9)),n.setValid())}}),[n,r,s]),(0,t.useEffect)((function(){n&&n.setValid()}),[n,r.error,i.disabled,i.required])}function Ct(e,t){var n=nt(e),r=function(t){var n=t.path,r=t.value,o=rt.emit("validate",e,{name:n,value:r});return o||!t.props?o:(t.props.onValidate||u)(r,n,e)||pt(t)&&new lt("required","Required")},o=t.map((function(e){var t=e.locks||(e.locks=[]),n=t[0];return n?t[1]||(t[1]=K(t[0],(function(){var o=r(e);return K(o,(function(){t[0]===n&&t.shift()})),o}))):(t[0]=B(r(e)),t[0])}));return U(o).then((function(e){return t.forEach((function(t,n){t.locks[0]===o[n]&&(t.locks.shift(),t.error=e[n])})),n.setValid(),!S(e)}))}function xt(e){nt(e).viewState.set(e.toJSON())}function Vt(e,t,n){d(e)&&(e=e());var r=this,o={},i=nt(r,{fields:o,viewState:n,paths:{},initialData:e,setValid:A(this,"isValid",!0,(function(){return!S(o,(function(e){return!e.props.disabled&&(e.error||pt(e))}))}))});m(r,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),m({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),r.ref=function(e){i.ref=e,e&&it.set(e,r)},r.isValid=!0,r.data=wt(r,n.get()||i.initialData)}function Ot(e,n,r){if("string"!=typeof e)return Ot("",e,n);var o=Oe(e),i=(0,t.useState)((function(){return new Vt(n,r,o)}))[0],a=le();return pe(i,"isValid"),we((function(){(nt(i).unlock||u)(),i.autoPersist&&xt(i)})),(0,t.useEffect)((function(){return i.on({dataChange:a,reset:a})}),[i]),i}function Pt(e,n,r,o){"string"==typeof e&&(e=st[e]),d(e)||(o=r,r=n,n=e,e="");var i=e?x(ot,e,e):{};o=o||i.valueProperty||"value";var u=(0,t.useContext)(ct),s=u&&nt(u).context,c=s&&nt(s),f=n.name||"",l=s&&f&&mt(u)+"."+f,p=o in n,v=(0,t.useState)((function(){return Et(p?n[o]:(i.normalizeValue||a)(void 0!==r?r:i.defaultValue))}))[0];kt(s,c,v,i,n,p,u,l),p&&(v.value=n[o]),s&&l&&(f in u?p||(v.value=u[f]):v.value=nt(u).set(f,v.initialValue));var m=(i.postHook||a)({form:s,key:l,path:v.path,value:v.value,error:String(v.error),setValue:v.setValue,setError:v.setError,elementRef:v.elementRef},n);return m.value=pe(v,"value"),m.error=String(pe(v,"error")),m}function Rt(){var e=y(v(arguments),d);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),B())}}function Ft(e,t){d(t)&&(t={postHook:t}),st[e]=function(){return t}}St.d=null,j(Vt,{ERROR_FIELD:1,EMPTY_FIELD:2,get:function(e){return w(Q(e),it.get.bind(it))||null}}),H(Vt,{element:function(e){return e?(gt(this,e)||"").element:nt(this).ref},focus:function(e){var t;return!!(t="number"==typeof e?g(nt(this).fields,(function(t){return t.error&&1&e||dt(t.value)&&2&e?t.element:null})).sort($)[0]:this.element(e))&&te(t)},on:function(e,t){return rt.add(this,e,t)},persist:function(){xt(this),this.autoPersist=!1},restore:function(){var e=nt(this).viewState.get();return e&&this.reset(e),!!e},clear:function(){this.reset({})},reset:function(e){var t=this,n=nt(t),r=nt(t.data);for(var o in t.data)r.delete(o);h(e||n.initialData,(function(e,t){r.set(e,t)})),h(n.fields,(function(e,n){var r=ht(t,n.path);n.controlled?n.onChange(r.exists?r.value:n.initialValue):r.exists&&(n.value=r.value),n.error=null})),n.setValid(),(n.unlock||u)(),rt.emit("reset",t)},getValue:function(e){return vt(ht(this,e).value)},setValue:function(e,t){var n=ht(this,e);n.parent&&(n.parent[n.name]=vt(t))},getErrors:function(){var e=y(nt(this).fields,(function(e){return e.error}));return e[0]?Object.fromEntries(e.map((function(e){return[e.path,String(e.error)]}))):null},getError:function(e){return String((gt(this,e)||"").error||"")},setError:function(e,t){(gt(this,e)||{}).error=t},validate:function(){var e=this,t=nt(e).fields,n=v(arguments);return n[0]?Ct(e,y(t,(function(e){return S(n,(function(t){var n=t.length;return e.path.slice(0,n)===t&&(!e.path[n]||"."===e.path[n])}))}))):Ct(e,y(t,(function(e){return!e.props.disabled})))},toJSON:function(){return m(!0,{},this.data)}}),A(Vt.prototype,"preventLeave",!1,(function(e){return e||(nt(this).unlock||u)(),!!e}));var Dt=(0,t.forwardRef)((function(e,n){var r=e.context;return m(r,k(e,["enterKeyHint","preventLeave","formatError"])),(0,t.createElement)(ft,{value:r.data},(0,t.createElement)("form",m(C(e,["context","enterKeyHint","preventLeave","formatError"]),{ref:Ae(n,r.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||u).call(this,t)},onReset:function(t){t.preventDefault(),r.reset(),(e.onReset||u).call(this,t)}})))}));function zt(e){return(0,t.createElement)(ft,{value:e.value.data},e.children)}function Mt(e){return Nt(m({},e,{defaultValue:[]}))}function Nt(e){var n=(0,t.useState)(W)[0],r=e.name,o=(0,t.useContext)(ct);o||(o=at.data,r=n);var i=(0,t.useRef)(),a=nt(o).context,s=nt(a),c=e.value;r?(c="value"in e?c:p(o[r])||l(o[r])||e.defaultValue||{},c=nt(o).set(r,c)):(nt(c)||"").context||z("Value must be a data object or array");var f=s.paths[mt(c)];if("boolean"!=typeof(s.fields[f]||"").controlled){var v=i.current||(i.current=Et(c));kt(a,s,v,{},e,0,o,f),v.value=c}else(0,t.useEffect)(u,[null]),(0,t.useEffect)(u,[null]);var m=e.children;return d(m)&&(m=m(c)),(0,t.createElement)(ft,{value:c},m)}j(Nt,{keyFor:mt});const It=e;n.react=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map