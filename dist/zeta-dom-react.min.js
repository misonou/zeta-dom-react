!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var n={359:t=>{t.exports=e},654:e=>{e.exports=t}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{i.d(o,{default:()=>Ce});var e={};i.r(e),i.d(e,{DataView:()=>ae,FormContext:()=>le,FormContextProvider:()=>de,ViewStateProvider:()=>ee,classNames:()=>he,combineRef:()=>ye,combineValidators:()=>me,createBreakpointContext:()=>X,partial:()=>ge,toRefCallback:()=>Se,useAsync:()=>H,useDataView:()=>ue,useDispose:()=>Q,useErrorHandlerRef:()=>Z,useFormContext:()=>ve,useFormField:()=>pe,useMediaQuery:()=>K,useMemoizedFunction:()=>L,useObservableProperty:()=>G,useRefInitCallback:()=>U,useViewState:()=>te});var t=i(359),n=i(654),r=n.util,a=r.noop,u=(r.pipe,r.either,r.is,r.isUndefinedOrNull),s=r.isArray,c=r.isFunction,f=(r.isThenable,r.isPlainObject,r.isArrayLike,r.makeArray),d=r.extend,l=r.each,v=r.map,p=r.grep,m=(r.splice,r.any),h=r.single,g=r.kv,y=r.pick,S=(r.exclude,r.mapGet,r.mapRemove,r.arrRemove,r.setAdd),C=(r.equal,r.combineFn),b=(r.executeOnce,r.createPrivateStore),w=(r.setTimeout,r.setTimeoutOnce,r.setInterval,r.setIntervalSafe,r.setImmediate,r.setImmediateOnce,r.throwNotFunction,r.errorWithCode,r.keys),O=(r.values,r.hasOwnProperty,r.getOwnPropertyDescriptors,r.define),P=r.definePrototype,x=(r.defineOwnProperty,r.defineGetterProperty,r.defineHiddenProperty,r.defineAliasProperty,r.defineObservableProperty),E=r.watch,V=(r.watchOnce,r.watchable,r.inherit),R=(r.freeze,r.deepFreeze,r.iequal,r.randomId),k=(r.repeat,r.camel,r.hyphenate,r.ucfirst,r.lcfirst,r.trim,r.matchWord,r.htmlDecode,r.resolve),z=(r.reject,r.always),F=r.resolveAll,A=r.catchAsync,I=(r.setPromiseTimeout,n.util),N=(I.domReady,I.tagName,I.isVisible,I.matchSelector,I.comparePosition,I.connected,I.containsOrEquals,I.acceptNode,I.combineNodeFilters,I.iterateNode,I.iterateNodeToArray,I.getCommonAncestor,I.parentsAndSelf,I.selectIncludeSelf,I.selectClosestRelative,I.createNodeIterator,I.createTreeWalker,I.bind);I.bindUntil,I.dispatchDOMMouseEvent,I.removeNode,I.getClass,I.setClass,I.getScrollOffset,I.getScrollParent,I.getContentRect,I.scrollBy,I.scrollIntoView,I.makeSelection,I.getRect,I.getRects,I.toPlainRect,I.rectEquals,I.rectCovers,I.rectIntersects,I.pointInRect,I.mergeRect,I.elementFromPoint;const j=n.dom;var M=n.dom,q=(M.textInputAllowed,M.beginDrag,M.beginPinchZoom,M.getShortcut,M.setShortcut,M.focusable,M.focused,M.setModal,M.releaseModal,M.retainFocus,M.releaseFocus,M.iterateFocusPath,M.focus);const D=j;var T=n.dom,B=(T.lock,T.locked,T.cancelLock,T.notifyAsync),W=(T.preventLeave,n.EventContainer),_=new WeakMap,J=new W;function L(e){var n=(0,t.useState)((function(){return function e(){var t=_.get(e);return t&&t.apply(this,arguments)}}))[0];return _.set(n,e),n}function G(e,n){var r=(0,t.useState)()[1],i=e[n],o=(0,t.useRef)();return o.current=i,(0,t.useEffect)((function(){var t=function(e){e!==o.current&&r({})};return t(e[n]),E(e,n,t)}),[e,n]),i}function H(e,n){var r=(0,t.useState)((function(){var t;return{loading:!0,elementRef:function(e){t=e},onError:function(e){return J.add(r,"error",(function(t){return e.call(r,t.error)}))},refresh:function(){var n,i=k().then(e);return n=z(i,(function(e,t){if(!r.disposed&&r.promise===n)if(e)d(r,{loading:!1,value:t});else if(d(r,{loading:!1,value:void 0,error:t}),i=t,!J.emit("error",r,{error:i},!0))throw t;var i})),d(r,{promise:n,loading:!0,error:void 0}),B(t||D.root,A(n)),i}}}))[0],i=s(n);return e=L(e),n=!1!==n,G(r,"loading"),(0,t.useEffect)((function(){return function(){r.disposed=!0}}),[r]),(0,t.useEffect)((function(){n&&r.refresh()}),[r,n].concat(i)),[r.value,r]}function U(e){var n=f(arguments),r=(0,t.useState)(new WeakSet)[0];return function(t){t&&S(r,t)&&(n[0]=t,e.apply(null,n))}}function Q(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return d(C(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function Z(){var e=(0,t.useRef)(null),n=f(arguments);return(0,t.useEffect)((function(){return C(v(n,(function(t){return t.onError((function(t){if(e.current)return D.emit("error",e.current,{error:t},!0)}))})))}),[e].concat(n)),e}function K(e){var n=Q(),r=(0,t.useState)((function(){var t=matchMedia(e);return n.push(N(t,"change",(function(){r[1](t.matches)}))),t.matches}));return r[0]}function X(e){var n={};return E(n,!0),l(e,(function(e,t){var r=matchMedia(t),i=x(n,e,r.matches,!0);N(r,"change",(function(){i(r.matches)}))})),{breakpoints:Object.freeze(n),useBreakpoint:function(){var e=(0,t.useState)()[1];return(0,t.useEffect)((function(){return E(n,(function(){e({})}))})),n}}}var Y=(0,t.createContext)(null),$=Object.freeze({get:a,set:a}),ee=Y.Provider;function te(e){var n=(0,t.useState)(R)[0],r=(0,t.useContext)(Y),i=r&&e&&r.getState(n,e)||$;return(0,t.useEffect)((function(){return i.dispose&&i.dispose.bind(i)}),[i]),i}var ne=b(),re=ae.prototype,ie=new W;function oe(e,t){var n=u(e)&&-1,r=u(t)&&1;return n||r?n+r:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function ae(e,t,n,r){var i=this,o={filters:d({},e),sortBy:t,sortOrder:n||t&&"asc",pageIndex:0,pageSize:void 0===r?ae.pageSize:r};for(var a in e=d({},e))x(e,a);var u=ne(i,{filters:Object.freeze(e),defaults:o,items:[]}),s=function(){u.sorted=u.items.length?void 0:[],this!==i&&(u.filtered=u.sorted),ie.emitAsync("viewChange",i)};d(this,o),E(i,s),E(i.filters,s)}function ue(e,n,r,i,o){if("string"!=typeof e)return ue("__dataView",e,n,r,i);var u=te(e),s=(0,t.useState)()[1],c=(0,t.useState)((function(){return d(new ae(n,r,i,o),u.get())}))[0];return(0,t.useEffect)((function(){var e=ne(c);return C(c.on("viewChange",(function(){s({})})),u.onPopState?u.onPopState((function(t){u.set(c.toJSON()),d(c,t||e.defaults)})):a,(function(){u.set(c.toJSON())}))}),[c]),c}O(ae,{pageSize:0}),P(ae,{itemCount:0,on:function(e,t){return ie.add(this,e,t)},getView:function(e,t){var n=this,r=ne(n),i=n.pageIndex||0,o=n.pageSize||0;e!==r.items&&(r.items=e||[],r.filtered=r.items.length?void 0:[],r.sorted=r.filtered),t=t||function(e){return n.sort(e)};var a=r.sorted||(r.sorted=t.call(n,r.filtered||r.items,n.filters,n.sortBy,n.sortOrder)||[]);return r.filtered=a,e&&(n.itemCount=a.length),[a.slice(i*o,o?(i+1)*o:void 0),a.length]},sort:function(e,t){if(e=f(e),!c(t)){var n=t||this.sortBy;if(!n)return e;t=function(e){return e[n]}}var r="desc"===this.sortOrder?-1:1,i=new Map;return l(e,(function(e,n){i.set(n,t(n))})),e.sort((function(e,t){var n=i.get(e),o=i.get(t);return r*(s(n)?h(n,(function(e,t){return oe(e,o[t])})):oe(n,o))}))},toJSON:function(){var e=this;return d(y(e,w(ne(e).defaults)),{filters:d({},e.filters),itemCount:e.itemCount})},reset:function(){d(this,ne(this).defaults)}}),x(re,"sortBy"),x(re,"sortOrder"),x(re,"pageIndex"),x(re,"pageSize"),x(re,"filters",{},(function(e){return d(ne(this).filters,e)}));var se=b(),ce=new W,fe=(0,t.createContext)(null),de=fe.Provider;function le(e,t,n){var r=this,i={},o={},a={},u=se(r,{fields:i,errors:o,viewState:n,vlocks:{},refs:{},pending:{},defaults:a,initialData:V(a,e),setValid:x(this,"isValid",!0,(function(){return!m(i,(function(e,t){return!e.disabled&&(o[t]||e.required&&(e.isEmpty?e.isEmpty(r.data[t]):!r.data[t]))}))}))});r.isValid=!0,r.autoPersist=!0,r.validateOnChange=!1!==t,r.data=function(e,t){return new Proxy(d({},t),{get:function(e,t){if("string"==typeof t)return e[t]},set:function(t,n,r){return"string"==typeof n&&t[n]!==r&&(n in t&&(se(e).pending[n]=!0,ce.emitAsync("dataChange",e,[n],{},(function(e,t){return e.concat(t)}))),t[n]=r),!0}})}(r,n.get()||u.initialData),r.on("dataChange",(function(e){if(u.pending={},r.validateOnChange){var t=p(e.data,(function(e){return i[e]&&!1!==i[e].validateOnChange}));t[0]&&r.validate.apply(r,t)}}))}function ve(e,n,r){if("string"!=typeof e)return ve("",e,n);var i=te(e),o=(0,t.useState)((function(){return new le(n,r,i)}))[0],a=(0,t.useState)()[1];return G(o,"isValid"),(0,t.useEffect)((function(){return C(o.on("dataChange",(function(){a({})})),(function(){o.autoPersist&&o.persist()}))}),[o]),o}function pe(e,n,r){var i=(0,t.useContext)(fe),o=(0,t.useRef)(),a=e.name||"",u=(0,t.useState)((function(){return i&&i.data[a]||n}))[0],s=(0,t.useState)(u),c=(0,t.useState)(""),f=L(e.onValidate),l=s[0],v=s[1],p=c[0],m=c[1],h=L((function(t){e.onChange?e.onChange("function"==typeof t?t(e[r]):t):console.warn("onChange not supplied")}));return(r=r||"value")in e||(h=v,(e=d({},e))[r]=l),i&&a&&(se(i).fields[a]=e),(0,t.useEffect)((function(){if(i&&a){var e=se(i);return e.refs[a]=o,e.defaults[a]=n,a in i.data&&v(i.data[a]),C((function(){delete e.defaults[a],delete e.fields[a],delete e.refs[a],e.setValid()}),i.on("dataChange",(function(e){e.data.includes(a)&&v(i.data[a])})),i.on("validationChange",(function(t){t.name===a&&m(e.errors[a])})),i.on("validate",(function(e){if(e.name===a)return f(e.value,e.name,i)})),i.on("reset",(function(){v(u),m("")})))}}),[i,a,u,f]),(0,t.useEffect)((function(){var e=i&&a&&se(i).pending;e&&!e[a]&&(i.data[a]=l,e[a]=!1)}),[i,a,l]),(0,t.useEffect)((function(){i&&a&&se(i).setValid()}),[i,a,e.validateOnChange,e.disabled,e.required]),{value:e[r],error:String(e.error||p||""),setValue:h,setError:m,elementRef:function(e){o.current=e}}}function me(){var e=p(f(arguments),c);return function(t,n){return e.reduce((function(e,r){return e.then((function(e){return e||r(t,n)}))}),k())}}function he(){var e=[];return function t(n){l(n,(function(n,r){if(r)if("string"==typeof r)e.push(r);else if("function"==typeof r.getClassNames)t(f(r.getClassNames()));else for(var i in r){var o=r[i];o&&e.push(!0===o?i:i+"-"+o)}}))}(f(arguments)),e.join(" ")}function ge(e,t){var n=function(t,n){e((function(e){return"string"==typeof t&&(t=g(t,c(n)?n(e[t],e):n)),d({},e,t)}))};return t?n.bind(0,t):n}function ye(){return C(f(arguments).map(Se))}function Se(e){return e&&!c(e)?function(t){return e.current=t}:e||a}P(le,{element:function(e){var t=se(this).refs[e];return t&&t.current},focus:function(e){var t=this.element(e);t&&q(t)},on:function(e,t){return ce.add(this,e,t)},persist:function(){var e=this;se(e).viewState.set(d({},e.data)),e.autoPersist=!1},restore:function(){var e=se(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,n=se(t);for(var r in t.data)delete t.data[r];d(t.data,e||n.initialData),t.isValid=!0,ce.emit("reset",t)},setError:function(e,t){var n=se(this),r=n.errors,i=r[e]||"";c(t)&&(t=function(e,t,n){return{toString:function(){return n(d({},e.fields[t]))}}}(n,e,t)),r[e]=t,(t||"")!==i&&(ce.emit("validationChange",this,{name:e,isValid:!t,message:String(t||"")}),n.setValid())},validate:function(){var e=this,t=se(e),n=t.vlocks,r=f(arguments);r.length||(r=w(t.fields));var i=function(t){return ce.emit("validate",e,{name:t,value:e.data[t]})},o=r.map((function(e){var t=n[e]=n[e]||[],r=t[0];return r?t[1]||(t[1]=z(t[0],(function(){var n=i(e);return z(n,(function(){t[0]===r&&t.shift()})),n}))):(t[0]=k(i(e)),t[0])}));return F(o).then((function(i){return r.forEach((function(t,r){n[t][0]===o[r]&&(n[t].shift(),e.setError(t,i[r]))})),t.setValid(),!m(i,(function(e){return e}))}))}});const Ce=e})(),o=o.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map