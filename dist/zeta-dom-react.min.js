!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("zeta-dom")):"function"==typeof define&&define.amd?define("zeta-dom-react",["react","zeta-dom"],t):"object"==typeof exports?exports["zeta-dom-react"]=t(require("react"),require("zeta-dom")):e["zeta-dom-react"]=t(e.React,e.zeta)}(self,(function(e,t){return(()=>{"use strict";var r={359:t=>{t.exports=e},654:e=>{e.exports=t}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.d(i,{default:()=>_e});var e={};o.r(e),o.d(e,{ChoiceField:()=>Ke,DataView:()=>ge,Form:()=>qe,FormContext:()=>Ae,FormContextProvider:()=>Ie,MultiChoiceField:()=>Je,TextField:()=>Be,ToggleField:()=>Ue,ViewStateProvider:()=>de,classNames:()=>Se,combineRef:()=>Oe,combineValidators:()=>De,createBreakpointContext:()=>ce,innerTextOrHTML:()=>Ce,partial:()=>we,registerFieldType:()=>Le,toRefCallback:()=>ke,useAsync:()=>ne,useDataView:()=>be,useDispose:()=>ie,useErrorHandler:()=>ae,useErrorHandlerRef:()=>ue,useFormContext:()=>He,useFormField:()=>Te,useMediaQuery:()=>se,useMemoizedFunction:()=>te,useObservableProperty:()=>re,useRefInitCallback:()=>oe,useUpdateTrigger:()=>ee,useViewState:()=>pe,withSuspense:()=>Pe});var t=o(359),r=o(654),n=r.util,u=n.noop,a=n.pipe,s=n.either,c=n.is,f=n.isUndefinedOrNull,l=n.isArray,d=n.isFunction,p=(n.isThenable,n.isPlainObject),v=(n.isArrayLike,n.makeArray),m=n.extend,h=n.each,y=n.map,g=n.grep,b=n.splice,S=n.any,C=n.single,w=n.kv,O=(n.fill,n.pick),k=n.exclude,P=(n.mapObject,n.mapGet),x=n.mapRemove,E=(n.arrRemove,n.setAdd),V=(n.equal,n.combineFn),R=(n.executeOnce,n.createPrivateStore),F=(n.setTimeout,n.setTimeoutOnce,n.setInterval,n.setIntervalSafe,n.setImmediate,n.setImmediateOnce),M=(n.throwNotFunction,n.errorWithCode,n.isErrorWithCode),z=n.keys,I=(n.values,n.hasOwnProperty,n.getOwnPropertyDescriptors,n.define),j=n.definePrototype,N=(n.defineOwnProperty,n.defineGetterProperty,n.defineHiddenProperty,n.defineAliasProperty,n.defineObservableProperty),A=n.watch,H=(n.watchOnce,n.watchable,n.inherit,n.freeze,n.deepFreeze,n.iequal,n.randomId),T=(n.repeat,n.camel,n.hyphenate,n.ucfirst,n.lcfirst,n.trim,n.matchWord,n.htmlDecode,n.resolve),D=(n.reject,n.always),L=n.resolveAll,q=(n.retryable,n.deferrable,n.catchAsync,n.setPromiseTimeout,n.delay,n.makeAsync),W=r.util,B=(W.domReady,W.tagName,W.isVisible,W.matchSelector,W.comparePosition,W.connected,W.containsOrEquals,W.acceptNode,W.combineNodeFilters,W.iterateNode,W.iterateNodeToArray,W.getCommonAncestor,W.parentsAndSelf,W.selectIncludeSelf,W.selectClosestRelative,W.createNodeIterator,W.createTreeWalker,W.bind);W.bindUntil,W.dispatchDOMMouseEvent,W.removeNode,W.getClass,W.setClass,W.getScrollOffset,W.getScrollParent,W.getContentRect,W.scrollBy,W.scrollIntoView,W.makeSelection,W.getRect,W.getRects,W.toPlainRect,W.rectEquals,W.rectCovers,W.rectIntersects,W.pointInRect,W.mergeRect,W.elementFromPoint;const K=r.dom;var J=r.dom,U=(J.textInputAllowed,J.beginDrag,J.beginPinchZoom,J.getShortcut,J.setShortcut,J.focusable,J.focused,J.setModal,J.releaseModal,J.retainFocus,J.releaseFocus,J.iterateFocusPath,J.focus);const _=K;var G=r.dom,Q=(G.lock,G.locked,G.cancelLock,G.subscribeAsync,G.notifyAsync),Z=G.preventLeave,X=r.EventContainer,Y=new WeakMap,$=new X;function ee(){var e=(0,t.useState)()[1];return(0,t.useCallback)((function(){e({})}),[])}function te(e){var r=(0,t.useCallback)((function e(){var t=Y.get(e);return t&&t.apply(this,arguments)}),[]);return Y.set(r,e),r}function re(e,r){var n=ee(),o=e[r],i=(0,t.useRef)();return i.current=o,(0,t.useEffect)((function(){var t=function(e){e!==i.current&&n()};return t(e[r]),A(e,r,t)}),[e,r]),o}function ne(e,r){var n=(0,t.useState)((function(){var t,r;return{loading:!0,elementRef:function(e){t=e},on:function(e,t){return $.add(n,e,t)},onError:function(e){return n.on("error",(function(t){return e.call(n,t.error)}))},refresh:function(){m(n,{loading:!0,error:void 0});var o=q(e)(),i=D(o,(function(e,t){if(!n.disposed&&r===i)if(e)m(n,{loading:!1,value:t}),$.emit("load",n,{data:t});else if(m(n,{loading:!1,value:void 0,error:t}),!$.emit("error",n,{error:t}))throw t}));return r=i,Q(t||_.root,i),o}}}))[0];return r=[!1!==r].concat(l(r)||[]),e=te(e),(0,t.useEffect)((function(){return function(){n.disposed=!0}}),[n]),(0,t.useEffect)((function(){r[0]&&n.refresh()}),r),(0,t.useMemo)((function(){r[0]&&(n.loading=!0)}),r),re(n,"loading"),[n.value,n]}function oe(e){var r=v(arguments),n=(0,t.useState)(new WeakSet)[0];return function(t){t&&E(n,t)&&(r[0]=t,e.apply(null,r))}}function ie(){var e=(0,t.useState)((function(){var e=[function(){e.splice(0,e.length-1)}];return m(V(e),{push:e.splice.bind(e,-1,0)})}))[0];return(0,t.useEffect)((function(){return e}),[e]),e}function ue(){return ae.apply(this,arguments).ref}function ae(){var e=(0,t.useRef)(!1),r=(0,t.useRef)(null),n=v(arguments),o=(0,t.useState)((function(){return{ref:function(e){r.current=e,s(e)},catch:function(e,t){var r;return t?r=d(e)?c:M:t=e,$.add(o,r?"error":"default",(function(n){if((r||a)(n.error,e))return t(n.error)}))}}}))[0],i=(0,t.useCallback)((function(t){try{return e.current=!0,_.emit("error",r.current||_.root,{error:t},!0)}finally{e.current=!1}}),[]),u=(0,t.useCallback)((function(e){return $.emit("error",o,{error:e})||$.emit("default",o,{error:e})}),[]),s=oe((function(t){_.on(t,"error",(function(t){if(!e.current)return u(t.error)}))}));return(0,t.useEffect)((function(){return V(y(n,(function(e){return e.onError((function(e){return u(e)||i(e)||T()}))})))}),n),o}function se(e){var r=ie(),n=(0,t.useState)((function(){var t=matchMedia(e);return r.push(B(t,"change",(function(){n[1](t.matches)}))),t.matches}));return n[0]}function ce(e){var r={};return A(r,!0),h(e,(function(e,t){var n=matchMedia(t),o=N(r,e,n.matches,!0);B(n,"change",(function(){o(n.matches)}))})),{breakpoints:Object.freeze(r),useBreakpoint:function(){var e=ee();return(0,t.useEffect)((function(){return A(r,e)}),[]),r}}}var fe=(0,t.createContext)(null),le=Object.freeze({get:u,set:u}),de=fe.Provider;function pe(e){var r=(0,t.useState)(H)[0],n=(0,t.useContext)(fe),o=n&&e&&n.getState(r,e)||le;return(0,t.useEffect)((function(){return o.dispose&&o.dispose.bind(o)}),[o]),o}var ve=R(),me=ge.prototype,he=new X;function ye(e,t){var r=f(e)&&-1,n=f(t)&&1;return r||n?r+n:"string"==typeof e||"string"==typeof t?String(e).localeCompare(t,void 0,{caseFirst:"upper"}):e-t}function ge(e,t,r,n){var o=this,i={filters:m({},e),sortBy:t,sortOrder:r||t&&"asc",pageIndex:0,pageSize:void 0===n?ge.pageSize:n};for(var u in e=m({},e))N(e,u);var a=ve(o,{filters:Object.freeze(e),defaults:i,items:[]}),s=function(){a.sorted=a.items.length?void 0:[],this!==o&&(a.filtered=a.sorted),he.emitAsync("viewChange",o)};m(this,i),A(o,s),A(o.filters,s)}function be(e,r,n,o,i){if("string"!=typeof e)return be("__dataView",e,r,n,o);var a=pe(e),s=ee(),c=(0,t.useState)((function(){return m(new ge(r,n,o,i),a.get())}))[0];return(0,t.useEffect)((function(){var e=ve(c);return V(c.on("viewChange",s),a.onPopState?a.onPopState((function(t){a.set(c.toJSON()),m(c,t||e.defaults)})):u,(function(){a.set(c.toJSON())}))}),[c]),c}function Se(){var e=[];return function t(r){h(r,(function(r,n){if(n)if("string"==typeof n)e.push(n);else if("function"==typeof n.getClassNames)t(v(n.getClassNames()));else for(var o in n){var i=n[o];i&&e.push(!0===i?o:o+"-"+i)}}))}(v(arguments)),e.join(" ")}function Ce(e){return p(e)?{dangerouslySetInnerHTML:e}:{children:e}}function we(e,t){var r=function(t,r){e((function(e){return"string"==typeof t&&(t=w(t,d(r)?r(e[t],e):r)),m({},e,t)}))};return t?r.bind(0,t):r}function Oe(){return V(v(arguments).map(ke))}function ke(e){return e&&!d(e)?function(t){return e.current=t}:e||u}function Pe(e,r){r=r||t.Fragment,d(r)&&(r=(0,t.createElement)(r));var n=(0,t.lazy)(e);return function(e){return(0,t.createElement)(t.Suspense,{fallback:r},(0,t.createElement)(n,e))}}function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}I(ge,{pageSize:0}),j(ge,{itemCount:0,on:function(e,t){return he.add(this,e,t)},getView:function(e,t){var r=this,n=ve(r),o=r.pageIndex||0,i=r.pageSize||0;e!==n.items&&(n.items=e||[],n.filtered=n.items.length?void 0:[],n.sorted=n.filtered),t=t||function(e){return r.sort(e)};var u=n.sorted||(n.sorted=t.call(r,n.filtered||n.items,r.filters,r.sortBy,r.sortOrder)||[]);return n.filtered=u,e&&(r.itemCount=u.length),[u.slice(o*i,i?(o+1)*i:void 0),u.length]},sort:function(e,t){if(e=v(e),!d(t)){var r=t||this.sortBy;if(!r)return e;t=function(e){return e[r]}}var n="desc"===this.sortOrder?-1:1,o=new Map;return h(e,(function(e,r){o.set(r,t(r))})),e.sort((function(e,t){var r=o.get(e),i=o.get(t);return n*(l(r)?C(r,(function(e,t){return ye(e,i[t])})):ye(r,i))}))},toJSON:function(){var e=this;return m(O(e,z(ve(e).defaults)),{filters:m({},e.filters),itemCount:e.itemCount})},reset:function(){m(this,ve(this).defaults)}}),N(me,"sortBy"),N(me,"sortOrder"),N(me,"pageIndex"),N(me,"pageSize"),N(me,"filters",{},(function(e){return m(ve(this).filters,e)}));var Ee=R(),Ve=new X,Re=new WeakMap,Fe=new Map,Me={text:Be,toggle:Ue,choice:Ke},ze=(0,t.createContext)(null),Ie=ze.Provider;function je(e){return f(e)||""===e||l(e)&&!e.length}function Ne(){h(Fe,(function(e){Ve.emit("dataChange",e,Object.keys(x(Fe,e)))}))}function Ae(e,t,r){var n=this,o={},i=Ee(n,{fields:o,viewState:r,vlocks:{},initialData:e,setValid:N(this,"isValid",!0,(function(){return!S(o,(function(e,t){var r=e.props;return!r.disabled&&(e.error||r.required&&(r.isEmpty||e.preset.isEmpty||je)(e.value))}))}))});m(n,function(e){return"boolean"==typeof e&&(e={validateOnChange:e}),m({autoPersist:!0,preventLeave:!1,validateOnChange:!0},e)}(t)),n.ref=function(e){i.ref=e},n.isValid=!0,n.data=function(e,t){var r=Ee(e),n=m({},t),o=function(t){P(Fe,e,Object)[t]=!0,F(Ne)},i=new Proxy(n,{set:function(e,t,n){return"string"==typeof t&&e[t]!==n&&(o(t),e[t]=n,(r.fields[t]||{}).value=n),!0},deleteProperty:function(e,t){var n=r.fields[t];return n?i[t]=n.initialValue:t in e&&(o(t),delete e[t]),!0}});return Ee(i,n),i}(n,r.get()||i.initialData),n.on("dataChange",(function(e){if(n.validateOnChange){var t=g(e.data,(function(e){return o[e]&&!1!==o[e].props.validateOnChange}));t[0]&&n.validate.apply(n,t)}if(n.preventLeave&&!i.unlock){var r=new Promise((function(e){i.unlock=function(){i.unlock=null,e()}}));Z(i.ref||_.root,r,(function(){return Ve.emit("beforeLeave",n)}))}}))}function He(e,r,n){if("string"!=typeof e)return He("",e,r);var o=pe(e),i=(0,t.useState)((function(){return new Ae(r,n,o)}))[0],a=ee();return re(i,"isValid"),(0,t.useEffect)((function(){return V(i.on("dataChange",a),i.on("reset",a),(function(){(Ee(i).unlock||u)(),i.autoPersist&&i.persist()}))}),[i]),i}function Te(e,r,n,o){"string"==typeof e&&(e=Me[e]),d(e)||(o=n,n=r,r=e,e="");var i=e?P(Re,e,e):{};o=o||i.valueProperty||"value";var s=(0,t.useContext)(ze),c=s&&s.data,f=s&&Ee(s),l=r.name||"",p=o in r,v=(0,t.useState)((function(){var e=p?r[o]:s&&l in c?c[l]:n,t={initialValue:e,value:e,error:"",setValue:function(e){t.value=d(e)?e(t.value):e},setError:function(e){t.error=d(e)?e(t.error):e},elementRef:function(e){t.element=e}};return A(t,!0),N(t,"error","",(function(e){return d(e)?function(e,t){return{toString:function(){return t(e.props||{})}}}(t,e):e||""})),A(t,"value",(function(e){(t.dict||{})[t.name]=e,(t.props.onChange||u)(e)})),A(t,"error",(function(e){t.dict&&t.name&&Ve.emit("validationChange",t.form,{name:t.name,isValid:!e,message:String(e)})})),t}))[0];m(v,{form:s,preset:i,props:r,dict:c,name:l}),p&&(v.value=r[o]),"error"in r&&(v.error=r.error),s&&l&&(f.fields[l]=v,l in c||(Ee(c)[l]=v.value));var h=(i.postHook||a)({form:s,value:v.value,error:String(v.error),setValue:v.setValue,setError:v.setError,elementRef:v.elementRef},r);return(0,t.useEffect)((function(){return function(){f&&f.fields[l]===v&&(delete f.fields[l],v.props.clearWhenUnmount&&delete Ee(v.dict)[l],f.setValid())}}),[f,l]),(0,t.useEffect)((function(){f&&f.setValid()}),[f,v.error,r.disabled,r.required]),h.value=re(v,"value"),h.error=String(re(v,"error")),h}function De(){var e=g(v(arguments),d);return function(t,r){return e.reduce((function(e,n){return e.then((function(e){return e||n(t,r)}))}),T())}}function Le(e,t){d(t)&&(t={postHook:t}),Me[e]=function(){return t}}j(Ae,{element:function(e){var t=Ee(this).fields[e];return t&&t.element},focus:function(e){var t=this.element(e);t&&U(t)},on:function(e,t){return Ve.add(this,e,t)},persist:function(){var e=this;Ee(e).viewState.set(e.toJSON()),e.autoPersist=!1},restore:function(){var e=Ee(this).viewState.get();return e&&this.reset(e),!!e},reset:function(e){var t=this,r=Ee(t),n=Ee(t.data);for(var o in n)delete n[o];h(r.fields,(function(e,t){n[e]=t.initialValue,t.value=t.initialValue,t.error=null})),m(n,e||r.initialData),r.setValid(),(r.unlock||u)(),Ve.emit("reset",t)},setError:function(e,t){(Ee(this).fields[e]||{}).error=t},validate:function(){var e=this,t=Ee(e),r=t.vlocks,n=v(arguments);n.length||(n=z(t.fields));var o=function(r){var n=t.fields[r],o=e.data[r],i=Ve.emit("validate",e,{name:r,value:o});return!i&&n&&(i=(n.props.onValidate||u)(o,r,e)),i},i=n.map((function(e){var t=r[e]=r[e]||[],n=t[0];return n?t[1]||(t[1]=D(t[0],(function(){var r=o(e);return D(r,(function(){t[0]===n&&t.shift()})),r}))):(t[0]=T(o(e)),t[0])}));return L(i).then((function(o){return n.forEach((function(t,n){r[t][0]===i[n]&&(r[t].shift(),e.setError(t,o[n]))})),t.setValid(),!S(o,(function(e){return e}))}))},toJSON:function(){return m(!0,{},this.data)}});var qe=(0,t.forwardRef)((function(e,r){var n=e.context;return m(n,O(e,["enterKeyHint","preventLeave"])),(0,t.createElement)(Ie,{value:n},(0,t.createElement)("form",m(k(e,["context","enterKeyHint","preventLeave"]),{ref:Oe(r,n.ref),onSubmit:function(t){e.action||t.preventDefault(),(e.onSubmit||u).call(this,t)},onReset:function(t){t.preventDefault(),n.reset(),(e.onReset||u).call(this,t)}})))}));function We(e){return(0,t.useMemo)((function(){return(e||[]).map((function(e){return"object"===xe(e)?e:{label:String(e),value:e}}))}),[e])}function Be(){this.postHook=function(e,t){var r=e.form,n=O(t,["type","autoComplete","maxLength","inputMode","placeholder","enterKeyHint"]);return"password"!==t.type||n.autoComplete||(n.autoComplete="current-password"),n.type=n.type||"text",n.enterKeyHint=n.enterKeyHint||r&&r.enterKeyHint,m(e,{inputProps:n})}}function Ke(){this.postHook=function(e,t){var r=We(t.items),n=r.findIndex((function(t){return t.value===e.value}));return n<0&&(n=t.allowUnselect||!r[0]?-1:0,e.setValue(n<0?"":r[0].value)),m(e,{items:r,selectedIndex:n,selectedItem:r[n]})}}function Je(){this.postHook=function(e,t){var r=t.allowCustomValues||!t.items,n=We(t.items),o=function(e){return!n.some((function(t){return t.value===e}))},i=te((function(t,n){!r&&o(t)||e.setValue((function(e){var r=e.indexOf(t);return(f(n)||s(r<0,n))&&(e=v(e),r<0?e.push(t):e.splice(r,1)),e}))}));if(!r){var u=v(e.value);b(u,o).length&&e.setValue(u)}return m(e,{items:n,toggleValue:i})}}function Ue(){this.valueProperty="checked",this.isEmpty=function(e){return!e}}const _e=e;r.react=e})(),i=i.default})()}));
//# sourceMappingURL=zeta-dom-react.min.js.map